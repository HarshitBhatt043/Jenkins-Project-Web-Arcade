var enablePWA=!1;if(enablePWA){function exampleNotification(){var e={body:"Created by the Francis Davidson Paul.",icon:notifImg};new Notification("MERGE FRUIT",e);setTimeout(exampleNotification,3e4)}"serviceWorker"in navigator&&navigator.serviceWorker.register("./js/sw.js"),Notification.requestPermission().then((function(e){"granted"===e&&exampleNotification()}))}let game,gameOptions={playerFruitsRange:4,localStorageName:"samegame"};window.onload=function(){let e={type:Phaser.AUTO,backgroundColor:16770540,scale:{mode:Phaser.Scale.FIT,autoCenter:Phaser.Scale.CENTER_BOTH,parent:"thegame",width:750,height:1334},physics:{default:"matter",matter:{gravity:{y:1},debug:!1}},scene:playGame};game=new Phaser.Game(e),window.focus()};class playGame extends Phaser.Scene{constructor(){super("PlayGame")}preload(){this.load.bitmapFont("font","assets/fonts/font.png","assets/fonts/font.fnt");var e={image:[["tittle","assets/sprites/tittle.png"],["borderLine","assets/sprites/borderLine.png"],["x","assets/sprites/x.png"],["best","assets/sprites/best.png"],["best","assets/sprites/best.png"]],spritesheet:[["particle","assets/sprites/particle.png",{frameWidth:20,frameHeight:20}],["furits","assets/sprites/furits.png",{frameWidth:200,frameHeight:200}]],audio:[["boom",["assets/audio/boom.mp3","assets/audio/boom.ogg"]],["knock",["assets/audio/knock.mp3","assets/audio/knock.ogg"]],["water",["assets/audio/water.mp3","assets/audio/water.ogg"]],["alert",["assets/audio/alert.mp3","assets/audio/alert.ogg"]],["newLevel",["assets/audio/newLevel.mp3","assets/audio/newLevel.ogg"]],["gameOver",["assets/audio/gameOver.mp3","assets/audio/gameOver.ogg"]]]};for(var t in e)e[t].forEach((function(e){var i=this.load[t];i&&i.apply(this.load,e)}),this)}create(){this.boom=this.sound.add("boom"),this.knock=this.sound.add("knock"),this.water=this.sound.add("water"),this.alert=this.sound.add("alert"),this.newLevel=this.sound.add("newLevel"),this.gameOver=this.sound.add("gameOver"),this.matter.world.update60Hz(),this.matter.world.setBounds(),this.matter.world.on("collisionstart",this.handleCollisionStart,this),this.tittle=this.add.sprite(game.config.width/2,game.config.height/2,"tittle"),this.furitGroup=this.add.group(),this.playerFruit=this.add.sprite(game.config.width/2,game.config.height-1220,"furits"),this.nextFruitNum=Phaser.Math.Between(0,gameOptions.playerFruitsRange),this.setFurit(),this.input.on("pointerdown",this.launchFurit,this),this.score=0,this.scoreText=this.add.bitmapText(10,15,"font","ccc",60),this.scoreText.setTint(16711935,16776960,65280,16711680),this.updateScore(),this.nextFruit=this.add.sprite(game.config.width-35,35,"furits"),this.nextFruit.setFrame(Phaser.Math.Between(0,gameOptions.playerFruitsRange)),this.nextFruit.setScale(.3),this.nextFruitNum=this.nextFruit.frame.name,this.borderLine=this.add.sprite(game.config.width/2,game.config.height-1134,"borderLine"),this.borderLine.setVisible(!1),this.scoreFinal=this.add.sprite(game.config.width/2,game.config.height/2,"score"),this.scoreFinal.setVisible(!1),this.best=this.add.sprite(game.config.width/2+5,350,"best"),this.best.setAlpha(0),this.savedData=null==localStorage.getItem(gameOptions.localStorageName)?{score:0}:JSON.parse(localStorage.getItem(gameOptions.localStorageName)),0!=this.savedData.score&&(this.best.setAlpha(1),this.bestScoreText=this.add.bitmapText(game.config.width/2,400,"font","Best : "+this.savedData.score.toString(),60).setCenterAlign().setOrigin(.5,0),this.bestScoreText.y=this.bestScoreText.y+50,this.bestScoreText.setTint(16711935,16776960,65280,16711680),this.tweens.add({targets:this.bestScoreText,y:this.bestScoreText.y-50,duration:275,ease:"Back.easeOut"})),this.emitter=this.add.particles("particle").createEmitter({frame:[0,1,2,3,4,5,6,7,8,9,10],scale:{start:4,end:0},speed:{min:50,max:200},active:!1,lifespan:300,quantity:200,alpha:{min:30,max:100}}),this.emitter.setPosition(game.config.width/2,game.config.height/2),this.emitter.active=!0,this.emitter.setEmitZone({type:"random",quantity:200,source:new Phaser.Geom.Circle(0,0,250)}),this.emitter.explode()}updateScore(){this.scoreText.text=this.score}setFurit(){this.playerFruitReady=!0,this.playerFruit.setVisible(!0),this.playerFruit.setFrame(this.nextFruitNum),this.playerFruit.displayWidth=this.playerFruit.displayHeight=50+this.playerFruit.frame.name*(this.playerFruit.frame.name+21);this.tweens.add({targets:this.playerFruit,scale:{start:0,to:this.playerFruit.scale},ease:"Back.easeOut",duration:100});this.knock.play()}setNextFurit(){this.nextFruitNum=Phaser.Math.Between(0,gameOptions.playerFruitsRange),this.nextFruit.setFrame(this.nextFruitNum)}launchFurit(e){this.tittle.setVisible(!1),this.bestScoreText&&(this.bestScoreText.setAlpha(0),this.best.setAlpha(0)),this.playerFruitReady&&(this.playerFruitReady=!1,this.playerFruit.setVisible(!1),this.dropFurit(e.x,this.playerFruit.y,this.playerFruit.frame.name),this.time.addEvent({delay:500,callbackScope:this,callback:this.setFurit}),this.time.addEvent({delay:600,callbackScope:this,callback:this.setNextFurit}))}dropFurit(e,t,i){let s=this.matter.add.sprite(e,t,"furits");s.setFrame(i),s.setBounce(.4),s.setCircle(100),s.setVelocityY(30),s.displayWidth=s.displayHeight=50+i*(i+21),this.furitGroup.add(s)}handleCollisionStart(e,t,i){e.pairs.forEach((e=>{const{bodyA:t,bodyB:i}=e;t.gameObject&&i.gameObject&&(this.checkGameOver(t.gameObject,i.gameObject),t.gameObject.frame.name==i.gameObject.frame.name?t.speed<i.speed?this.handleInclusion(t.gameObject,i.gameObject):this.handleInclusion(i.gameObject,t.gameObject):t.speed<i.speed?this.handleBounce(t.gameObject,i.gameObject):this.handleBounce(i.gameObject,t.gameObject))}))}handleInclusion(e,t){let i=e.x,s=e.y,a=e.frame.name+1;e.destroy(),t.destroy(),11===a?this.addWaterMelon(game.config.width/2,game.config.height/2,a,!1):this.addFurit(i,s,a),this.score+=a,this.updateScore(),this.boom.play(),this.water.play()}handleBounce(e,t){t.mirrorMovement=e}addFurit(e,t,i){let s=this.matter.add.sprite(e,t,"furits");s.setFrame(i),s.setBounce(.4),s.setCircle(100),s.setVelocity(s.body.velocity.x/2,s.body.velocity.y/2),s.displayWidth=s.displayHeight=50+i*(i+21),this.furitGroup.add(s),this.emitter=this.add.particles("particle").createEmitter({frame:[i,i-1],scale:{start:i,end:0},speed:{min:50,max:200},active:!1,lifespan:300,quantity:50+i*i,alpha:{min:30,max:100}}),this.emitter.setPosition(e,t),this.emitter.active=!0,this.emitter.setEmitZone({type:"random",quantity:30,source:new Phaser.Geom.Circle(0,0,25+i*(i+21))}),this.emitter.explode();this.tweens.add({targets:s,delay:100,scale:{start:0,to:s.scale},ease:"Back.easeOut",duration:100})}addWaterMelon(e,t,i,s){this.newLevel.play();let a=this.add.sprite(e,t,"furits");a.setFrame(11),a.displayWidth=a.displayHeight=402;this.tweens.add({targets:a,delay:3e3,x:game.config.width-35,y:35,scale:{start:a.scale,to:.25},ease:"Linear",duration:1e3})}checkGameOver(e,t){e.y-e.displayWidth<=100||t.y-t.displayWidth<=100?(this.gameEnd(),this.gameOver.play()):(e.y-e.displayWidth<=250||t.y-t.displayWidth<=250)&&(this.borderLine.setVisible(!0),this.alert.play())}gameEnd(){this.input.enabled=!1,this.removeEvent=this.time.addEvent({delay:250,callback:this.removeFruits,callbackScope:this,loop:!0})}removeFruits(){if(this.furitGroup.getChildren().length>0){var e=this.furitGroup.getFirstAlive().frame.name;this.emitter=this.add.particles("particle").createEmitter({frame:e,scale:{start:e,end:0},speed:{min:50,max:200},active:!1,lifespan:300,quantity:50+e*e,alpha:{min:30,max:100}}),this.emitter.setPosition(this.furitGroup.getFirstAlive().x,this.furitGroup.getFirstAlive().y),this.emitter.active=!0,this.emitter.setEmitZone({type:"random",quantity:30,source:new Phaser.Geom.Circle(0,0,25+e*(e+21))}),this.emitter.explode(),this.furitGroup.getFirstAlive().destroy()}else{let e=Math.max(this.score,this.savedData.score);localStorage.setItem(gameOptions.localStorageName,JSON.stringify({score:e})),this.removeEvent.remove(),this.scene.start("PlayGame")}}}