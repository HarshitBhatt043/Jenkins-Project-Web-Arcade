import{Instance}from"cooljs";import*as constant from"./constant";const getActionConfig=(t,e)=>{const{width:i,height:n,utils:o}=t,{random:a}=o,r=t.getVariable(constant.cloudSize);return{bottomToTop:{x:i*a(.3,.7),y:n,vx:0,vy:.7*t.pixelsPerFrame(n)*-1},leftToRight:{x:-1*r,y:n*a(.3,.6),vx:.4*t.pixelsPerFrame(i),vy:.1*t.pixelsPerFrame(n)*-1},rightToLeft:{x:i,y:n*a(.2,.5),vx:.4*t.pixelsPerFrame(i)*-1,vy:.1*t.pixelsPerFrame(n)},rightTopToLeft:{x:i,y:0,vx:.6*t.pixelsPerFrame(i)*-1,vy:.5*t.pixelsPerFrame(n)}}[e]};export const flightAction=(t,e)=>{const{visible:i,ready:n,type:o}=t;if(!i)return;const a=e.getVariable(constant.cloudSize);if(!n){const i=getActionConfig(e,o);t.ready=!0,t.width=a,t.height=a,t.x=i.x,t.y=i.y,t.vx=i.vx,t.vy=i.vy}t.x+=t.vx,t.y+=t.vy,(t.y+a<0||t.y>e.height||t.x+a<0||t.x>e.width)&&(t.visible=!1)};export const flightPainter=(t,e)=>{const{ctx:i}=e,n=e.getImg(t.imgName);i.drawImage(n,t.x,t.y,t.width,t.height)};export const addFlight=(t,e,i)=>{if(t.getVariable(constant.flightCount)===e)return;const n=new Instance({name:`flight_${e}`,action:flightAction,painter:flightPainter});n.imgName=`f${e}`,n.type=i,t.addInstance(n,constant.flightLayer),t.setVariable(constant.flightCount,e)};