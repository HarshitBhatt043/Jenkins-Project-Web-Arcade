import{checkMoveDown,getMoveDownValue}from"./utils";import*as constant from"./constant";export const backgroundImg=t=>{const e=t.getImg("background"),n=e.width,o=e.height*t.width/n;let a=t.getVariable(constant.bgImgOffset,t.height-o);a>t.height||(t.getTimeMovement(constant.moveDownMovement,[[a,a+getMoveDownValue(t,{pixelsPerFrame:t=>t/2})]],(t=>{a=t}),{name:"background"}),t.getTimeMovement(constant.bgInitMovement,[[a,a+o/4]],(t=>{a=t})),t.setVariable(constant.bgImgOffset,a),t.setVariable(constant.lineInitialOffset,t.height-.394*o),t.ctx.drawImage(e,0,a,t.width,o))};const getLinearGradientColorRgb=(t,e,n)=>{const o=e+1>=t.length?t.length-1:e,a=t[o],r=t[o+1>=t.length-1?o:o+1],i=t=>{const e=a[t],o=r[t];return Math.round(e+(o-e)*n)};return`rgb(${i(0)}, ${i(1)}, ${i(2)})`};export const backgroundLinearGradient=t=>{const e=t.ctx.createLinearGradient(0,0,0,t.height),n=[[200,255,150],[105,230,240],[90,190,240],[85,100,190],[55,20,35],[75,25,35],[25,0,10]],o=t.getVariable(constant.bgLinearGradientOffset,0);checkMoveDown(t)&&t.setVariable(constant.bgLinearGradientOffset,o+1.5*getMoveDownValue(t));const a=parseInt(o/t.height,10),r=o%t.height/t.height,i=getLinearGradientColorRgb(n,a,r),g=getLinearGradientColorRgb(n,a+1,r);e.addColorStop(0,g),e.addColorStop(1,i),t.ctx.fillStyle=e,t.ctx.beginPath(),t.ctx.rect(0,0,t.width,t.height),t.ctx.fill();const c=()=>{t.ctx.fillStyle="rgba(255, 255, 255, 0.7)",t.ctx.fillRect(0,0,t.width,t.height)};t.getTimeMovement(constant.lightningMovement,[],(()=>{}),{before:c,after:c})};export const background=t=>{backgroundLinearGradient(t),backgroundImg(t)};