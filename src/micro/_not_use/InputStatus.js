import{Micro}from"../Micro.js";export class InputStatus{constructor(e){this.gameTools=new Micro.GameTools(e),this.canvas=document.getElementById(Micro.DEFAULT_ID),this.clickX=-1,this.clickY=-1,this.up=!1,this.down=!1,this.left=!1,this.right=!1,this.mouseX=-1,this.mouseY=-1,this.toolName=null,this.currentTool=null,this.toolWidth=0,this.toolColour="",this.budgetRequested=!1,this.evalRequested=!1,this.disasterRequested=!1,this.speedChangeRequested=!1,this.requestedSpeed=null,this.bindKeys();var t=this;this.canvas.addEventListener("mouseenter",(function(e){t.mouseEnterHandler(e)}),!1),this.canvas.addEventListener("mouseleave",(function(e){t.mouseLeaveHandler(e)}),!1);for(var s=document.getElementsByClassName("toolButton"),n=0;n<s.length;n++)s[n].addEventListener("click",(function(e){t.toolButtonHandler(e)}),!1),s[n].addEventListener("mouseover",(function(e){t.toolButtonOver(e)}),!1);document.getElementById("evalRequest").addEventListener("click",(function(e){t.evalHandler(e)}),!1),document.getElementById("budgetRequest").addEventListener("click",(function(e){t.budgetHandler(e)}),!1),document.getElementById("disasterRequest").addEventListener("click",(function(e){t.disasterHandler(e)}),!1),document.getElementById("pauseRequest").addEventListener("click",(function(e){t.speedChangeHandler(e)}),!1)}bindKeys(){var e=this;document.onkeydown=function(t){var s=!1;38==(t=t||window.event).keyCode?(e.up=!0,s=!0):40==t.keyCode?(e.down=!0,s=!0):39==t.keyCode?(e.right=!0,s=!0):37==t.keyCode&&(e.left=!0,s=!0),s&&t.preventDefault()},document.onkeyup=function(t){38==(t=t||window.event).keyCode&&(e.up=!1),40==t.keyCode&&(e.down=!1),39==t.keyCode&&(e.right=!1),37==t.keyCode&&(e.left=!1)}}clickHandled(){this.clickX=-1,this.clickY=-1,this.currentTool.clear()}getRelativeCoordinates(e){var t,s,n=this.canvas.getBoundingClientRect();window.innerWidth;return void 0!==e.x&&void 0!==e.y?(t=e.x-n.left,s=e.y-n.top):(t=e.clientX-n.left,s=e.clientY-n.top),{x:t,y:s}}speedChangeHandled(){this.speedChangeRequested=!1,this.requestedSpeed=null}speedChangeHandler(e){this.speedChangeRequested=!0;var t="Pause"===document.getElementById("pauseRequest").innerHTML?"Play":"Pause";document.getElementById("pauseRequest").innerHTML=t}mouseEnterHandler(e){var t=this;this.canvas.addEventListener("mousemove",(function(e){t.mouseMoveHandler(e)}),!1),this.canvas.addEventListener("click",(function(e){t.canvasClickHandler(e)}),!1)}mouseLeaveHandler(e){var t=this;this.canvas.removeEventListener("mousemove",(function(e){t.mouseMoveHandler(e)}),!1),this.canvas.removeEventListener("click",(function(e){t.canvasClickHandler(e)}),!1),this.mouseX=-1,this.mouseY=-1}mouseMoveHandler(e){var t=this.getRelativeCoordinates(e);this.mouseX=t.x,this.mouseY=t.y}canvasClickHandler(e){this.clickX=this.mouseX,this.clickY=this.mouseY,e.preventDefault()}toolButtonOver(e){var t=e.target.getAttribute("data-tool"),s=e.target.getAttribute("data-price");0==s?(s="",t="info"):s+="$",document.getElementById("buttonsInfos").innerHTML=t+" "+s}toolButtonHandler(e){for(var t=document.getElementsByClassName("selected"),s=0;s<t.length;s++)t[s].className=t[s].className.replace("selected","unselected");e.target.className=e.target.className.replace("unselected","selected"),this.toolName=e.target.getAttribute("data-tool"),this.toolWidth=e.target.getAttribute("data-size"),this.currentTool=this.gameTools[this.toolName],this.toolColour=e.target.getAttribute("data-colour"),e.preventDefault()}disasterHandler(e){this.disasterRequested=!0}evalHandler(e){this.evalRequested=!0}budgetHandler(e){this.budgetRequested=!0}evalHandled(e){this.evalRequested=!1}disasterHandled(e){this.disasterRequested=!1}budgetHandled(e){this.budgetRequested=!1}}