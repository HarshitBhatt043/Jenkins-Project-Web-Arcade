import{Micro,MiscUtils}from"../Micro.js";import{math}from"../math/math.js";export class Census{constructor(){this.clearCensus(),this.changed=!1,this.crimeRamp=0,this.pollutionRamp=0,this.landValueAverage=0,this.pollutionAverage=0,this.crimeAverage=0,this.totalPop=0;var s=function(s){this[s]=[];for(var i=120;i--;)this[s][i]=0};let i=Micro.arrs.length;for(;i--;){var t=Micro.arrs[i]+"Hist10",o=Micro.arrs[i]+"Hist120";s.call(this,t),s.call(this,o)}}save(s){for(var i=0,t=Micro.CensusProps.length;i<t;i++)s[Micro.CensusProps[i]]=this[Micro.CensusProps[i]]}load(s){for(var i=0,t=Micro.CensusProps.length;i<t;i++)this[Micro.CensusProps[i]]=s[Micro.CensusProps[i]]}clearCensus(){this.poweredZoneCount=0,this.unpoweredZoneCount=0,this.firePop=0,this.roadTotal=0,this.railTotal=0,this.resPop=0,this.comPop=0,this.indPop=0,this.resZonePop=0,this.comZonePop=0,this.indZonePop=0,this.hospitalPop=0,this.churchPop=0,this.policeStationPop=0,this.fireStationPop=0,this.stadiumPop=0,this.coalPowerPop=0,this.nuclearPowerPop=0,this.seaportPop=0,this.airportPop=0}take10Census(s){MiscUtils.rotate10Arrays.call(this),this.resHist10[0]=Math.floor(this.resPop/8),this.comHist10[0]=this.comPop,this.indHist10[0]=this.indPop,this.crimeRamp+=Math.floor((this.crimeAverage-this.crimeRamp)/4),this.crimeHist10[0]=Math.min(this.crimeRamp,255),this.pollutionRamp+=Math.floor((this.pollutionAverage-this.pollutionRamp)/4),this.pollutionHist10[0]=Math.min(this.pollutionRamp,255);var i=Math.floor(s.cashFlow/20)+128;this.moneyHist10[0]=math.clamp(i,0,255);this.resPop;this.hospitalPop<this.resPopScaled?this.needHospital=1:this.hospitalPop>this.resPopScaled?this.needHospital=-1:this.hospitalPop===this.resPopScaled&&(this.needHospital=0),this.changed=!0}take120Census(){MiscUtils.rotate120Arrays.call(this);this.resHist120[0]=Math.floor(this.resPop/8),this.comHist120[0]=this.comPop,this.indHist120[0]=this.indPop,this.crimeHist120[0]=this.crimeHist10[0],this.pollutionHist120[0]=this.pollutionHist10[0],this.moneyHist120[0]=this.moneyHist10[0],this.changed=!0}}