import{MiscUtils}from"../Micro.js";import{Tile,Tiles,ZoneUtils}from"../Tile.js";import{WorldEffects}from"./WorldEffects.js";export class BaseTool{constructor(){this.TOOLRESULT_OK=0,this.TOOLRESULT_FAILED=1,this.TOOLRESULT_NO_MONEY=2,this.TOOLRESULT_NEEDS_BULLDOZE=3,this.autoBulldoze=!0,this.bulldozerCost=1}init(t,s,i,l=!1){this.toolCost=t,this.result=null,this.isDraggable=l,this._shouldAutoBulldoze=i,this._map=s,this._worldEffects=new WorldEffects(s),this._applicationCost=0}clear(){this._applicationCost=0,this._worldEffects.clear()}addCost(t){this._applicationCost+=t}doAutoBulldoze(t,s){let i=this._worldEffects.getTile(t,s);i.isBulldozable()&&(i=ZoneUtils.normalizeRoad(i),(i>=Tile.TINYEXP&&i<=Tile.LASTTINYEXP||i<Tile.HBRIDGE&&i!==Tile.DIRT)&&(this.addCost(1),this._worldEffects.setTile(t,s,Tile.DIRT)))}apply(t){this._worldEffects.apply(),t.spend(this._applicationCost),this.clear()}modifyIfEnoughFunding(t){return this.result!==this.TOOLRESULT_OK?(this.clear(),!1):t.totalFunds<this._applicationCost?(this.result=this.TOOLRESULT_NO_MONEY,this.clear(),!1):(this.apply.call(this,t),this.clear(),!0)}setAutoBulldoze(t){this.autoBulldoze=t}getAutoBulldoze(){return this.autoBulldoze}}