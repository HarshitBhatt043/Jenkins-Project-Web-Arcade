import{BaseToolConnector}from"./BaseToolConnector.js";import{Tile,ZoneUtils}from"../Tile.js";export class RailTool extends BaseToolConnector{constructor(e){super(),this.init(20,e,!0,!0)}layRail(e,i){this.doAutoBulldoze(e,i);let l=this.toolCost,T=this._worldEffects.getTileValue(e,i);switch(T=ZoneUtils.normalizeRoad(T),T){case Tile.DIRT:this._worldEffects.setTile(e,i,Tile.LHRAIL|Tile.BULLBIT|Tile.BURNBIT);break;case Tile.RIVER:case Tile.REDGE:case Tile.CHANNEL:if(l=100,e<this._map.width-1&&(T=this._worldEffects.getTileValue(e+1,i),T=ZoneUtils.normalizeRoad(T),T==Tile.RAILHPOWERV||T==Tile.HRAIL||T>=Tile.LHRAIL&&T<=Tile.HRAILROAD)){this._worldEffects.setTile(e,i,Tile.HRAIL,Tile.BULLBIT);break}if(e>0&&(T=this._worldEffects.getTileValue(e-1,i),T=ZoneUtils.normalizeRoad(T),T==Tile.RAILHPOWERV||T==Tile.HRAIL||T>Tile.VRAIL&&T<Tile.VRAILROAD)){this._worldEffects.setTile(e,i,Tile.HRAIL,Tile.BULLBIT);break}if(i<this._map.height-1&&(T=this._worldEffects.getTileValue(e,i+1),T=ZoneUtils.normalizeRoad(T),T==Tile.RAILVPOWERH||T==Tile.VRAILROAD||T>Tile.HRAIL&&T<Tile.HRAILROAD)){this._worldEffects.setTile(e,i,Tile.VRAIL,Tile.BULLBIT);break}if(i>0&&(T=this._worldEffects.getTileValue(e,i-1),T=ZoneUtils.normalizeRoad(T),T==Tile.RAILVPOWERH||T==Tile.VRAILROAD||T>Tile.HRAIL&&T<Tile.HRAILROAD)){this._worldEffects.setTile(e,i,Tile.VRAIL,Tile.BULLBIT);break}return this.TOOLRESULT_FAILED;case Tile.LHPOWER:this._worldEffects.setTile(e,i,Tile.RAILVPOWERH,Tile.CONDBIT|Tile.BURNBIT|Tile.BULLBIT);break;case Tile.LVPOWER:this._worldEffects.setTile(e,i,Tile.RAILHPOWERV,Tile.CONDBIT|Tile.BURNBIT|Tile.BULLBIT);break;case Tile.ROADS:this._worldEffects.setTile(e,i,Tile.VRAILROAD,Tile.BURNBIT|Tile.BULLBIT);break;case Tile.ROADS2:this._worldEffects.setTile(e,i,Tile.HRAILROAD,Tile.BURNBIT|Tile.BULLBIT);break;default:return this.TOOLRESULT_FAILED}return this.addCost(l),this.checkZoneConnections(e,i),this.TOOLRESULT_OK}doTool(e,i,l){this.result=this.layRail(e,i)}}