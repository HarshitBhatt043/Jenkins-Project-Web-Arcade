import{Micro}from"../Micro.js";import{Tile}from"../Tile.js";import{Position}from"../math/Position.js";const handleService=function(e,i,o){return function(t,r,n,c){c||(c=Micro.simData),c.census[e]+=1;var a=c.budget[i];t.getTile(r,n).isPowered()||(a=Math.floor(a/2));var f=new Position(r,n);c.traffic.findPerimeterRoad(f)||(a=Math.floor(a/2));var l=c.blockMaps[o].worldGet(r,n);l+=a,c.blockMaps[o].worldSet(r,n,l)}};export const EmergencyServices={registerHandlers:function(e,i){e.addAction(Tile.POLICESTATION,EmergencyServices.policeStationFound),e.addAction(Tile.FIRESTATION,EmergencyServices.fireStationFound)},policeStationFound:handleService("policeStationPop","policeEffect","policeStationMap"),fireStationFound:handleService("fireStationPop","fireEffect","fireStationMap")};