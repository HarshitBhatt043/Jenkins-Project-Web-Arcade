import{BaseSprite}from"./BaseSprite.js";import{Micro}from"../Micro.js";import{Tile,ZoneUtils}from"../Tile.js";import{Messages}from"../Messages.js";import{math}from"../math/math.js";export class ExplosionSprite extends BaseSprite{constructor(s,t,i,e){super(),this.init(Micro.SPRITE_EXPLOSION,s,t,i,e),this.width=48,this.height=48,this.xOffset=-24,this.yOffset=-24,this.frame=1}startFire(s,t){if(s=ZoneUtils.pixToWorld(s),t=ZoneUtils.pixToWorld(t),!this.map.testBounds(s,t))return;let i=this.map.getTile(s,t),e=i.getValue();(i.isCombustible()||e===Tile.DIRT)&&(i.isZone()||this.map.setTo(s,t,ZoneUtils.randomFire()))}move(s,t,i,e){if(0==(1&s)){if(1===this.frame){let s=ZoneUtils.pixToWorld(this.x),i=ZoneUtils.pixToWorld(this.y);t.sendMessage(Messages.SOUND_EXPLOSIONHIGH),t.sendMessage(Messages.EXPLOSION_REPORTED,{x:s,y:i})}this.frame++}this.frame>6&&(this.frame=0,this.startFire(this.x,this.y),this.startFire(this.x-16,this.y-16),this.startFire(this.x+16,this.y+16),this.startFire(this.x-16,this.y+16),this.startFire(this.x+16,this.y+16))}}