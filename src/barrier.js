MG.BarrierType={RANDOM:"random",BARRIER_1:1,BARRIER_2:2,BARRIER_3:3,BARRIER_4:4,BARRIER_5:5,BARRIER_6:6,BLANK:"blank",START:"start",FINISH:"finish"},MG.NUM_RANDOM_BARRIERS=6,MG.BARRIER_PATH_IDS={},MG.BARRIER_PATH_IDS[MG.BarrierType.RANDOM]="",MG.BARRIER_PATH_IDS[MG.BarrierType.BARRIER_1]="barrier-path-1",MG.BARRIER_PATH_IDS[MG.BarrierType.BARRIER_2]="barrier-path-2",MG.BARRIER_PATH_IDS[MG.BarrierType.BARRIER_3]="barrier-path-3",MG.BARRIER_PATH_IDS[MG.BarrierType.BARRIER_4]="barrier-path-4",MG.BARRIER_PATH_IDS[MG.BarrierType.BARRIER_5]="barrier-path-5",MG.BARRIER_PATH_IDS[MG.BarrierType.BARRIER_6]="barrier-path-6",MG.BARRIER_PATH_IDS[MG.BarrierType.BLANK]="barrier-path-blank",MG.BARRIER_PATH_IDS[MG.BarrierType.START]="barrier-path-blank",MG.BARRIER_PATH_IDS[MG.BarrierType.FINISH]="barrier-path-finish",MG.Barrier=function(t){void 0===t&&(t=MG.BarrierType.RANDOM);var r,e,R,a=!1,i=0,I=300*(.5-Math.random()),A=t===MG.BarrierType.RANDOM,n=t===MG.BarrierType.RANDOM?Math.ceil(MG.NUM_RANDOM_BARRIERS*Math.random()):t;this.init=function(){r=document.createElementNS(NAMESPACE_SVG,"g"),(e=document.getElementById(MG.BARRIER_PATH_IDS[n]).cloneNode(!0)).setAttribute("class","barrier-path-front"),(R=document.getElementById(MG.BARRIER_PATH_IDS[n]).cloneNode(!0)).setAttribute("class","barrier-path-back"),r.setAttribute("class","barrier"),r.appendChild(R),r.appendChild(e),a=!0},this.destroy=function(){r.parentNode.removeChild(r)},this.collides=function(t,r){var e=t*Math.cos(i*Math.PI/180)+r*Math.sin(i*Math.PI/180),R=-t*Math.sin(i*Math.PI/180)+r*Math.cos(i*Math.PI/180),a=document.getElementById("collision-line");a.setAttribute("x2",e),a.setAttribute("y2",R);var I=document.getElementById(MG.BARRIER_PATH_IDS[n]),A=new Line(a),M=new Path(I);return new Intersection.intersectShapes(M,A).points.length%2==1},this.update=function(t){i+=I*t},this.updateDOM=function(t,r,a){var I=MG.PROJECTION_PLANE_DISTANCE/(Math.tan(Math.PI*MG.FIELD_OF_VIEW/360)*a),A=MG.PROJECTION_PLANE_DISTANCE/(Math.tan(Math.PI*MG.FIELD_OF_VIEW/360)*(a+10));e.setAttribute("transform","scale("+I+") translate("+t+","+r+") rotate("+i+")"),R.setAttribute("transform","scale("+A+") translate("+t+","+r+") rotate("+i+")"),a=Math.max(MG.LINE_OF_SIGHT-MG.BARRIER_SPACING,Math.min(MG.LINE_OF_SIGHT,a));var n=100-100*(MG.LINE_OF_SIGHT-a)/MG.BARRIER_SPACING;e.setAttribute("fill","rgb("+(100+n)+"%,"+(100+n)+"%,"+(100+n)+"%)"),R.setAttribute("fill","rgb("+(60+n)+"%,"+(60+n)+"%,"+(60+n)+"%)"),e.setAttribute("stroke","rgb("+(0+n)+"%,"+(0+n)+"%,"+(0+n)+"%)"),R.setAttribute("stroke","rgb("+(0+n)+"%,"+(0+n)+"%,"+(0+n)+"%)")},this.getType=function(){return n},this.isRandom=function(){return A},this.isInitialised=function(){return a},this.getRootNode=function(){return r}};