import*as UIL from"../../build/uil.module.js";import{Main}from"../Main.js";import{Base}from"./Base.js";export class Hub{constructor(){this.mapPath="./assets/textures/",this.round=['<svg height="66" width="66">','<circle cx="33" cy="33" r="27" stroke="rgb(255,255,255)" stroke-width="1" stroke-opacity="0.0" fill="rgb(0,0,0)" fill-opacity="0.1"/>',"</svg>"].join("\n"),this.roundSelected=['<svg height="66" width="66">','<circle cx="33" cy="33" r="27" stroke="rgb(255,255,255)" stroke-width="2" stroke-opacity="0.5" fill="rgb(0,0,0)" fill-opacity="0.3"/>',"</svg>"].join("\n"),this.roundSelect=['<svg height="66" width="66">','<circle cx="33" cy="33" r="30" stroke="rgb(255,255,255)" stroke-width="4" stroke-opacity="1" fill="rgb(0,0,0)" fill-opacity="0.5"/>',"</svg>"].join("\n"),this.hub=document.getElementById("hub"),this.full=null,this.title=null,this.isIntro=!0,this.timer=null,this.bg=1,this.R=null,this.C=null,this.I=null,this.isGen=!1,this.colors=["rgba(255,255,255,1)","rgba(0,0,0,0.2)","rgba(0,0,0,1)","rgba(0,0,0,0.5)","rgba(0,0,0,0.8)","rgba(255,255,255,0.5)"],this.radius="-moz-border-radius: 6px; -webkit-border-radius: 6px; border-radius: 6px;",this.radiusL="-moz-border-top-left-radius: 6px; -webkit-border-top-left-radius: 6px; border-top-left-radius: 6px;",this.radiusL+="-moz-border-bottom-left-radius: 6px; -webkit-border-bottom-left-radius: 6px; border-bottom-left-radius: 6px;",this.radiusR="-moz-border-top-right-radius: 6px; -webkit-border-top-right-radius: 6px; border-top-right-radius: 6px;",this.radiusR+="-moz-border-bottom-right-radius: 6px; -webkit-border-bottom-right-radius: 6px; border-bottom-right-radius: 6px;",this.radiusB="-moz-border-bottom-left-radius: 6px; -webkit-border-bottom-left-radius: 6px; border-bottom-left-radius: 6px;",this.radiusB+="-moz-border-bottom-right-radius: 6px; -webkit-border-bottom-right-radius: 6px; border-bottom-right-radius: 6px;",this.windowsStyle=" top:40px; left:10px; border:1px solid "+this.colors[1]+"; background:"+this.colors[3]+";",this.budgetWindow=null,this.evaluationWindow=null,this.disasterWindow=null,this.exitWindow=null,this.queryWindow=null,this.overlaysWindow=null,this.aboutWindow=null,this.selector=null,this.select=null,this.currentToolName=0,this.disasterTypes=["None","Monster","Fire","Flood","Crash","Meltdown","Tornado"],this.disasterButtons=[],this.overlaysTypes=["None","Density","Growth","Land value","Crime Rate","Pollution","Traffic","Power Grid","Fire","Police"],this.overlaysButtons=[],this.full=document.createElement("div"),this.full.style.cssText="position:absolute; top:0px; left:0px; width:100%; height:100%; pointer-events:none; display:block; background:rgba(144,163,183,1); ",this.text=document.createElement("div"),this.text.style.cssText="position:absolute; font-size:18px; left:calc(50% - 150px); top:calc(50% + 80px); width:300px; height:80px; pointer-events:none; text-align:center; font-weight: bold;",this.text.innerHTML="Welcome",this.loader=document.getElementById("loader"),this.loader.style.cssText="pointer-events:none; position:absolute; left:calc(50% - 100px); top:calc(50% - 100px); width:200px; height:200px;",this.link=UIL.add("button",{target:this.hub,w:64,h:64,pos:{left:"10px",bottom:"10px"},simple:!0,button:"#8397ac"}).icon(UIL.Tools.icon("github","#DEDEDE",50)).onChange((function(t){window.open("https://github.com/lo-th/3d.city","_blank")})),this.donate=UIL.add("button",{target:this.hub,w:64,h:64,pos:{left:"84px",bottom:"10px"},simple:!0,button:"#8397ac"}).icon(UIL.Tools.icon("donate","#DEDEDE",50)).onChange((function(t){window.open("https://www.paypal.com/cgi-bin/webscr?cmd=_s-xclick&hosted_button_id=8KTXA987XHYNQ","_blank")})),this.version=document.createElement("div"),this.version.style.cssText="position:absolute; font-size:14px; right:10px; bottom:10px; text-align:right; width:100px; pointer-events:none; display:block;",this.version.innerHTML="v "+Base.version,this.hub.appendChild(this.version),this.hub.appendChild(this.full),this.hub.appendChild(this.loader),this.hub.appendChild(this.text)}message(t){this.text&&(this.text.innerHTML=t)}start(){this.isIntro&&(this.timer=setInterval(this.fadding,100,this))}fadding(t){t.bg-=.1,t.full.style.background="rgba(144,163,183,"+t.bg+")",t.bg<=0&&(clearInterval(t.timer),t.hub.removeChild(t.loader),t.hub.removeChild(t.text),t.hub.removeChild(t.full),t.isIntro=!1)}generate(t){t?this.isGen||(this.hub.appendChild(this.loader),this.hub.appendChild(this.text),this.text.innerHTML="Generate map...",this.isGen=!0):this.isGen&&(this.hub.removeChild(this.loader),this.hub.removeChild(this.text),this.isGen=!1)}initPrevHub(){}initStartHub(){}initGameHub(){this.link.dispose(),this.donate.dispose();var t=this;this.toolSet=document.createElement("div"),this.toolSet.style.cssText="position:absolute; margin:0px; padding:0px; top:60px; right:12px; width:198px; height:456px; pointer-events:none;",this.hub.appendChild(this.toolSet),this.toolInfo=document.createElement("div"),this.toolInfo.style.cssText="position:absolute; top:15px; right:12px; width:198px; height:50px; pointer-events:none; font-size:16px;",this.hub.appendChild(this.toolInfo),this.toolInfo.innerHTML="Selecte<br>Tool";for(var e=0;e<18;e++)this.addSVGButton(this.toolSet).name=e+1;this.selector=document.createElement("div"),this.selector.style.cssText="position:absolute; top:0px; left:0px; pointer-events:none; display:none;",this.selector.innerHTML=this.roundSelected,this.toolSet.appendChild(this.selector),this.select=document.createElement("div"),this.select.style.cssText="position:absolute; top:0px; left:0px; pointer-events:none; display:none;",this.select.innerHTML=this.roundSelect,this.toolSet.appendChild(this.select);var i,s=document.createElement("img");for(s.src=this.mapPath+"interface.png",this.toolSet.appendChild(s),s.style.cssText="position:absolute; margin:0px; padding:0px; top:0px; right:0px; width:198px; height:396px; pointer-events:none;",this.addSelector("Speed",["II",">",">>",">>>",">>>"],Main.setSpeed,2,[20,20,20,20,20]),this.addButton(this.hub,"Budget",[75,16,14],"position:absolute; left:10px; top:-7px; font-weight:bold;",!0).addEventListener("click",(function(t){t.preventDefault(),Main.getBudjet()}),!1),this.addButton(this.hub,"Eval",[75,16,14],"position:absolute; left:110px; top:-7px; font-weight:bold;",!0).addEventListener("click",(function(t){t.preventDefault(),Main.getEval()}),!1),this.addButton(this.hub,"Exit",[75,16,14],"position:absolute; left:310px; top:-7px; font-weight:bold;",!0).addEventListener("click",(function(e){e.preventDefault(),t.openExit()}),!1),this.addButton(this.hub,"About",[75,16,14],"position:absolute; left:410px; top:-7px; font-weight:bold;",!0).addEventListener("click",(function(e){e.preventDefault(),t.openAbout()}),!1),this.H=[],this.roo=document.createElement("div"),this.roo.style.cssText="position:absolute; bottom:11px; left:10px; width:60px; height:60px; pointer-events:none; transform:rotate(45deg); ",this.roo.style.cssText+="-moz-border-radius: 30px; -webkit-border-radius: 30px; border-radius: 30px; overflow:hidden; ",this.hub.appendChild(this.roo),e=0;e<4;e++)i=document.createElement("div"),0==e&&(i.style.cssText="position:absolute; top:0px; left:0px; width:30px; height:30px; pointer-events:auto; cursor:pointer; background:#ffffff;"),1==e&&(i.style.cssText="position:absolute; top:0px; right:0px; width:30px; height:30px; pointer-events:auto; cursor:pointer;"),2==e&&(i.style.cssText="position:absolute; bottom:0px; right:0px; width:30px; height:30px; pointer-events:auto; cursor:pointer;"),3==e&&(i.style.cssText="position:absolute; bottom:0px; left:0px; width:30px; height:30px; pointer-events:auto; cursor:pointer;"),i.name=e,this.roo.appendChild(i),i.addEventListener("click",(function(e){e.preventDefault(),t.hideoldSel(),t.H[this.name].style.background="#ffffff",Main.setTimeColors(this.name)}),!1),this.H[e]=i;var o=document.createElement("div");o.style.cssText="position:absolute; bottom:80px; left:25px; width:30px; height:30px; pointer-events:auto; cursor:pointer; background:rgba(0,0,0,0); ",o.style.cssText+="-moz-border-radius: 30px; -webkit-border-radius: 30px; border-radius: 30px; ",this.hub.appendChild(o),o.addEventListener("click",(function(t){view3d.winterSwitch(),view3d.isWinter?this.style.background="rgba(255,255,255,0.5);":this.style.background="rgba(0,0,0,0);"}),!1);var n=document.createElement("img");n.src=this.mapPath+"basemenu.png",this.hub.appendChild(n),n.style.cssText="position:absolute; margin:0px; padding:0px; bottom:0px; left:0px; width:630px; height:120px; pointer-events:none;",this.initCITYinfo()}hideoldSel(){for(var t=0;t<4;t++)this.H[t].style.background="none"}initCITYinfo(){this.date=document.createElement("div"),this.date.style.cssText="font-size:14px; position:absolute; width:70px; height:19px; bottom:15px; left:65px; text-align:right; font-weight:bold;",this.money=document.createElement("div"),this.money.style.cssText="font-size:14px; position:absolute; width:70px; height:19px; bottom:15px; left:295px; text-align:right; font-weight:bold;",this.population=document.createElement("div"),this.population.style.cssText="font-size:14px; position:absolute; width:70px; height:19px; bottom:15px; left:180px; text-align:right; font-weight:bold;",this.score=document.createElement("div"),this.score.style.cssText="font-size:14px; position:absolute; width:70px; height:19px; bottom:15px; left:410px; text-align:right; font-weight:bold;",this.msg=document.createElement("div"),this.msg.style.cssText="font-size:14px; letter-spacing:0.02em; position:absolute; width:420px; height:20px; bottom:44px; left:76px; text-align:left; color:"+this.colors[4]+"; font-weight:bold;",this.hub.appendChild(this.date),this.hub.appendChild(this.money),this.hub.appendChild(this.population),this.hub.appendChild(this.score),this.hub.appendChild(this.msg),this.initRCI()}updateCITYinfo(t){this.date.innerHTML=t[0],this.money.innerHTML=t[4],this.population.innerHTML=t[3],this.score.innerHTML=t[2],this.msg.innerHTML=t[8],this.updateRCI(t[5],t[6],t[7])}testOpen(){var t="";return null!==this.budgetWindow&&"open"==this.budgetWindow.className&&(this.closeBudget(),t="budget"),null!==this.evaluationWindow&&"open"==this.evaluationWindow.className&&(this.closeEval(),t="evaluation"),null!==this.disasterWindow&&"open"==this.disasterWindow.className&&(this.closeDisaster(),t="disaster"),null!==this.exitWindow&&"open"==this.exitWindow.className&&(this.closeExit(),t="exit"),null!==this.queryWindow&&"open"==this.queryWindow.className&&(this.closeQuery(),t="query"),null!==this.overlaysWindow&&"open"==this.overlaysWindow.className&&(this.closeOverlays(),t="overlays"),null!==this.aboutWindow&&"open"==this.aboutWindow.className&&(this.closeAbout(),t="about"),t}openAbout(t){var e=this;if("about"!=this.testOpen()){if(null==this.aboutWindow)this.aboutWindow=document.createElement("div"),this.aboutWindow.style.cssText=this.radius+"position:absolute; width:200px; height:210px; pointer-events:none; display:block;"+this.windowsStyle,this.hub.appendChild(this.aboutWindow),this.addButton(this.aboutWindow,"X",[16,16,14],"position:absolute; left:10px; top:10px;").addEventListener("click",(function(t){t.preventDefault(),e.closeAbout()}),!1),this.fps=document.createElement("div"),this.fps.style.cssText="position:absolute; top:20px; left:60px; width:120px; height:20px; pointer-events:none; font-size:12px; text-align:center; color:"+this.colors[0]+";",this.aboutWindow.appendChild(this.fps),this.abb=document.createElement("div"),this.abb.style.cssText="position:absolute; top:60px; left:10px; width:180px; height:180px; pointer-events:none; font-size:12px; text-align:center; color:"+this.colors[0]+";",this.aboutWindow.appendChild(this.abb),this.linke=document.createElement("div"),this.linke.style.cssText="position:absolute; top:160px; left:10px; width:180px; height:20px; pointer-events:auto; font-size:12px; text-align:center; color:"+this.colors[0]+";",this.aboutWindow.appendChild(this.linke),this.abb.innerHTML="3D CITY<br><br>All 3d side made by Lo.th<br>Simulation from MicropolisJS<br><br><br>More info and source<br>",this.linke.innerHTML="<a href='https://github.com/lo-th/3d.city' target='_blank'>https://github.com/lo-th/3d.city";else this.aboutWindow.style.display="block";Main.showStats(),this.aboutWindow.className="open"}}upStats(t,e){this.fps.innerHTML="Fps: "+t+" <br> geometry: "+e}closeAbout(){Main.hideStats(),this.aboutWindow.style.display="none",this.aboutWindow.className="close"}openOverlays(t){if("overlays"!=this.testOpen()){if(null==this.overlaysWindow){this.overlaysWindow=document.createElement("div"),this.overlaysWindow.style.cssText=this.radius+"position:absolute; width:140px; height:420px; pointer-events:none; display:block;"+this.windowsStyle,this.hub.appendChild(this.overlaysWindow);for(var e=0;e<this.overlaysTypes.length;e++)this.overlaysButtons[e]=this.addButton(this.overlaysWindow,this.overlaysTypes[e].toUpperCase(),[96,16,14],"position:absolute; left:10px; top:"+(10+40*e)+"px;"),this.overlaysButtons[e].name=this.overlaysTypes[e],this.overlaysButtons[e].addEventListener("click",(function(t){t.preventDefault(),setOverlays(this.name)}),!1)}else this.overlaysWindow.style.display="block";this.overlaysWindow.className="open"}}closeOverlays(){this.overlaysWindow.style.display="none",this.overlaysWindow.className="close"}openQuery(t){var e=this;null==this.queryWindow?(this.queryWindow=document.createElement("div"),this.queryWindow.style.cssText=this.radius+"position:absolute; width:140px; height:180px; pointer-events:none; display:block;"+this.windowsStyle,this.hub.appendChild(this.queryWindow),this.addButton(this.queryWindow,"X",[16,16,14],"position:absolute; left:50px; top:10px;").addEventListener("click",(function(t){t.preventDefault(),e.closeQuery()}),!1),this.queryResult=document.createElement("div"),this.queryResult.style.cssText="position:absolute; top:60px; left:10px; width:110px; height:100px; pointer-events:none; font-size:12px; text-align:center; color:"+this.colors[0]+";",this.queryWindow.appendChild(this.queryResult)):this.queryWindow.style.display="block";this.queryResult.innerHTML=t,this.queryWindow.className="open"}closeQuery(){this.queryWindow.style.display="none",this.queryWindow.className="close"}openEval(t){"evaluation"!=this.testOpen()&&(null==this.evaluationWindow?(this.evaluationWindow=document.createElement("div"),this.evaluationWindow.style.cssText=this.radius+"position:absolute; width:200px; height:300px; pointer-events:none; display:block;"+this.windowsStyle,this.hub.appendChild(this.evaluationWindow),this.evaltOpinion=document.createElement("div"),this.evaltOpinion.style.cssText="position:absolute; top:10px; left:10px; width:180px; height:100px; pointer-events:none; color:"+this.colors[0]+";",this.evaluationWindow.appendChild(this.evaltOpinion),this.evaltYes=document.createElement("div"),this.evaltYes.style.cssText="position:absolute; top:46px; left:26px; width:60px; height:20px; pointer-events:none; color:#33FF33; font-size:16px; font-weight:bold;",this.evaluationWindow.appendChild(this.evaltYes),this.evaltNo=document.createElement("div"),this.evaltNo.style.cssText="position:absolute; top:46px; right:26px; width:60px; height:20px; pointer-events:none; color:#FF3300;  font-size:16px; font-weight:bold;",this.evaluationWindow.appendChild(this.evaltNo),this.evaltProb=document.createElement("div"),this.evaltProb.style.cssText="position:absolute; top:100px; left:10px; width:180px; height:60px; pointer-events:none; color:"+this.colors[0]+"; font-size:16px; ",this.evaluationWindow.appendChild(this.evaltProb),this.evaltOpinion.innerHTML="<b>Public opinion</b><br>Is the mayor doing a good job ?<br> <br> <br> <br>What are the worst problems ?<br>"):this.evaluationWindow.style.display="block",this.evaltYes.innerHTML="YES:"+t[0]+"%",this.evaltNo.innerHTML="NO:"+(100-t[0])+"%",this.evaltProb.innerHTML=t[1],this.evaluationWindow.className="open")}closeEval(){this.evaluationWindow.style.display="none",this.evaluationWindow.className="close"}openExit(t){var e=this;if("exit"!=this.testOpen()){if(null==this.exitWindow){this.exitWindow=document.createElement("div"),this.exitWindow.style.cssText=this.radius+"position:absolute; width:140px; height:180px; pointer-events:none; display:block;"+this.windowsStyle,this.hub.appendChild(this.exitWindow);var i=this.addButton(this.exitWindow,"X",[16,16,14],"position:absolute; left:50px; top:10px;"),s=this.addButton(this.exitWindow,"NEW MAP",[96,16,14],"position:absolute; left:10px; top:50px;"),o=this.addButton(this.exitWindow,"SAVE",[96,16,14],"position:absolute; left:10px; top:90px;"),n=this.addButton(this.exitWindow,"LOAD",[96,16,14],"position:absolute; left:10px; top:130px;");i.addEventListener("click",(function(t){t.preventDefault(),e.closeExit()}),!1),s.addEventListener("click",(function(t){t.preventDefault(),Main.newGameMap()}),!1),o.addEventListener("click",(function(t){t.preventDefault(),Main.saveGame()}),!1),n.addEventListener("click",(function(t){t.preventDefault(),Main.loadGame()}),!1)}else this.exitWindow.style.display="block";this.exitWindow.className="open"}}closeExit(){this.exitWindow.style.display="none",this.exitWindow.className="close"}openBudget(t){var e=this;if("budget"!=this.testOpen()){this.dataKeys=["roadFund","roadRate","fireFund","fireRate","policeFund","policeRate","taxRate","totalFunds","taxesCollected"];for(var i=this.dataKeys.length;i--;)this[this.dataKeys[i]]=t[this.dataKeys[i]];t.totalFunds;var s=t.taxesCollected,o=s-this.roadFund-this.fireFund-this.policeFund;if(null==this.budgetWindow){this.budgetWindow=document.createElement("div"),this.budgetWindow.style.cssText=this.radius+"position:absolute; width:200px; height:300px; pointer-events:none; display:block;"+this.windowsStyle,this.hub.appendChild(this.budgetWindow),this.addSlider(this.budgetWindow,10,"Tax",this.taxRate,null,"green",20),this.addSlider(this.budgetWindow,70,"Roads",this.roadRate,this.roadFund,"red",100),this.addSlider(this.budgetWindow,110,"Fire",this.fireRate,this.fireFund,"red",100),this.addSlider(this.budgetWindow,150,"Police",this.policeRate,this.policeFund,"red",100),this.budgetResult=document.createElement("div"),this.budgetResult.style.cssText="position:absolute; top:200px; left:10px; width:180px; height:300px; pointer-events:none; color:"+this.colors[0]+";",this.budgetWindow.appendChild(this.budgetResult);var n=this.addButton(this.budgetWindow,"CLOSE",[70,16,14],"position:absolute; left:10px; bottom:10px;"),l=this.addButton(this.budgetWindow,"APPLY",[70,16,14],"position:absolute; rigth:10px; bottom:10px;");n.addEventListener("click",(function(t){t.preventDefault(),e.closeBudget()}),!1),l.addEventListener("click",(function(t){t.preventDefault(),e.applyBudget()}),!1)}else this.budgetWindow.style.display="block",this.setBudgetValue();this.budgetResult.innerHTML="Annual receipts:"+o+"$<br>Taxes collected:"+s+"$",this.budgetWindow.className="open"}}applyBudget(){this.budgetWindow.style.display="none",this.budgetWindow.className="close",Main.setBudjet([this.taxRate,this.roadRate,this.fireRate,this.policeRate])}closeBudget(){this.budgetWindow.style.display="none",this.budgetWindow.className="close"}setBudgetValue(){this.setSliderValue("Tax",this.taxRate,20,null),this.setSliderValue("Roads",this.roadRate,100,this.roadFund),this.setSliderValue("Fire",this.fireRate,100,this.fireFund),this.setSliderValue("Police",this.policeRate,100,this.policeFund)}openDisaster(){if("disaster"!=this.testOpen()){if(null==this.disasterWindow){this.disasterWindow=document.createElement("div"),this.disasterWindow.style.cssText=this.radius+"position:absolute; width:140px; height:300px; pointer-events:none; display:block;"+this.windowsStyle,this.hub.appendChild(this.disasterWindow);for(var t=0;t<this.disasterTypes.length;t++)this.disasterButtons[t]=this.addButton(this.disasterWindow,this.disasterTypes[t].toUpperCase(),[96,16,14],"position:absolute; left:10px; top:"+(10+40*t)+"px;"),this.disasterButtons[t].name=this.disasterTypes[t],this.disasterButtons[t].addEventListener("click",(function(t){t.preventDefault(),Main.setDisaster(this.name)}),!1)}else this.disasterWindow.style.display="block";this.disasterWindow.className="open"}}closeDisaster(){this.disasterWindow.style.display="none",this.disasterWindow.className="close"}addSlider(t,e,i,s,o,n,l){var d=this,a=document.createElement("div"),h=document.createElement("div"),r=document.createElement("div");a.style.cssText="position:absolute; left:10px; top:-18px; pointer-events:none; width:180px; height:20px; font-size:12px; color:"+this.colors[0]+";",h.style.cssText=this.radius+"position:absolute; left:10px; top:"+(e+20)+"px; padding:0; cursor:w-resize; pointer-events:auto; width:180px; height:20px; background-color:"+d.colors[1]+";",r.style.cssText=this.radius+"position:absolute; pointer-events:none; margin:5px; width:100px; height:10px; background-color:"+n+";",t.appendChild(h),h.appendChild(r),h.appendChild(a),h.name=i,h.id=i,a.innerHTML=null!==o?i+" "+s+"% of "+o+"$ = "+Math.floor(o*(s/100))+"$":i+" "+s+"%",r.style.width=s/l*170+"px",h.className="up",h.addEventListener("mouseout",(function(t){t.preventDefault(),this.className="up",this.style.backgroundColor=d.colors[1]}),!1),h.addEventListener("mouseover",(function(t){t.preventDefault(),this.style.backgroundColor=d.colors[2]}),!1),h.addEventListener("mouseup",(function(t){t.preventDefault(),this.className="up"}),!1),h.addEventListener("mousedown",(function(t){t.preventDefault(),this.className="down",d.dragSlider(this,t.clientX,l)}),!1),h.addEventListener("mousemove",(function(t){t.preventDefault(),d.dragSlider(this,t.clientX,l)}),!1)}setSliderValue(t,e,i,s){var o=document.getElementById(t).childNodes;o[0].style.width=e/i*170+"px",o[1].innerHTML=null!==s?t+" "+e+"% of "+s+"$ = "+Math.floor(s*(e/100))+"$":t+" "+e+"%"}dragSlider(t,e,i){if("down"==t.className){var s=t.childNodes,o=t.getBoundingClientRect(),n=Math.round((e-o.left)/170*i);switch(n<0&&(n=0),n>i&&(n=i),s[0].style.width=n/i*170+"px",t.name){case"Tax":s[1].innerHTML=t.name+" "+n+"%",this.taxRate=n;break;case"Roads":s[1].innerHTML=t.name+" "+n+"% of "+this.roadFund+"$ = "+Math.floor(this.roadFund*(n/100))+"$",this.roadRate=n;break;case"Fire":s[1].innerHTML=t.name+" "+n+"% of "+this.fireFund+"$ = "+Math.floor(this.fireFund*(n/100))+"$",this.fireRate=n;break;case"Police":s[1].innerHTML=t.name+" "+n+"% of "+this.policeFund+"$ = "+Math.floor(this.policeFund*(n/100))+"$",this.policeRate=n;break}}}initRCI(){var t=document.createElement("div");t.id="RCI",t.style.cssText="font-size:10px; position:absolute; width:70px; height:70px; bottom:20px; right:20px;";var e=document.createElement("div");e.style.cssText="font-size:10px; position:absolute; width:46px; height:14px; bottom:28px; left:10px; background:#cccccc; padding:0px 2px;  letter-spacing:12px; text-align:center; color:#000000;",e.innerHTML="RCI",this.R=document.createElement("div"),this.R.id="R",this.R.style.cssText="position:absolute; width:10px; height:20px; bottom:42px; left:10px; background:#30ff30;",t.appendChild(this.R),this.C=document.createElement("div"),this.C.id="C",this.C.style.cssText="position:absolute; width:10px; height:20px; bottom:42px; left:30px; background:#3030ff;",t.appendChild(this.C),this.I=document.createElement("div"),this.I.id="I",this.I.style.cssText="position:absolute; width:10px; height:20px; bottom:42px; left:50px; background:#ffff30;",t.appendChild(this.I),t.appendChild(e),this.hub.appendChild(t)}updateRCI(t,e,i){this.R.style.height=t/100+"px",this.C.style.height=e/100+"px",this.I.style.height=i/100+"px",this.R.style.bottom=t>0?"42px":28+t/100+"px",this.C.style.bottom=e>0?"42px":28+e/100+"px",this.I.style.bottom=i>0?"42px":28+i/100+"px"}addSelector(t,e,i,s,o){var n=this,l=document.createElement("div");l.style.cssText="font-size:14px; margin-top:10px; color:"+this.colors[0]+";","Speed"==t?l.style.cssText="font-size:20px; position:absolute; bottom:8px; left:497px; ":l.innerHTML=t+"<br>",l.id=t;for(var d=[],a=0;a!==e.length;a++)d[a]=document.createElement("div"),d[a].style.cssText="font-size:14px; border:1px solid "+this.colors[5]+"; background:"+this.colors[1]+"; color:"+this.colors[0]+";",d[a].style.cssText+="Speed"==t?" width:70px; height:16px; margin-left:2px; padding:6px; pointer-events:auto;  cursor:pointer; display:inline-block; ":" width:70px; height:16px; margin:2px; padding:7px; pointer-events:auto;  cursor:pointer; display:inline-block; ",0==a&&(d[a].style.cssText+=this.radiusL),a==e.length-1&&(d[a].style.cssText+=this.radiusR),o&&o[a]?(d[a].style.width=o[a]+"px",d[a].style.height=o[a]+"px",d[a].style.padding="0px"):d[a].style.width="60px",d[a].className="none","Speed"!==t&&(d[a].textContent=e[a]),a==s&&(d[a].style.backgroundColor=this.colors[5],d[a].style.color=this.colors[2],d[a].className="select"),d[a].name=a,d[a].id=t+a,l.appendChild(d[a]),d[a].addEventListener("mouseover",(function(t){t.preventDefault(),this.style.border="1px solid "+n.colors[0]}),!1),d[a].addEventListener("mouseout",(function(t){t.preventDefault(),this.style.border="1px solid "+n.colors[5]}),!1),d[a].addEventListener("click",(function(e){e.preventDefault(),i(this.name),n.setActiveSelector(this.name,t)}),!1);"DIFFICULTY"==t?(this.full.appendChild(l),l.style.position="absolute",l.style.top="200px",l.style.width="300px"):this.hub.appendChild(l)}setActiveSelector(t,e){for(var i,s=10;s--;)document.getElementById(e+s)&&((i=document.getElementById(e+s)).style.color=this.colors[0],i.style.backgroundColor=this.colors[1],i.className="none");var o=document.getElementById(e+t);o.style.backgroundColor=this.colors[5],o.style.color=this.colors[2],o.className="select"}removeSelector(t){for(var e,i=10,s=document.getElementById(t);i--;)document.getElementById(t+i)&&(e=document.getElementById(t+i),s.removeChild(e));this.full.removeChild(s)}showToolSelect(t){if(t.name!==this.currentToolName){this.currentToolName=t.name;var e=t.getBoundingClientRect().left-this.toolSet.getBoundingClientRect().left,i=t.getBoundingClientRect().top-this.toolSet.getBoundingClientRect().top;this.select.style.left=e+"px",this.select.style.top=i+"px",this.select.style.display="block"}else this.select.style.display="none",this.currentToolName=0;Main.selectTool(this.currentToolName)}showToolInfo(t,e){var i=Base.toolSet[t.name].tool;i=i.charAt(0).toUpperCase()+i.substring(1).toLowerCase(),16===t.name?e.toolInfo.innerHTML="Drag view":178===t.name?e.toolInfo.innerHTML="Get info":18===t.name?e.toolInfo.innerHTML="Rotate view":e.toolInfo.innerHTML=i+"<br>"+Base.toolSet[t.name].price+"$"}addSVGButton(t){var e=this,i=document.createElement("div");return i.style.cssText=" margin:0px; padding:0px; width:66px; height:66px; pointer-events:auto; cursor:pointer; display:inline-block; line-height:0px; vertical-align: top;",i.innerHTML=this.round,i.addEventListener("mouseover",(function(t){t.preventDefault();var i=this.getBoundingClientRect().left-e.toolSet.getBoundingClientRect().left,s=this.getBoundingClientRect().top-e.toolSet.getBoundingClientRect().top;e.selector.style.left=i+"px",e.selector.style.top=s+"px",e.selector.style.display="block",e.showToolInfo(this,e)}),!1),i.addEventListener("mouseout",(function(t){t.preventDefault(),e.selector.style.display="none"}),!1),i.addEventListener("click",(function(t){t.preventDefault(),e.showToolSelect(this)}),!1),t.appendChild(i),i}addButton(t,e,i,s,o){var n=this;i||(i=[128,30,22]);var l=document.createElement("div"),d="font-size:"+i[2]+"px;  border:1px solid "+this.colors[5]+"; background:"+this.colors[1]+"; width:"+i[0]+"px; height:"+i[1]+"px; color:"+this.colors[0]+";";return d+=o?"margin:4px; padding:7px; pointer-events:auto;  cursor:pointer; display:inline-block; "+this.radiusB:"margin:4px; padding:7px; pointer-events:auto;  cursor:pointer; display:inline-block; "+this.radius,l.textContent=e,l.style.cssText=s?d+s:d+"margin-top:20px;",l.addEventListener("mouseover",(function(t){t.preventDefault(),this.style.backgroundColor=n.colors[5],this.style.color=n.colors[2]}),!1),l.addEventListener("mouseout",(function(t){t.preventDefault(),this.style.backgroundColor=n.colors[1],this.style.color=n.colors[0]}),!1),t.appendChild(l),l}clearElement(t){for(var e=document.getElementById(t),i=e.childNodes,s=i.length;s--;)e.removeChild(i[s]);this.hub.removeChild(e)}}