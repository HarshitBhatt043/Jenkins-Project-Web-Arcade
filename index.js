void 0===window.define&&(window.define=function(){},window.define.amd=1),void 0===window.$AJB&&(window.$AJB={}),$AJB.lib={},$AJB.general={},$AJB.page={},$AJB.lib.stopEvent=function(){"use strict";return function(e){e&&(e.preventDefault?(e.preventDefault(),e.stopPropagation()):(e.returnValue=!1,e.cancelBubble=!0))}},$AJB.lib.Storage=function(){"use strict";return{setValue:function(e,n){window.localStorage&&(window.localStorage[e]=n)},getValue:function(e){return window.localStorage?window.localStorage[e]:void 0}}},$AJB.general.BeginStage=function(){"use strict";var e=$AJB.lib.addEvent(),n=$AJB.lib.CustEvent(),t=($AJB.lib.util(),n()),o=0,r="start";return function(n){var i=n.getElementsByClassName("button")[0],l=n.getElementsByClassName("text")[0],a=document.getElementById("txtAr"),u={show:function(){n.style.display=""},hide:function(){n.style.display="none"},level:function(e){o=e,l.innerHTML="Level "+e},on:function(e,n){t.add(e,n)},off:function(e,n){t.remove(e,n)}};return e(i,"click",(function(){t.fire(r,o)})),a.innerHTML="GO",u}},$AJB.general.Switcher=function(){"use strict";return function(e,n,t){var o,r,i=null,l=!1,a={point:[0,0],enabled:!1,color:"#c8c8c8",update:function(){var e=a.point;a.enabled&&(0===r?(o=a.color,e[0]<n/2?(e[0]=Math.min(e[0]+30,n/2),a.point=e):(a.point=e,l=!0)):1===r&&(o="#000",e[0]>n/2?(e[0]=Math.max(e[0]-30,n/2),a.point=e):(a.point=e,l=!0)))},render:function(){var r=a.point;a.enabled&&(e.fillStyle=o,e.fillRect(r[0]-n/2,r[1]-t/2,n,t),l&&(a.enabled=!1,i&&i()))},switchStage:function(o,u){0===o?a.point=[-n/2,t/2]:1===o&&(e.fillStyle=a.color,e.fillRect(0,0,n,t),a.point=[n+n/2,t/2]),a.enabled=!0,l=!1,r=o,i=u}};return a}},$AJB.lib.addEvent=function(){var e=$AJB.lib.util(),n={click:"touchstart",mousedown:"touchstart",mouseup:"touchend"};return function(t,o,r,i){t.addEventListener?t.addEventListener(e.isMobile&&n[o]||o,r,i):t.attachEvent?t.attachEvent("on"+o,r):t["on"+o]=r}},$AJB.general.Levels=function(){"use strict";function e(e,n){return function(){var t=0;return function(){return t+=e*n%360}}}function n(e,n){return function(){var t=0,o=1,r=+new Date;return function(){var i=+new Date;return i-r>n&&(o=-o,r=i),t+=o*e%360}}}function t(e,n,t,o){return function(){var r=0,i=+new Date;return function(){var l=+new Date;return l-i>t&&(e=n-e,i=l),r+=e*o%360}}}function o(e,n,t,o){l[e]={childs:u[n],queueCount:t,round:a[o]}}var r,i=$AJB.lib.addEvent(),l={},a={A1:e(1.5,1),A2:e(1.5,-1),B1:e(2.5,1),B2:e(2.5,-1),C1:n(2.2,3e3),C2:n(3.5,2e3),D1:t(2,2.3,1200,1),D2:t(2,2.3,1200,-1),D3:t(4,4.5,1700,1),D4:t(4,4.5,1700,-1),D5:t(4,4.5,1700,1),D6:t(4,4.5,1700,-1),E1:function(e){var n=1;return i(document.body,"mousedown",(function(){n=-n})),function(){var t=0;return function(){return t+=e*n%360}}}(2),E2:function(e,n,t,o){return i(document.body,"mousedown",(function(){o=-o})),function(){var r=0,i=+new Date;return function(){var l=+new Date;return l-i>t&&(e=n-e,i=l),r+=e*o%360}}}(2,2.3,1e3,1)},u={0:[],2:[0,180],3:[0,120,240],4:[0,90,180,270],5:[0,72,144,216,288],6:[0,60,120,180,240,300],7:[0,52,103,155,206,258,309],8:[0,45,90,135,180,225,270,315],9:[0,40,80,120,160,200,240,280,320],10:[0,36,72,108,144,180,216,252,288,324],11:[0,33,66,99,131,164,197,230,262,295,328],12:[0,30,60,90,120,150,180,210,240,270,300,330],13:[0,28,56,84,111,139,167,194,222,250,277,305,333],14:[0,26,52,78,103,129,155,180,206,232,258,283,309,335],15:[0,24,48,72,96,120,144,168,192,216,240,264,288,312,336],16:[0,23,45,68,90,113,135,158,180,203,225,248,270,293,315,338]},c={1:["4",8,"A1"],2:["6",10,"A1"],3:["2",20,"A1"],4:["8",12,"A2"],5:["12",8,"A1"],6:["10",10,"A2"],7:["12",12,"A1"],8:["16",3,"A2"],9:["0",26,"A2"],10:["16",10,"A1"],11:["10",8,"B1"],12:["6",12,"B2"],13:["12",4,"B1"],14:["8",14,"B2"],15:["8",6,"B1"],16:["5",10,"B2"],17:["6",12,"B1"],18:["8",14,"B2"],19:["0",23,"B1"],20:["10",13,"B2"],21:["4",12,"C1"],22:["6",10,"C1"],23:["8",12,"C1"],24:["7",14,"C1"],25:["2",18,"C1"],26:["4",18,"C1"],27:["0",24,"C1"],28:["4",10,"C2"],29:["6",13,"C2"],30:["4",20,"C1"],31:["6",8,"D1"],32:["2",12,"D2"],33:["3",14,"D2"],34:["3",18,"D1"],35:["8",12,"D1"],36:["7",15,"D2"],37:["16",8,"D2"],38:["0",23,"D1"],39:["12",12,"D1"],40:["12",15,"D2"],41:["5",10,"E1"],42:["6",12,"E1"],43:["3",15,"E1"],44:["3",19,"E1"],45:["0",24,"E1"],46:["2",15,"E2"],47:["4",16,"E2"],48:["12",8,"E2"],49:["3",20,"E2"],50:["16",14,"E2"],51:["4",6,"D3"],52:["4",12,"D4"],53:["6",13,"D3"],54:["0",24,"D4"],55:["4",21,"D3"],56:["16",16,"A1"],57:["4",24,"C1"],58:["4",26,"D1"],59:["4",25,"E2"],60:["13",19,"E2"]};for(r in c)o(r,c[r][0],c[r][1],c[r][2]);return l},$AJB.general.Collide=function(){"use strict";var e=$AJB.lib.util();return{check:function(n,t,o){var r=n.childs(),i=r.length,l=Math.ceil(2*t.rad());for(o=o||1;i--;)if(t!==r[i].ball&&e.getPointDistance(t.pos(),r[i].ball.pos())<=l+Math.ceil(2*o))return!0;return!1}}},$AJB.general.Tween=function(){"use strict";var e={simple:function(n,t,o,r){var i=(t-n)/r,l=+new Date;return r>l-o?(e.isEnd=!1,n+(l-o)*i):(e.isEnd=!0,t)},isEnd:!0};return e},$AJB.general.BallQueue=function(){"use strict";var e=$AJB.lib.CustEvent(),n=$AJB.general.Ball(),t=$AJB.general.Tween(),o="popup";return function(r,i,l,a,u){var c,d=[],s=[],f=e();return u=u||1,c={ballList:d,add:function(){},remove:function(e){var n=d[e];return d.splice(e,1),n},clear:function(){s=[],d=[]},popup:function(){var e=d.shift();e.st=+new Date,e.sv=e.pos().y,s.push(e)},update:function(){var e,n,r,a=s.length,u=d.length;if(a){for(n=s[0].rad(),e=l-3*n;a--;)s[a].pos(i,t.simple(s[a].sv,e,s[a].st,50)),r=s[s.length-1].pos().y,s[a].pos().y===e&&(f.fire(o,s[a]),s.splice(a,1));for(;u--;)d[u].pos(i,r+3*n*(u+1))}},render:function(){for(var e=d.length,n=s.length;e--;)d[e].render();for(;n--;)s[n].render()},on:function(e,n){f.add(e,n)},off:function(e,n){f.remove(e,n)},destroy:function(){for(var e=d.length;e--;)d[e].destroy();f.destroy()}},function(){var e,t,o=function(e){for(var n=e,t=[];n--;)t.push(n+1);return t}(r),c=o.length;for(e=0;c>e;e++)(t=n(a,null,o[e],null,u)).pos(i,l+3*t.rad()*e),d.push(t)}(),c}},$AJB.general.Ball=function(){"use strict";var e=$AJB.lib.util();return function(n,t,o,r,i){function l(){var t=e.getTextWidth(n,0,0,o,r);e.drawText(n,a-t/2,u+r/3,o,r,"black")}var a=0,u=0;return t=(t||12)*(i=i||1),r=(r||15)*i,{pos:function(e,n){return void 0!==e&&(a=e),void 0!==n&&(u=n),{x:a,y:u}},scale:function(e){return void 0!==e&&(i=e),i},rad:function(e){return void 0!==e&&(t=e),t},render:function(r){e.drawCircle(n,a,u,t,"#ffffff"),(void 0!==o||void 0!==r)&&l()},destroy:function(){null}}}},$AJB.lib.util=function(){"use strict";return{drawCircle:function(e,n,t,o,r){e.beginPath(),e.arc(n,t,o,0,2*Math.PI,!1),e.fillStyle=r||"red",e.fill()},drawLine:function(e,n,t,o,r,i,l){e.strokeStyle=i||"red",e.lineWidth=l||1,e.beginPath(),e.moveTo(n,t),e.lineTo(o,r),e.stroke()},drawText:function(e,n,t,o,r,i){e.font=r+"px Verdana",e.fillStyle=i||"red",e.fillText(o,n,t)},getTextWidth:function(e,n,t,o,r,i){return e.font=r+"px Verdana",e.fillStyle=i||"red",e.measureText(o).width},getPointDistance:function(e,n){return Math.floor(Math.sqrt(Math.floor(Math.pow(e.x-n.x,2))+Math.floor(Math.pow(e.y-n.y,2))))},isMobile:/(mobile|iphone|ipod|ipad|ios|android|windows phone)/i.test(navigator.userAgent),isAndroid:/android/i.test(navigator.userAgent),isWeixin:/MicroMessenger/i.test(navigator.userAgent)}},$AJB.general.Core=function(){"use strict";var e=$AJB.lib.util(),n=$AJB.general.Ball();return function(t,o,r,i,l){var a,u,c=0,d=[],s=50,f=t.width/2,g=4*s*l;return(a=n(o,s,r,i,l=l||1)).pos(f,g),u={pos:a.pos,scale:a.scale,rad:a.rad,angle:function(e){return void 0!==e&&(c=e),c},addChild:function(e,n){d.push({angle:e,ball:n})},clear:function(){d=[]},childs:function(){return d},update:function(){!function(){for(var e,n,t=d.length;t--;)e=3*Math.cos((d[t].angle+u.angle())*Math.PI/180)*s*l+f,n=3*Math.sin((d[t].angle+u.angle())*Math.PI/180)*s*l+g,Math.abs(e),Math.abs(n),d[t].ball.pos(e,n)}()},render:function(){var n,r=d.length,i=t.width,u=t.height;for(o.clearRect(0,0,i,u),n=0;r>n;n++)e.drawLine(o,f,g,d[n].ball.pos().x,d[n].ball.pos().y,"#ffffff",1.5*l),d[n].ball.render();a.render()},destroy:function(){u.clear(),a=null,u=null}}}},$AJB.lib.CustEvent=function(){return function(e){function n(e){return Object.prototype.toString.call(e).slice(8,-1).toLowerCase()}var t={};return!e&&(e={}),{add:function(e,o){if("function"===n(o)){var r=t;!r[e=e.toLowerCase()]&&(r[e]=[]),r[e].push(o)}},remove:function(e,o){var r,i=t[e];if(e=e.toLowerCase(),"function"===n(o)&&i&&i.length)for(r=i.length-1;r>=0;r--)i[r]===o&&i.splice(r,1)},fire:function(n){var o,r,i,l;if(n=n.toLowerCase(),(o=t[n])&&o.length)for(r=Array.prototype.slice.call(arguments,1),l=o.length,i=0;l>i;i++)o[i].apply(e,r)},destroy:function(){var e;for(e=t.length-1;e>=0;e--)evts.splice(e,1)}}}},$AJB.general.Scene=function(){"use strict";var e=$AJB.lib.CustEvent(),n=$AJB.general.Core(),t=$AJB.general.Ball(),o=$AJB.general.BallQueue(),r=$AJB.general.Collide(),i=$AJB.general.Levels(),l=$AJB.lib.util(),a="passed",u="failed",c=e();return function(e,d,s,f){function g(e){var i=e.childs,l=i.length;for(m=e.round(),A&&A.destroy(),A=n(d,s,C,50,f);l--;)A.addChild(i[l],t(s,null,"",null,f));y&&y.destroy(),(y=o(e.queueCount,d.width/2,A.pos().y+4*A.rad(),s,f)).on("popup",(function(e){A.addChild(90-A.angle(),e),r.check(A,e,f)?(J=e,p()):!y.ballList.length&&v()}))}function h(){var n,t,o,r,i=A.childs(),l=i.length;for(e.style.backgroundColor=w.bgColor;l--;)n=i[l].angle+A.angle(),t=25*Math.cos(n*Math.PI/180),o=25*Math.sin(n*Math.PI/180),r=i[l].ball.pos(),i[l].ball.pos(r.x+t,r.y+o)}function v(){"pass"!==$&&(e.style.backgroundColor="#1CB01A",$="pass",b=+new Date)}function p(){"fail"!==s&&(e.style.backgroundColor="#B8111C",$="fail",b=+new Date)}function B(){var e="to be continued...",n=l.getTextWidth(s,0,0,e,30*f);l.drawText(s,(d.width-n)/2,200*f,e,30*f,"yellow")}var w,b,A,y,m,J,$="run",C=1;return w={enabled:!1,run:function(n){var t=i[n];C=n,t?(w.enabled=!0,g(t),e.style.backgroundColor="#000",$="run"):B()},shot:function(){y&&y.ballList.length&&y.popup()},update:function(){var e;w.enabled&&("run"===$?m&&(A.angle(m()),A.update(),y.update()):"pass"===$?(h(),+new Date-b>1e3&&($="",c.fire(a))):"fail"===$&&(function(e){var n,t=[25,15,20,15],o=t.length,r=200/o;for(A.update(),n=1;o>=n;n++)e>r*n&&J.rad(t[n-1]*f)}(e=+new Date-b),e>1e3&&($="",c.fire(u))))},render:function(){w.enabled&&(A.render(),y.render())},on:function(e,n){c.add(e,n)},off:function(e,n){c.remove(e,n)}}}},$AJB.general.Game=function(){"use strict";function e(e){J=+e,c.setValue(A,J),document.title=y.replace(/\#\{level\}/,J),GlobalLevel=J,m.level(J),!d.isWeixin&&d.isMobile}function n(){window.clearTimeout(C),t.update(),t.render(),o.update(),o.render(),C=window.setTimeout(n,1e3/b)}var t,o,r,i=$AJB.general.Scene(),l=$AJB.general.Switcher(),a=$AJB.general.BeginStage(),u=$AJB.lib.addEvent(),c=$AJB.lib.Storage(),d=$AJB.lib.util(),s=$AJB.lib.stopEvent(),f=document.getElementById("stage"),g=document.getElementById("begin"),h=document.getElementById("tip"),v=document.getElementById("btnFW"),p=document.getElementById("btnReset"),B=document.getElementById("wxArrow"),w=f.getContext("2d"),b=60,A="core-ball-level",y="",m=a(g),J=+c.getValue(A)||1,$=!1,C=0,E={start:function(){(function(){var e=document.body.scrollWidth||document.documentElement.scrollWidth,n=document.body.scrollHeight||document.documentElement.scrollHeight;f.width=e,f.height=n,o=l(w,e,n),g.style.backgroundColor=o.color,g.style.width=e+"px",g.style.height=n+"px",r=n/560})(),t=i(document.body,f,w,r),u(document.body,"mousedown",(function(e){var n;if(e&&e.changedTouches)for(n=e.changedTouches.length;n--;)t.shot();else t.shot();"1"!=e.target.getAttribute("data-capture")&&s(e)})),u(B,"mousedown",(function(){B.style.display="none"})),u(p,"mousedown",(function(){$||($=!0,h.style.display="",e(1),setTimeout((function(){h.style.display="none",$=!1}),1e3))})),t.on("passed",(function(){o.switchStage(0,(function(){t.enabled=!1,e(J+1),f.style.display="none",m.show()}))})),t.on("failed",(function(){o.switchStage(0,(function(){t.enabled=!1,f.style.display="none",m.level(J),m.show()}))})),m.on("start",(function(){f.style.display="",m.hide(),o.switchStage(1,(function(){t.run(J)}))})),u(v,"mousedown",(function(){})),m.level(J),m.show(),n()},shareTitle:y,shareLevel:J};return E},$AJB.page.index=function(){"use strict";$AJB.general.Game().start()},$AJB.page.index(),GlobalLevel=$AJB.general.Game().shareLevel;