function AntiZoomAndPan(){this.init()}function EventHandler(){this.init()}Array.prototype.foreach=function(t){for(var e=this.length,n=0;n<e;n++)t(this[n])},Array.prototype.grep=function(t){for(var e=this.length,n=[],i=0;i<e;i++){var o=this[i];t(o)&&n.push(o)}return n},Array.prototype.map=function(t){for(var e=this.length,n=[],i=0;i<e;i++)n.push(t(this[i]));return n},Array.prototype.min=function(){for(var t=this.length,e=this[0],n=0;n<t;n++){var i=this[n];i<e&&(e=i)}return e},Array.prototype.max=function(){for(var t=this.length,e=this[0],n=0;n<t;n++)var i=this[n];return i>e&&(e=i),e},AntiZoomAndPan.VERSION="1.2",AntiZoomAndPan.prototype.init=function(){var t=svgDocument.documentElement;this.svgNodes=new Array,this.x_trans=0,this.y_trans=0,this.scale=1,this.lastTM=t.createSVGMatrix(),t.addEventListener("SVGZoom",this,!1),t.addEventListener("SVGScroll",this,!1),t.addEventListener("SVGResize",this,!1)},AntiZoomAndPan.prototype.appendNode=function(t){this.svgNodes.push(t)},AntiZoomAndPan.prototype.removeNode=function(t){for(var e=0;e<this.svgNodes.length;e++)if(this.svgNodes[e]===t){this.svgNodes.splice(e,1);break}},AntiZoomAndPan.prototype.handleEvent=function(t){var e=t.type;if(null==this[e])throw new Error("Unsupported event type: "+e);this[e](t)},AntiZoomAndPan.prototype.SVGZoom=function(t){this.update()},AntiZoomAndPan.prototype.SVGScroll=function(t){this.update()},AntiZoomAndPan.prototype.SVGResize=function(t){this.update()},AntiZoomAndPan.prototype.update=function(){if(this.svgNodes.length>0){var t=svgDocument.documentElement,e=null!=window.ViewBox?new ViewBox(t):null,n=null!=e?e.getTM():t.createSVGMatrix(),i=t.currentTranslate;n=(n=n.scale(1/t.currentScale)).translate(-i.x,-i.y);for(var o=0;o<this.svgNodes.length;o++){var s=this.svgNodes[o],r=n.multiply(this.lastTM.multiply(s.getCTM())),y="matrix("+[r.a,r.b,r.c,r.d,r.e,r.f].join(",")+")";this.svgNodes[o].setAttributeNS(null,"transform",y)}this.lastTM=n.inverse()}},EventHandler.VERSION=1,EventHandler.prototype.init=function(){},EventHandler.prototype.handleEvent=function(t){if(null==this[t.type])throw new Error("Unsupported event type: "+t.type);this[t.type](t)};var svgns="http://www.w3.org/2000/svg";function Mouser(){this.init()}function ViewBox(t){arguments.length>0&&this.init(t)}function Intersection(t){arguments.length>0&&this.init(t)}function IntersectionParams(t,e){arguments.length>0&&this.init(t,e)}function Point2D(t,e){arguments.length>0&&(this.x=t,this.y=e)}function Polynomial(){this.init(arguments)}function Vector2D(t,e){arguments.length>0&&(this.x=t,this.y=e)}function Shape(t){arguments.length>0&&this.init(t)}function Circle(t){arguments.length>0&&this.init(t)}function Ellipse(t){arguments.length>0&&this.init(t)}function Handle(t,e,n){arguments.length>0&&this.init(t,e,n)}function Lever(t,e,n,i,o){arguments.length>0&&this.init(t,e,n,i,o)}function LeverHandle(t,e,n){arguments.length>0&&this.init(t,e,n)}function Line(t){arguments.length>0&&this.init(t)}function Token(t,e){arguments.length>0&&this.init(t,e)}function Path(t){arguments.length>0&&this.init(t)}function AbsolutePathSegment(t,e,n,i){arguments.length>0&&this.init(t,e,n,i)}function AbsoluteArcPath(t,e,n){arguments.length>0&&this.init("A",t,e,n)}function AbsoluteCurveto2(t,e,n){arguments.length>0&&this.init("Q",t,e,n)}function AbsoluteCurveto3(t,e,n){arguments.length>0&&this.init("C",t,e,n)}function AbsoluteHLineto(t,e,n){arguments.length>0&&this.init("H",t,e,n)}function AbsoluteLineto(t,e,n){arguments.length>0&&this.init("L",t,e,n)}function AbsoluteMoveto(t,e,n){arguments.length>0&&this.init("M",t,e,n)}function AbsoluteSmoothCurveto2(t,e,n){arguments.length>0&&this.init("T",t,e,n)}function AbsoluteSmoothCurveto3(t,e,n){arguments.length>0&&this.init("S",t,e,n)}function RelativePathSegment(t,e,n,i){arguments.length>0&&this.init(t,e,n,i)}function RelativeClosePath(t,e,n){arguments.length>0&&this.init("z",t,e,n)}function RelativeCurveto2(t,e,n){arguments.length>0&&this.init("q",t,e,n)}function RelativeCurveto3(t,e,n){arguments.length>0&&this.init("c",t,e,n)}function RelativeLineto(t,e,n){arguments.length>0&&this.init("l",t,e,n)}function RelativeMoveto(t,e,n){arguments.length>0&&this.init("m",t,e,n)}function RelativeSmoothCurveto2(t,e,n){arguments.length>0&&this.init("t",t,e,n)}function RelativeSmoothCurveto3(t,e,n){arguments.length>0&&this.init("s",t,e,n)}function Polygon(t){arguments.length>0&&this.init(t)}function Rectangle(t){arguments.length>0&&this.init(t)}Mouser.prototype=new EventHandler,Mouser.prototype.constructor=Mouser,Mouser.superclass=EventHandler.prototype,Mouser.prototype.init=function(){this.svgNode=null,this.handles=new Array,this.shapes=new Array,this.lastPoint=null,this.currentNode=null,this.realize()},Mouser.prototype.realize=function(){if(null==this.svgNode){var t=svgDocument.createElementNS(svgns,"rect");this.svgNode=t,t.setAttributeNS(null,"x","-16384"),t.setAttributeNS(null,"y","-16384"),t.setAttributeNS(null,"width","32767"),t.setAttributeNS(null,"height","32767"),t.setAttributeNS(null,"fill","none"),t.setAttributeNS(null,"pointer-events","all"),t.setAttributeNS(null,"display","none"),svgDocument.documentElement.appendChild(t)}},Mouser.prototype.register=function(t){if(-1==this.handleIndex(t)){var e=t.owner;t.select(!0),this.handles.push(t),null!=e&&-1==this.shapeIndex(e)&&this.shapes.push(e)}},Mouser.prototype.unregister=function(t){var e=this.handleIndex(t);-1!=e&&(t.select(!1),this.handles.splice(e,1))},Mouser.prototype.registerShape=function(t){-1==this.shapeIndex(t)&&(t.select(!0),this.shapes.push(t))},Mouser.prototype.unregisterShape=function(t){var e=this.shapeIndex(t);-1!=e&&(t.select(!1),t.selectHandles(!1),t.showHandles(!1),t.unregisterHandles(),this.shapes.splice(e,1))},Mouser.prototype.unregisterAll=function(){for(var t=0;t<this.handles.length;t++)this.handles[t].select(!1);this.handles=new Array},Mouser.prototype.unregisterShapes=function(){for(var t=0;t<this.shapes.length;t++){var e=this.shapes[t];e.select(!1),e.selectHandles(!1),e.showHandles(!1),e.unregisterHandles()}this.shapes=new Array},Mouser.prototype.handleIndex=function(t){for(var e=-1,n=0;n<this.handles.length;n++)if(this.handles[n]===t){e=n;break}return e},Mouser.prototype.shapeIndex=function(t){for(var e=-1,n=0;n<this.shapes.length;n++)if(this.shapes[n]===t){e=n;break}return e},Mouser.prototype.beginDrag=function(t){this.currentNode=t.target;var e=this.getUserCoordinate(this.currentNode,t.clientX,t.clientY);this.lastPoint=new Point2D(e.x,e.y),this.svgNode.addEventListener("mouseup",this,!1),this.svgNode.addEventListener("mousemove",this,!1),svgDocument.documentElement.appendChild(this.svgNode),this.svgNode.setAttributeNS(null,"display","inline")},Mouser.prototype.mouseup=function(t){this.lastPoint=null,this.currentNode=null,this.svgNode.removeEventListener("mouseup",this,!1),this.svgNode.removeEventListener("mousemove",this,!1),this.svgNode.setAttributeNS(null,"display","none")},Mouser.prototype.mousemove=function(t){var e=this.getUserCoordinate(this.currentNode,t.clientX,t.clientY),n=new Point2D(e.x,e.y),i=n.subtract(this.lastPoint),o=new Array,s=(new Date).getTime();this.lastPoint.setFromPoint(n);for(var r=0;r<this.handles.length;r++){var y=this.handles[r],a=y.owner;y.translate(i),null!=a?a.lastUpdate!=s&&(a.lastUpdate=s,o.push(a)):o.push(y)}for(r=0;r<o.length;r++)o[r].update()},Mouser.prototype.getUserCoordinate=function(t,e,n){var i=svgDocument.documentElement,o=i.currentTranslate,s=i.currentScale,r=this.getTransformToElement(t).inverse(),y=svgDocument.documentElement.createSVGPoint();return y.x=(e-o.x)/s,y.y=(n-o.y)/s,y.matrixTransform(r)},Mouser.prototype.getTransformToElement=function(t){for(var e=t.getCTM();(t=t.parentNode)!=svgDocument;)e=t.getCTM().multiply(e);return e},ViewBox.VERSION="1.0",ViewBox.prototype.init=function(t){var e=t.getAttributeNS(null,"viewBox"),n=t.getAttributeNS(null,"preserveAspectRatio");if(null!=e&&""!=e){var i=e.split(/\s*,\s*|\s+/);this.x=parseFloat(i[0]),this.y=parseFloat(i[1]),this.width=parseFloat(i[2]),this.height=parseFloat(i[3])}else this.x=0,this.y=0,this.width=innerWidth,this.height=innerHeight;this.setPAR(n)},ViewBox.prototype.getTM=function(){var t=svgDocument.documentElement,e=svgDocument.documentElement.createSVGMatrix(),n=t.getAttributeNS(null,"width"),i=t.getAttributeNS(null,"height");n=null!=n&&""!=n?parseFloat(n):window.innerWidth?innerWidth:document.documentElement.viewport.width,i=null!=i&&""!=i?parseFloat(i):window.innerHeight?innerHeight:document.documentElement.viewport.height;var o=this.width/n,s=this.height/i;if(e=e.translate(this.x,this.y),"none"==this.alignX)e=e.scaleNonUniform(o,s);else if(o<s&&"meet"==this.meetOrSlice||o>s&&"slice"==this.meetOrSlice){var r=0,y=n*s-this.width;"Mid"==this.alignX?r=-y/2:"Max"==this.alignX&&(r=-y),e=(e=e.translate(r,0)).scale(s)}else if(o>s&&"meet"==this.meetOrSlice||o<s&&"slice"==this.meetOrSlice){var a=0,l=i*o-this.height;"Mid"==this.alignY?a=-l/2:"Max"==this.alignY&&(a=-l),e=(e=e.translate(0,a)).scale(o)}else e=e.scale(o);return e},ViewBox.prototype.setPAR=function(t){if(t){var e=t.split(/\s+/),n=e[0];"none"==n?(this.alignX="none",this.alignY="none"):(this.alignX=n.substring(1,4),this.alignY=n.substring(5,9)),2==e.length?this.meetOrSlice=e[1]:this.meetOrSlice="meet"}else this.align="xMidYMid",this.alignX="Mid",this.alignY="Mid",this.meetOrSlice="meet"},Intersection.prototype.init=function(t){this.status=t,this.points=new Array},Intersection.prototype.appendPoint=function(t){this.points.push(t)},Intersection.prototype.appendPoints=function(t){this.points=this.points.concat(t)},Intersection.intersectShapes=function(t,e){var n,i=t.getIntersectionParams(),o=e.getIntersectionParams();if(null!=i&&null!=o)if("Path"==i.name)n=Intersection.intersectPathShape(t,e);else if("Path"==o.name)n=Intersection.intersectPathShape(e,t);else{var s,r;if(i.name<o.name?(s="intersect"+i.name+o.name,r=i.params.concat(o.params)):(s="intersect"+o.name+i.name,r=o.params.concat(i.params)),!(s in Intersection))throw new Error("Intersection not available: "+s);n=Intersection[s].apply(null,r)}else n=new Intersection("No Intersection");return n},Intersection.intersectPathShape=function(t,e){return t.intersectShape(e)},Intersection.intersectBezier2Bezier2=function(t,e,n,i,o,s){var r,y,a,l,x,h,p=new Intersection("No Intersection");u=e.multiply(-2),r=t.add(u.add(n)),u=t.multiply(-2),c=e.multiply(2),y=u.add(c),a=new Point2D(t.x,t.y),u=o.multiply(-2),l=i.add(u.add(s)),u=i.multiply(-2),c=o.multiply(2),x=u.add(c),h=new Point2D(i.x,i.y);for(var u=r.x*y.y-y.x*r.y,c=l.x*y.y-y.x*l.y,d=x.x*y.y-y.x*x.y,g=y.x*(a.y-h.y)+y.y*(-a.x+h.x),v=l.x*r.y-r.x*l.y,m=x.x*r.y-r.x*x.y,f=r.x*(a.y-h.y)+r.y*(-a.x+h.x),P=new Polynomial(-v*v,-2*v*m,u*c-m*m-2*v*f,u*d-2*m*f,u*g-f*f).getRoots(),w=0;w<P.length;w++){var b=P[w];if(0<=b&&b<=1){var A=new Polynomial(-r.x,-y.x,-a.x+h.x+b*x.x+b*b*l.x).getRoots(),N=new Polynomial(-r.y,-y.y,-a.y+h.y+b*x.y+b*b*l.y).getRoots();if(A.length>0&&N.length>0)t:for(var S=0;S<A.length;S++){var I=A[S];if(0<=I&&I<=1)for(var C=0;C<N.length;C++)if(Math.abs(I-N[C])<1e-4){p.points.push(l.multiply(b*b).add(x.multiply(b).add(h)));break t}}}}return p},Intersection.intersectBezier2Bezier3=function(t,e,n,i,o,s,r){var y,a,l,x,h,p,u,c,d,g,v,m=new Intersection("No Intersection");y=e.multiply(-2),h=t.add(y.add(n)),y=t.multiply(-2),a=e.multiply(2),p=y.add(a),u=new Point2D(t.x,t.y),y=i.multiply(-1),a=o.multiply(3),l=s.multiply(-3),c=new Vector2D((x=y.add(a.add(l.add(r)))).x,x.y),y=i.multiply(3),a=o.multiply(-6),l=s.multiply(3),d=new Vector2D((x=y.add(a.add(l))).x,x.y),y=i.multiply(-3),a=o.multiply(3),g=new Vector2D((l=y.add(a)).x,l.y),v=new Vector2D(i.x,i.y);for(var f=u.x*u.x,P=u.y*u.y,w=p.x*p.x,b=p.y*p.y,A=h.x*h.x,N=h.y*h.y,S=v.x*v.x,I=v.y*v.y,C=g.x*g.x,L=g.y*g.y,R=d.x*d.x,D=d.y*d.y,E=c.x*c.x,M=c.y*c.y,H=new Polynomial(-2*h.x*h.y*c.x*c.y+A*M+N*E,-2*h.x*h.y*d.x*c.y-2*h.x*h.y*d.y*c.x+2*N*d.x*c.x+2*A*d.y*c.y,-2*h.x*g.x*h.y*c.y-2*h.x*h.y*g.y*c.x-2*h.x*h.y*d.x*d.y+2*g.x*N*c.x+N*R+A*(2*g.y*c.y+D),2*u.x*h.x*h.y*c.y+2*u.y*h.x*h.y*c.x+p.x*p.y*h.x*c.y+p.x*p.y*h.y*c.x-2*v.x*h.x*h.y*c.y-2*h.x*v.y*h.y*c.x-2*h.x*g.x*h.y*d.y-2*h.x*h.y*g.y*d.x-2*u.x*N*c.x-2*u.y*A*c.y+2*v.x*N*c.x+2*g.x*N*d.x-b*h.x*c.x-w*h.y*c.y+A*(2*v.y*c.y+2*g.y*d.y),2*u.x*h.x*h.y*d.y+2*u.y*h.x*h.y*d.x+p.x*p.y*h.x*d.y+p.x*p.y*h.y*d.x-2*v.x*h.x*h.y*d.y-2*h.x*v.y*h.y*d.x-2*h.x*g.x*h.y*g.y-2*u.x*N*d.x-2*u.y*A*d.y+2*v.x*N*d.x-b*h.x*d.x-w*h.y*d.y+C*N+A*(2*v.y*d.y+L),2*u.x*h.x*h.y*g.y+2*u.y*h.x*g.x*h.y+p.x*p.y*h.x*g.y+p.x*p.y*g.x*h.y-2*v.x*h.x*h.y*g.y-2*h.x*v.y*g.x*h.y-2*u.x*g.x*N-2*u.y*A*g.y+2*v.x*g.x*N-b*h.x*g.x-w*h.y*g.y+2*A*v.y*g.y,-2*u.x*u.y*h.x*h.y-u.x*p.x*p.y*h.y-u.y*p.x*p.y*h.x+2*u.x*h.x*v.y*h.y+2*u.y*v.x*h.x*h.y+p.x*v.x*p.y*h.y+p.x*p.y*h.x*v.y-2*v.x*h.x*v.y*h.y-2*u.x*v.x*N+u.x*b*h.x+u.y*w*h.y-2*u.y*A*v.y-v.x*b*h.x-w*v.y*h.y+f*N+P*A+S*N+A*I).getRootsInInterval(0,1),z=0;z<H.length;z++){var V=H[z],k=new Polynomial(h.x,p.x,u.x-v.x-V*g.x-V*V*d.x-V*V*V*c.x).getRoots(),B=new Polynomial(h.y,p.y,u.y-v.y-V*g.y-V*V*d.y-V*V*V*c.y).getRoots();if(k.length>0&&B.length>0){t:for(var F=0;F<k.length;F++){var T=k[F];if(0<=T&&T<=1)for(var O=0;O<B.length;O++)if(Math.abs(T-B[O])<1e-4){m.points.push(c.multiply(V*V*V).add(d.multiply(V*V).add(g.multiply(V).add(v))));break t}}}}return m.points.length>0&&(m.status="Intersection"),m},Intersection.intersectBezier2Circle=function(t,e,n,i,o){return Intersection.intersectBezier2Ellipse(t,e,n,i,o,o)},Intersection.intersectBezier2Ellipse=function(t,e,n,i,o,s){var r,y,a,l,x,h=new Intersection("No Intersection");r=e.multiply(-2),a=t.add(r.add(n)),r=t.multiply(-2),y=e.multiply(2),l=r.add(y),x=new Point2D(t.x,t.y);for(var p=o*o,u=s*s,c=new Polynomial(u*a.x*a.x+p*a.y*a.y,2*(u*a.x*l.x+p*a.y*l.y),u*(2*a.x*x.x+l.x*l.x)+p*(2*a.y*x.y+l.y*l.y)-2*(u*i.x*a.x+p*i.y*a.y),2*(u*l.x*(x.x-i.x)+p*l.y*(x.y-i.y)),u*(x.x*x.x+i.x*i.x)+p*(x.y*x.y+i.y*i.y)-2*(u*i.x*x.x+p*i.y*x.y)-p*u).getRoots(),d=0;d<c.length;d++){var g=c[d];0<=g&&g<=1&&h.points.push(a.multiply(g*g).add(l.multiply(g).add(x)))}return h.points.length>0&&(h.status="Intersection"),h},Intersection.intersectBezier2Line=function(t,e,n,i,o){var s,r,y,a,l,x,h,p=i.min(o),u=i.max(o),c=new Intersection("No Intersection");s=e.multiply(-2),y=t.add(s.add(n)),s=t.multiply(-2),r=e.multiply(2),a=s.add(r),l=new Point2D(t.x,t.y),h=new Vector2D(i.y-o.y,o.x-i.x),x=i.x*o.y-o.x*i.y,roots=new Polynomial(h.dot(y),h.dot(a),h.dot(l)+x).getRoots();for(var d=0;d<roots.length;d++){var g=roots[d];if(0<=g&&g<=1){var v=t.lerp(e,g),m=e.lerp(n,g),f=v.lerp(m,g);i.x==o.x?p.y<=f.y&&f.y<=u.y&&(c.status="Intersection",c.appendPoint(f)):i.y==o.y?p.x<=f.x&&f.x<=u.x&&(c.status="Intersection",c.appendPoint(f)):f.gte(p)&&f.lte(u)&&(c.status="Intersection",c.appendPoint(f))}}return c},Intersection.intersectBezier2Polygon=function(t,e,n,i){for(var o=new Intersection("No Intersection"),s=i.length,r=0;r<s;r++){var y=i[r],a=i[(r+1)%s],l=Intersection.intersectBezier2Line(t,e,n,y,a);o.appendPoints(l.points)}return o.points.length>0&&(o.status="Intersection"),o},Intersection.intersectBezier2Rectangle=function(t,e,n,i,o){var s=i.min(o),r=i.max(o),y=new Point2D(r.x,s.y),a=new Point2D(s.x,r.y),l=Intersection.intersectBezier2Line(t,e,n,s,y),x=Intersection.intersectBezier2Line(t,e,n,y,r),h=Intersection.intersectBezier2Line(t,e,n,r,a),p=Intersection.intersectBezier2Line(t,e,n,a,s),u=new Intersection("No Intersection");return u.appendPoints(l.points),u.appendPoints(x.points),u.appendPoints(h.points),u.appendPoints(p.points),u.points.length>0&&(u.status="Intersection"),u},Intersection.intersectBezier3Bezier3=function(t,e,n,i,o,s,r,y){var a,l,x,h,p,u,c,d,g,v,m,f,P=new Intersection("No Intersection");a=t.multiply(-1),l=e.multiply(3),x=n.multiply(-3),p=new Vector2D((h=a.add(l.add(x.add(i)))).x,h.y),a=t.multiply(3),l=e.multiply(-6),x=n.multiply(3),u=new Vector2D((h=a.add(l.add(x))).x,h.y),a=t.multiply(-3),l=e.multiply(3),c=new Vector2D((x=a.add(l)).x,x.y),d=new Vector2D(t.x,t.y),a=o.multiply(-1),l=s.multiply(3),x=r.multiply(-3),g=new Vector2D((h=a.add(l.add(x.add(y)))).x,h.y),a=o.multiply(3),l=s.multiply(-6),x=r.multiply(3),v=new Vector2D((h=a.add(l.add(x))).x,h.y),a=o.multiply(-3),l=s.multiply(3),m=new Vector2D((x=a.add(l)).x,x.y),f=new Vector2D(o.x,o.y);for(var w=d.x*d.x,b=d.x*d.x*d.x,A=d.y*d.y,N=d.y*d.y*d.y,S=c.x*c.x,I=c.x*c.x*c.x,C=c.y*c.y,L=c.y*c.y*c.y,R=u.x*u.x,D=u.x*u.x*u.x,E=u.y*u.y,M=u.y*u.y*u.y,H=p.x*p.x,z=p.x*p.x*p.x,V=p.y*p.y,k=p.y*p.y*p.y,B=f.x*f.x,F=f.x*f.x*f.x,T=f.y*f.y,O=f.y*f.y*f.y,q=m.x*m.x,Y=m.x*m.x*m.x,X=m.y*m.y,_=v.x*v.x,U=v.x*v.x*v.x,Z=v.y*v.y,G=g.x*g.x,Q=g.x*g.x*g.x,$=g.y*g.y,j=new Polynomial(-z*(g.y*g.y*g.y)+k*Q-3*p.x*V*G*g.y+3*H*p.y*g.x*$,-6*p.x*v.x*V*g.x*g.y+6*H*p.y*v.y*g.x*g.y+3*v.x*k*G-3*z*v.y*$-3*p.x*V*v.y*G+3*H*v.x*p.y*$,-6*m.x*p.x*V*g.x*g.y-6*p.x*v.x*V*v.y*g.x+6*H*v.x*p.y*v.y*g.y+3*m.x*k*G+3*_*k*g.x+3*m.x*H*p.y*$-3*p.x*m.y*V*G-3*p.x*_*V*g.y+H*p.y*g.x*(6*m.y*g.y+3*Z)+z*(-m.y*$-2*Z*g.y-g.y*(2*m.y*g.y+Z)),c.x*u.y*p.x*p.y*g.x*g.y-c.y*u.x*p.x*p.y*g.x*g.y+6*m.x*v.x*k*g.x+3*c.x*u.x*p.x*p.y*$+6*d.x*p.x*V*g.x*g.y-3*c.x*u.x*V*g.x*g.y-3*c.y*u.y*p.x*p.y*G-6*d.y*H*p.y*g.x*g.y-6*f.x*p.x*V*g.x*g.y+3*c.y*u.y*H*g.x*g.y-2*u.x*E*p.x*g.x*g.y-6*m.x*p.x*v.x*V*g.y-6*m.x*p.x*V*v.y*g.x-6*p.x*m.y*v.x*V*g.x+6*m.x*H*p.y*v.y*g.y+2*R*u.y*p.y*g.x*g.y+U*k-3*d.x*k*G+3*d.y*z*$+3*f.x*k*G+M*p.x*G-D*p.y*$-3*d.x*H*p.y*$+3*d.y*p.x*V*G-2*c.x*u.y*H*$+c.x*u.y*V*G-c.y*u.x*H*$+2*c.y*u.x*V*G+3*f.x*H*p.y*$-u.x*E*p.y*G-3*f.y*p.x*V*G+R*u.y*p.x*$-3*p.x*_*V*v.y+H*p.y*g.x*(6*f.y*g.y+6*m.y*v.y)+H*v.x*p.y*(6*m.y*g.y+3*Z)+z*(-2*m.y*v.y*g.y-f.y*$-v.y*(2*m.y*g.y+Z)-g.y*(2*f.y*g.y+2*m.y*v.y)),6*c.x*u.x*p.x*p.y*v.y*g.y+c.x*u.y*p.x*v.x*p.y*g.y+c.x*u.y*p.x*p.y*v.y*g.x-c.y*u.x*p.x*v.x*p.y*g.y-c.y*u.x*p.x*p.y*v.y*g.x-6*c.y*u.y*p.x*v.x*p.y*g.x-6*d.x*v.x*k*g.x+6*f.x*v.x*k*g.x+6*d.y*z*v.y*g.y+2*M*p.x*v.x*g.x-2*D*p.y*v.y*g.y+6*d.x*p.x*v.x*V*g.y+6*d.x*p.x*V*v.y*g.x+6*d.y*p.x*v.x*V*g.x-3*c.x*u.x*v.x*V*g.y-3*c.x*u.x*V*v.y*g.x+2*c.x*u.y*v.x*V*g.x+4*c.y*u.x*v.x*V*g.x-6*d.x*H*p.y*v.y*g.y-6*d.y*H*v.x*p.y*g.y-6*d.y*H*p.y*v.y*g.x-4*c.x*u.y*H*v.y*g.y-6*f.x*p.x*v.x*V*g.y-6*f.x*p.x*V*v.y*g.x-2*c.y*u.x*H*v.y*g.y+3*c.y*u.y*H*v.x*g.y+3*c.y*u.y*H*v.y*g.x-2*u.x*E*p.x*v.x*g.y-2*u.x*E*p.x*v.y*g.x-2*u.x*E*v.x*p.y*g.x-6*f.y*p.x*v.x*V*g.x-6*m.x*p.x*m.y*V*g.x-6*m.x*p.x*v.x*V*v.y+6*f.x*H*p.y*v.y*g.y+2*R*u.y*p.x*v.y*g.y+2*R*u.y*v.x*p.y*g.y+2*R*u.y*p.y*v.y*g.x+3*m.x*_*k+3*q*k*g.x-3*p.x*m.y*_*V-3*q*p.x*V*g.y+H*v.x*p.y*(6*f.y*g.y+6*m.y*v.y)+H*p.y*g.x*(6*f.y*v.y+3*X)+m.x*H*p.y*(6*m.y*g.y+3*Z)+z*(-2*f.y*v.y*g.y-g.y*(2*f.y*v.y+X)-m.y*(2*m.y*g.y+Z)-v.y*(2*f.y*g.y+2*m.y*v.y)),c.x*m.x*u.y*p.x*p.y*g.y+c.x*u.y*p.x*m.y*p.y*g.x+c.x*u.y*p.x*v.x*p.y*v.y-c.y*u.x*m.x*p.x*p.y*g.y-c.y*u.x*p.x*m.y*p.y*g.x-c.y*u.x*p.x*v.x*p.y*v.y-6*c.y*m.x*u.y*p.x*p.y*g.x-6*d.x*m.x*k*g.x+6*f.x*m.x*k*g.x+2*m.x*M*p.x*g.x+6*d.x*m.x*p.x*V*g.y+6*d.x*p.x*m.y*V*g.x+6*d.x*p.x*v.x*V*v.y+6*d.y*m.x*p.x*V*g.x-3*c.x*u.x*m.x*V*g.y-3*c.x*u.x*m.y*V*g.x-3*c.x*u.x*v.x*V*v.y+2*c.x*m.x*u.y*V*g.x+4*c.y*u.x*m.x*V*g.x-6*d.y*m.x*H*p.y*g.y-6*d.y*H*m.y*p.y*g.x-6*d.y*H*v.x*p.y*v.y-6*f.x*m.x*p.x*V*g.y-6*f.x*p.x*m.y*V*g.x-6*f.x*p.x*v.x*V*v.y+3*c.y*m.x*u.y*H*g.y-3*c.y*u.y*p.x*_*p.y+3*c.y*u.y*H*m.y*g.x+3*c.y*u.y*H*v.x*v.y-2*u.x*m.x*E*p.x*g.y-2*u.x*m.x*E*p.y*g.x-2*u.x*E*p.x*m.y*g.x-2*u.x*E*p.x*v.x*v.y-6*f.y*m.x*p.x*V*g.x-6*m.x*p.x*m.y*v.x*V+6*f.y*H*m.y*p.y*g.x+2*R*m.x*u.y*p.y*g.y+2*R*u.y*m.y*p.y*g.x+2*R*u.y*v.x*p.y*v.y-3*d.x*_*k+3*f.x*_*k+3*q*v.x*k+M*p.x*_+3*d.y*p.x*_*V+c.x*u.y*_*V+2*c.y*u.x*_*V-u.x*E*_*p.y-3*f.y*p.x*_*V-3*q*p.x*V*v.y+R*u.y*p.x*(2*m.y*g.y+Z)+c.x*u.x*p.x*p.y*(6*m.y*g.y+3*Z)+m.x*H*p.y*(6*f.y*g.y+6*m.y*v.y)+D*p.y*(-2*m.y*g.y-Z)+d.y*z*(6*m.y*g.y+3*Z)+c.y*u.x*H*(-2*m.y*g.y-Z)+c.x*u.y*H*(-4*m.y*g.y-2*Z)+d.x*H*p.y*(-6*m.y*g.y-3*Z)+H*v.x*p.y*(6*f.y*v.y+3*X)+f.x*H*p.y*(6*m.y*g.y+3*Z)+z*(-2*f.y*m.y*g.y-v.y*(2*f.y*v.y+X)-f.y*(2*m.y*g.y+Z)-m.y*(2*f.y*g.y+2*m.y*v.y)),-d.x*c.x*u.y*p.x*p.y*g.y+d.x*c.y*u.x*p.x*p.y*g.y+6*d.x*c.y*u.y*p.x*p.y*g.x-6*d.y*c.x*u.x*p.x*p.y*g.y-d.y*c.x*u.y*p.x*p.y*g.x+d.y*c.y*u.x*p.x*p.y*g.x+c.x*c.y*u.x*u.y*p.x*g.y-c.x*c.y*u.x*u.y*p.y*g.x+c.x*f.x*u.y*p.x*p.y*g.y+c.x*f.y*u.y*p.x*p.y*g.x+c.x*m.x*u.y*p.x*p.y*v.y+c.x*u.y*p.x*m.y*v.x*p.y-f.x*c.y*u.x*p.x*p.y*g.y-6*f.x*c.y*u.y*p.x*p.y*g.x-c.y*u.x*f.y*p.x*p.y*g.x-c.y*u.x*m.x*p.x*p.y*v.y-c.y*u.x*p.x*m.y*v.x*p.y-6*c.y*m.x*u.y*p.x*v.x*p.y-6*d.x*f.x*k*g.x-6*d.x*m.x*v.x*k-2*d.x*M*p.x*g.x+6*f.x*m.x*v.x*k+2*f.x*M*p.x*g.x+2*m.x*M*p.x*v.x+2*d.y*D*p.y*g.y-6*d.x*d.y*p.x*V*g.x+3*d.x*c.x*u.x*V*g.y-2*d.x*c.x*u.y*V*g.x-4*d.x*c.y*u.x*V*g.x+3*d.y*c.x*u.x*V*g.x+6*d.x*d.y*H*p.y*g.y+6*d.x*f.x*p.x*V*g.y-3*d.x*c.y*u.y*H*g.y+2*d.x*u.x*E*p.x*g.y+2*d.x*u.x*E*p.y*g.x+6*d.x*f.y*p.x*V*g.x+6*d.x*m.x*p.x*V*v.y+6*d.x*p.x*m.y*v.x*V+4*d.y*c.x*u.y*H*g.y+6*d.y*f.x*p.x*V*g.x+2*d.y*c.y*u.x*H*g.y-3*d.y*c.y*u.y*H*g.x+2*d.y*u.x*E*p.x*g.x+6*d.y*m.x*p.x*v.x*V-3*c.x*f.x*u.x*V*g.y+2*c.x*f.x*u.y*V*g.x+c.x*c.y*E*p.x*g.x-3*c.x*u.x*f.y*V*g.x-3*c.x*u.x*m.x*V*v.y-3*c.x*u.x*m.y*v.x*V+2*c.x*m.x*u.y*v.x*V+4*f.x*c.y*u.x*V*g.x+4*c.y*u.x*m.x*v.x*V-2*d.x*R*u.y*p.y*g.y-6*d.y*f.x*H*p.y*g.y-6*d.y*f.y*H*p.y*g.x-6*d.y*m.x*H*p.y*v.y-2*d.y*R*u.y*p.x*g.y-2*d.y*R*u.y*p.y*g.x-6*d.y*H*m.y*v.x*p.y-c.x*c.y*R*p.y*g.y-2*c.x*C*p.x*p.y*g.x+3*f.x*c.y*u.y*H*g.y-2*f.x*u.x*E*p.x*g.y-2*f.x*u.x*E*p.y*g.x-6*f.x*f.y*p.x*V*g.x-6*f.x*m.x*p.x*V*v.y-6*f.x*p.x*m.y*v.x*V+3*c.y*f.y*u.y*H*g.x+3*c.y*m.x*u.y*H*v.y+3*c.y*u.y*H*m.y*v.x-2*u.x*f.y*E*p.x*g.x-2*u.x*m.x*E*p.x*v.y-2*u.x*m.x*E*v.x*p.y-2*u.x*E*p.x*m.y*v.x-6*f.y*m.x*p.x*v.x*V-C*u.x*u.y*p.x*g.x+2*f.x*R*u.y*p.y*g.y+6*f.y*H*m.y*v.x*p.y+2*S*c.y*p.x*p.y*g.y+S*u.x*u.y*p.y*g.y+2*R*f.y*u.y*p.y*g.x+2*R*m.x*u.y*p.y*v.y+2*R*u.y*m.y*v.x*p.y+Y*k+3*w*k*g.x-3*A*z*g.y+3*B*k*g.x+L*H*g.x-I*V*g.y-c.x*C*H*g.y+S*c.y*V*g.x-3*w*p.x*V*g.y+3*A*H*p.y*g.x-S*E*p.x*g.y+C*R*p.y*g.x-3*q*p.x*m.y*V-3*B*p.x*V*g.y+3*T*H*p.y*g.x+c.x*u.x*p.x*p.y*(6*f.y*g.y+6*m.y*v.y)+D*p.y*(-2*f.y*g.y-2*m.y*v.y)+d.y*z*(6*f.y*g.y+6*m.y*v.y)+c.y*u.x*H*(-2*f.y*g.y-2*m.y*v.y)+R*u.y*p.x*(2*f.y*g.y+2*m.y*v.y)+c.x*u.y*H*(-4*f.y*g.y-4*m.y*v.y)+d.x*H*p.y*(-6*f.y*g.y-6*m.y*v.y)+f.x*H*p.y*(6*f.y*g.y+6*m.y*v.y)+m.x*H*p.y*(6*f.y*v.y+3*X)+z*(-2*f.y*m.y*v.y-T*g.y-m.y*(2*f.y*v.y+X)-f.y*(2*f.y*g.y+2*m.y*v.y)),-d.x*c.x*u.y*p.x*p.y*v.y+d.x*c.y*u.x*p.x*p.y*v.y+6*d.x*c.y*u.y*p.x*v.x*p.y-6*d.y*c.x*u.x*p.x*p.y*v.y-d.y*c.x*u.y*p.x*v.x*p.y+d.y*c.y*u.x*p.x*v.x*p.y+c.x*c.y*u.x*u.y*p.x*v.y-c.x*c.y*u.x*u.y*v.x*p.y+c.x*f.x*u.y*p.x*p.y*v.y+c.x*f.y*u.y*p.x*v.x*p.y+c.x*m.x*u.y*p.x*m.y*p.y-f.x*c.y*u.x*p.x*p.y*v.y-6*f.x*c.y*u.y*p.x*v.x*p.y-c.y*u.x*f.y*p.x*v.x*p.y-c.y*u.x*m.x*p.x*m.y*p.y-6*d.x*f.x*v.x*k-2*d.x*M*p.x*v.x+2*f.x*M*p.x*v.x+2*d.y*D*p.y*v.y-6*d.x*d.y*p.x*v.x*V+3*d.x*c.x*u.x*V*v.y-2*d.x*c.x*u.y*v.x*V-4*d.x*c.y*u.x*v.x*V+3*d.y*c.x*u.x*v.x*V+6*d.x*d.y*H*p.y*v.y+6*d.x*f.x*p.x*V*v.y-3*d.x*c.y*u.y*H*v.y+2*d.x*u.x*E*p.x*v.y+2*d.x*u.x*E*v.x*p.y+6*d.x*f.y*p.x*v.x*V+6*d.x*m.x*p.x*m.y*V+4*d.y*c.x*u.y*H*v.y+6*d.y*f.x*p.x*v.x*V+2*d.y*c.y*u.x*H*v.y-3*d.y*c.y*u.y*H*v.x+2*d.y*u.x*E*p.x*v.x-3*c.x*f.x*u.x*V*v.y+2*c.x*f.x*u.y*v.x*V+c.x*c.y*E*p.x*v.x-3*c.x*u.x*f.y*v.x*V-3*c.x*u.x*m.x*m.y*V+4*f.x*c.y*u.x*v.x*V-2*d.x*R*u.y*p.y*v.y-6*d.y*f.x*H*p.y*v.y-6*d.y*f.y*H*v.x*p.y-6*d.y*m.x*H*m.y*p.y-2*d.y*R*u.y*p.x*v.y-2*d.y*R*u.y*v.x*p.y-c.x*c.y*R*p.y*v.y-2*c.x*C*p.x*v.x*p.y+3*f.x*c.y*u.y*H*v.y-2*f.x*u.x*E*p.x*v.y-2*f.x*u.x*E*v.x*p.y-6*f.x*f.y*p.x*v.x*V-6*f.x*m.x*p.x*m.y*V+3*c.y*f.y*u.y*H*v.x+3*c.y*m.x*u.y*H*m.y-2*u.x*f.y*E*p.x*v.x-2*u.x*m.x*E*p.x*m.y-C*u.x*u.y*p.x*v.x+2*f.x*R*u.y*p.y*v.y-3*c.y*q*u.y*p.x*p.y+6*f.y*m.x*H*m.y*p.y+2*S*c.y*p.x*p.y*v.y+S*u.x*u.y*p.y*v.y+2*R*f.y*u.y*v.x*p.y+2*R*m.x*u.y*m.y*p.y-3*d.x*q*k+3*f.x*q*k+3*w*v.x*k-3*A*z*v.y+3*B*v.x*k+q*M*p.x+L*H*v.x-I*V*v.y+3*d.y*q*p.x*V-c.x*C*H*v.y+c.x*q*u.y*V+2*c.y*u.x*q*V+S*c.y*v.x*V-u.x*q*E*p.y-3*f.y*q*p.x*V-3*w*p.x*V*v.y+3*A*H*v.x*p.y-S*E*p.x*v.y+C*R*v.x*p.y-3*B*p.x*V*v.y+3*T*H*v.x*p.y+R*u.y*p.x*(2*f.y*v.y+X)+c.x*u.x*p.x*p.y*(6*f.y*v.y+3*X)+D*p.y*(-2*f.y*v.y-X)+d.y*z*(6*f.y*v.y+3*X)+c.y*u.x*H*(-2*f.y*v.y-X)+c.x*u.y*H*(-4*f.y*v.y-2*X)+d.x*H*p.y*(-6*f.y*v.y-3*X)+f.x*H*p.y*(6*f.y*v.y+3*X)+z*(-2*f.y*X-T*v.y-f.y*(2*f.y*v.y+X)),-d.x*c.x*u.y*p.x*m.y*p.y+d.x*c.y*u.x*p.x*m.y*p.y+6*d.x*c.y*m.x*u.y*p.x*p.y-6*d.y*c.x*u.x*p.x*m.y*p.y-d.y*c.x*m.x*u.y*p.x*p.y+d.y*c.y*u.x*m.x*p.x*p.y-c.x*c.y*u.x*m.x*u.y*p.y+c.x*c.y*u.x*u.y*p.x*m.y+c.x*f.x*u.y*p.x*m.y*p.y+6*c.x*u.x*f.y*p.x*m.y*p.y+c.x*f.y*m.x*u.y*p.x*p.y-f.x*c.y*u.x*p.x*m.y*p.y-6*f.x*c.y*m.x*u.y*p.x*p.y-c.y*u.x*f.y*m.x*p.x*p.y-6*d.x*f.x*m.x*k-2*d.x*m.x*M*p.x+6*d.y*f.y*z*m.y+2*f.x*m.x*M*p.x+2*d.y*D*m.y*p.y-2*D*f.y*m.y*p.y-6*d.x*d.y*m.x*p.x*V+3*d.x*c.x*u.x*m.y*V-2*d.x*c.x*m.x*u.y*V-4*d.x*c.y*u.x*m.x*V+3*d.y*c.x*u.x*m.x*V+6*d.x*d.y*H*m.y*p.y+6*d.x*f.x*p.x*m.y*V-3*d.x*c.y*u.y*H*m.y+2*d.x*u.x*m.x*E*p.y+2*d.x*u.x*E*p.x*m.y+6*d.x*f.y*m.x*p.x*V+4*d.y*c.x*u.y*H*m.y+6*d.y*f.x*m.x*p.x*V+2*d.y*c.y*u.x*H*m.y-3*d.y*c.y*m.x*u.y*H+2*d.y*u.x*m.x*E*p.x-3*c.x*f.x*u.x*m.y*V+2*c.x*f.x*m.x*u.y*V+c.x*c.y*m.x*E*p.x-3*c.x*u.x*f.y*m.x*V+4*f.x*c.y*u.x*m.x*V-6*d.x*f.y*H*m.y*p.y-2*d.x*R*u.y*m.y*p.y-6*d.y*f.x*H*m.y*p.y-6*d.y*f.y*m.x*H*p.y-2*d.y*R*m.x*u.y*p.y-2*d.y*R*u.y*p.x*m.y-c.x*c.y*R*m.y*p.y-4*c.x*f.y*u.y*H*m.y-2*c.x*C*m.x*p.x*p.y+3*f.x*c.y*u.y*H*m.y-2*f.x*u.x*m.x*E*p.y-2*f.x*u.x*E*p.x*m.y-6*f.x*f.y*m.x*p.x*V-2*c.y*u.x*f.y*H*m.y+3*c.y*f.y*m.x*u.y*H-2*u.x*f.y*m.x*E*p.x-C*u.x*m.x*u.y*p.x+6*f.x*f.y*H*m.y*p.y+2*f.x*R*u.y*m.y*p.y+2*S*c.y*p.x*m.y*p.y+S*u.x*u.y*m.y*p.y+2*R*f.y*m.x*u.y*p.y+2*R*f.y*u.y*p.x*m.y+3*w*m.x*k-3*A*z*m.y+3*B*m.x*k+L*m.x*H-I*m.y*V-3*T*z*m.y-c.x*C*H*m.y+S*c.y*m.x*V-3*w*p.x*m.y*V+3*A*m.x*H*p.y-S*E*p.x*m.y+C*R*m.x*p.y-3*B*p.x*m.y*V+3*T*m.x*H*p.y,d.x*d.y*c.x*u.y*p.x*p.y-d.x*d.y*c.y*u.x*p.x*p.y+d.x*c.x*c.y*u.x*u.y*p.y-d.y*c.x*c.y*u.x*u.y*p.x-d.x*c.x*f.y*u.y*p.x*p.y+6*d.x*f.x*c.y*u.y*p.x*p.y+d.x*c.y*u.x*f.y*p.x*p.y-d.y*c.x*f.x*u.y*p.x*p.y-6*d.y*c.x*u.x*f.y*p.x*p.y+d.y*f.x*c.y*u.x*p.x*p.y-c.x*f.x*c.y*u.x*u.y*p.y+c.x*c.y*u.x*f.y*u.y*p.x+c.x*f.x*f.y*u.y*p.x*p.y-f.x*c.y*u.x*f.y*p.x*p.y-2*d.x*f.x*M*p.x+2*d.y*D*f.y*p.y-3*d.x*d.y*c.x*u.x*V-6*d.x*d.y*f.x*p.x*V+3*d.x*d.y*c.y*u.y*H-2*d.x*d.y*u.x*E*p.x-2*d.x*c.x*f.x*u.y*V-d.x*c.x*c.y*E*p.x+3*d.x*c.x*u.x*f.y*V-4*d.x*f.x*c.y*u.x*V+3*d.y*c.x*f.x*u.x*V+6*d.x*d.y*f.y*H*p.y+2*d.x*d.y*R*u.y*p.y+2*d.x*c.x*C*p.x*p.y+2*d.x*f.x*u.x*E*p.y+6*d.x*f.x*f.y*p.x*V-3*d.x*c.y*f.y*u.y*H+2*d.x*u.x*f.y*E*p.x+d.x*C*u.x*u.y*p.x+d.y*c.x*c.y*R*p.y+4*d.y*c.x*f.y*u.y*H-3*d.y*f.x*c.y*u.y*H+2*d.y*f.x*u.x*E*p.x+2*d.y*c.y*u.x*f.y*H+c.x*f.x*c.y*E*p.x-3*c.x*f.x*u.x*f.y*V-2*d.x*R*f.y*u.y*p.y-6*d.y*f.x*f.y*H*p.y-2*d.y*f.x*R*u.y*p.y-2*d.y*S*c.y*p.x*p.y-d.y*S*u.x*u.y*p.y-2*d.y*R*f.y*u.y*p.x-2*c.x*f.x*C*p.x*p.y-c.x*c.y*R*f.y*p.y+3*f.x*c.y*f.y*u.y*H-2*f.x*u.x*f.y*E*p.x-f.x*C*u.x*u.y*p.x+3*A*c.x*u.x*p.x*p.y+3*c.x*u.x*T*p.x*p.y+2*f.x*R*f.y*u.y*p.y-3*w*c.y*u.y*p.x*p.y+2*S*c.y*f.y*p.x*p.y+S*u.x*f.y*u.y*p.y-3*B*c.y*u.y*p.x*p.y-b*k+N*z+F*k-O*z-3*d.x*B*k-d.x*L*H+3*w*f.x*k+d.y*I*V+3*d.y*T*z+f.x*L*H+w*M*p.x-3*A*f.y*z-A*D*p.y+B*M*p.x-I*f.y*V-D*T*p.y-d.x*S*c.y*V+d.y*c.x*C*H-3*d.x*A*H*p.y-d.x*C*R*p.y+d.y*S*E*p.x-c.x*C*f.y*H+3*w*d.y*p.x*V+w*c.x*u.y*V+2*w*c.y*u.x*V-2*A*c.x*u.y*H-A*c.y*u.x*H+S*f.x*c.y*V-3*d.x*T*H*p.y+3*d.y*B*p.x*V+c.x*B*u.y*V-2*c.x*T*u.y*H+f.x*C*R*p.y-c.y*u.x*T*H-w*u.x*E*p.y-3*w*f.y*p.x*V+3*A*f.x*H*p.y+A*R*u.y*p.x-S*f.y*E*p.x+2*B*c.y*u.x*V+3*f.x*T*H*p.y-B*u.x*E*p.y-3*B*f.y*p.x*V+R*T*u.y*p.x).getRootsInInterval(0,1),W=0;W<j.length;W++){var K=j[W],J=new Polynomial(p.x,u.x,c.x,d.x-f.x-K*m.x-K*K*v.x-K*K*K*g.x).getRoots(),tt=new Polynomial(p.y,u.y,c.y,d.y-f.y-K*m.y-K*K*v.y-K*K*K*g.y).getRoots();if(J.length>0&&tt.length>0){t:for(var et=0;et<J.length;et++){var nt=J[et];if(0<=nt&&nt<=1)for(var it=0;it<tt.length;it++)if(Math.abs(nt-tt[it])<1e-4){P.points.push(g.multiply(K*K*K).add(v.multiply(K*K).add(m.multiply(K).add(f))));break t}}}}return P.points.length>0&&(P.status="Intersection"),P},Intersection.intersectBezier3Circle=function(t,e,n,i,o,s){return Intersection.intersectBezier3Ellipse(t,e,n,i,o,s,s)},Intersection.intersectBezier3Ellipse=function(t,e,n,i,o,s,r){var y,a,l,x,h,p,u,c,d=new Intersection("No Intersection");y=t.multiply(-1),a=e.multiply(3),l=n.multiply(-3),h=new Vector2D((x=y.add(a.add(l.add(i)))).x,x.y),y=t.multiply(3),a=e.multiply(-6),l=n.multiply(3),p=new Vector2D((x=y.add(a.add(l))).x,x.y),y=t.multiply(-3),a=e.multiply(3),u=new Vector2D((l=y.add(a)).x,l.y),c=new Vector2D(t.x,t.y);for(var g=s*s,v=r*r,m=new Polynomial(h.x*h.x*v+h.y*h.y*g,2*(h.x*p.x*v+h.y*p.y*g),2*(h.x*u.x*v+h.y*u.y*g)+p.x*p.x*v+p.y*p.y*g,2*h.x*v*(c.x-o.x)+2*h.y*g*(c.y-o.y)+2*(p.x*u.x*v+p.y*u.y*g),2*p.x*v*(c.x-o.x)+2*p.y*g*(c.y-o.y)+u.x*u.x*v+u.y*u.y*g,2*u.x*v*(c.x-o.x)+2*u.y*g*(c.y-o.y),c.x*c.x*v-2*c.y*o.y*g-2*c.x*o.x*v+c.y*c.y*g+o.x*o.x*v+o.y*o.y*g-g*v).getRootsInInterval(0,1),f=0;f<m.length;f++){var P=m[f];d.points.push(h.multiply(P*P*P).add(p.multiply(P*P).add(u.multiply(P).add(c))))}return d.points.length>0&&(d.status="Intersection"),d},Intersection.intersectBezier3Line=function(t,e,n,i,o,s){var r,y,a,l,x,h,p,u,c,d,g=o.min(s),v=o.max(s),m=new Intersection("No Intersection");r=t.multiply(-1),y=e.multiply(3),a=n.multiply(-3),x=new Vector2D((l=r.add(y.add(a.add(i)))).x,l.y),r=t.multiply(3),y=e.multiply(-6),a=n.multiply(3),h=new Vector2D((l=r.add(y.add(a))).x,l.y),r=t.multiply(-3),y=e.multiply(3),p=new Vector2D((a=r.add(y)).x,a.y),u=new Vector2D(t.x,t.y),d=new Vector2D(o.y-s.y,s.x-o.x),c=o.x*s.y-s.x*o.y,roots=new Polynomial(d.dot(x),d.dot(h),d.dot(p),d.dot(u)+c).getRoots();for(var f=0;f<roots.length;f++){var P=roots[f];if(0<=P&&P<=1){var w=t.lerp(e,P),b=e.lerp(n,P),A=n.lerp(i,P),N=w.lerp(b,P),S=b.lerp(A,P),I=N.lerp(S,P);o.x==s.x?g.y<=I.y&&I.y<=v.y&&(m.status="Intersection",m.appendPoint(I)):o.y==s.y?g.x<=I.x&&I.x<=v.x&&(m.status="Intersection",m.appendPoint(I)):I.gte(g)&&I.lte(v)&&(m.status="Intersection",m.appendPoint(I))}}return m},Intersection.intersectBezier3Polygon=function(t,e,n,i,o){for(var s=new Intersection("No Intersection"),r=o.length,y=0;y<r;y++){var a=o[y],l=o[(y+1)%r],x=Intersection.intersectBezier3Line(t,e,n,i,a,l);s.appendPoints(x.points)}return s.points.length>0&&(s.status="Intersection"),s},Intersection.intersectBezier3Rectangle=function(t,e,n,i,o,s){var r=o.min(s),y=o.max(s),a=new Point2D(y.x,r.y),l=new Point2D(r.x,y.y),x=Intersection.intersectBezier3Line(t,e,n,i,r,a),h=Intersection.intersectBezier3Line(t,e,n,i,a,y),p=Intersection.intersectBezier3Line(t,e,n,i,y,l),u=Intersection.intersectBezier3Line(t,e,n,i,l,r),c=new Intersection("No Intersection");return c.appendPoints(x.points),c.appendPoints(h.points),c.appendPoints(p.points),c.appendPoints(u.points),c.points.length>0&&(c.status="Intersection"),c},Intersection.intersectCircleCircle=function(t,e,n,i){var o,s=e+i,r=Math.abs(e-i),y=t.distanceFrom(n);if(y>s)o=new Intersection("Outside");else if(y<r)o=new Intersection("Inside");else{o=new Intersection("Intersection");var a=(e*e-i*i+y*y)/(2*y),l=Math.sqrt(e*e-a*a),x=t.lerp(n,a/y),h=l/y;o.points.push(new Point2D(x.x-h*(n.y-t.y),x.y+h*(n.x-t.x))),o.points.push(new Point2D(x.x+h*(n.y-t.y),x.y-h*(n.x-t.x)))}return o},Intersection.intersectCircleEllipse=function(t,e,n,i,o){return Intersection.intersectEllipseEllipse(t,e,e,n,i,o)},Intersection.intersectCircleLine=function(t,e,n,i){var o,s=(i.x-n.x)*(i.x-n.x)+(i.y-n.y)*(i.y-n.y),r=2*((i.x-n.x)*(n.x-t.x)+(i.y-n.y)*(n.y-t.y)),y=r*r-4*s*(t.x*t.x+t.y*t.y+n.x*n.x+n.y*n.y-2*(t.x*n.x+t.y*n.y)-e*e);if(y<0)o=new Intersection("Outside");else if(0==y)o=new Intersection("Tangent");else{var a=Math.sqrt(y),l=(-r+a)/(2*s),x=(-r-a)/(2*s);(l<0||l>1)&&(x<0||x>1)?o=new Intersection(l<0&&x<0||l>1&&x>1?"Outside":"Inside"):(o=new Intersection("Intersection"),0<=l&&l<=1&&o.points.push(n.lerp(i,l)),0<=x&&x<=1&&o.points.push(n.lerp(i,x)))}return o},Intersection.intersectCirclePolygon=function(t,e,n){for(var i,o=new Intersection("No Intersection"),s=n.length,r=0;r<s;r++){var y=n[r],a=n[(r+1)%s];i=Intersection.intersectCircleLine(t,e,y,a),o.appendPoints(i.points)}return o.points.length>0?o.status="Intersection":o.status=i.status,o},Intersection.intersectCircleRectangle=function(t,e,n,i){var o=n.min(i),s=n.max(i),r=new Point2D(s.x,o.y),y=new Point2D(o.x,s.y),a=Intersection.intersectCircleLine(t,e,o,r),l=Intersection.intersectCircleLine(t,e,r,s),x=Intersection.intersectCircleLine(t,e,s,y),h=Intersection.intersectCircleLine(t,e,y,o),p=new Intersection("No Intersection");return p.appendPoints(a.points),p.appendPoints(l.points),p.appendPoints(x.points),p.appendPoints(h.points),p.points.length>0?p.status="Intersection":p.status=a.status,p},Intersection.intersectEllipseEllipse=function(t,e,n,i,o,s){for(var r=[n*n,0,e*e,-2*n*n*t.x,-2*e*e*t.y,n*n*t.x*t.x+e*e*t.y*t.y-e*e*n*n],y=[s*s,0,o*o,-2*s*s*i.x,-2*o*o*i.y,s*s*i.x*i.x+o*o*i.y*i.y-o*o*s*s],a=Intersection.bezout(r,y).getRoots(),l=.001*(r[0]*r[0]+2*r[1]*r[1]+r[2]*r[2]),x=.001*(y[0]*y[0]+2*y[1]*y[1]+y[2]*y[2]),h=new Intersection("No Intersection"),p=0;p<a.length;p++)for(var u=new Polynomial(r[0],r[3]+a[p]*r[1],r[5]+a[p]*(r[4]+a[p]*r[2])).getRoots(),c=0;c<u.length;c++){var d=(r[0]*u[c]+r[1]*a[p]+r[3])*u[c]+(r[2]*a[p]+r[4])*a[p]+r[5];Math.abs(d)<l&&(d=(y[0]*u[c]+y[1]*a[p]+y[3])*u[c]+(y[2]*a[p]+y[4])*a[p]+y[5],Math.abs(d)<x&&h.appendPoint(new Point2D(u[c],a[p])))}return h.points.length>0&&(h.status="Intersection"),h},Intersection.intersectEllipseLine=function(t,e,n,i,o){var s,r=new Vector2D(i.x,i.y),y=Vector2D.fromPoints(i,o),a=new Vector2D(t.x,t.y),l=r.subtract(a),x=new Vector2D(y.x/(e*e),y.y/(n*n)),h=new Vector2D(l.x/(e*e),l.y/(n*n)),p=y.dot(x),u=y.dot(h),c=u*u-p*(t=l.dot(h)-1);if(c<0)s=new Intersection("Outside");else if(c>0){var d=Math.sqrt(c),g=(-u-d)/p,v=(-u+d)/p;(g<0||1<g)&&(v<0||1<v)?s=new Intersection(g<0&&v<0||g>1&&v>1?"Outside":"Inside"):(s=new Intersection("Intersection"),0<=g&&g<=1&&s.appendPoint(i.lerp(o,g)),0<=v&&v<=1&&s.appendPoint(i.lerp(o,v)))}else{var m=-u/p;0<=m&&m<=1?(s=new Intersection("Intersection")).appendPoint(i.lerp(o,m)):s=new Intersection("Outside")}return s},Intersection.intersectEllipsePolygon=function(t,e,n,i){for(var o=new Intersection("No Intersection"),s=i.length,r=0;r<s;r++){var y=i[r],a=i[(r+1)%s],l=Intersection.intersectEllipseLine(t,e,n,y,a);o.appendPoints(l.points)}return o.points.length>0&&(o.status="Intersection"),o},Intersection.intersectEllipseRectangle=function(t,e,n,i,o){var s=i.min(o),r=i.max(o),y=new Point2D(r.x,s.y),a=new Point2D(s.x,r.y),l=Intersection.intersectEllipseLine(t,e,n,s,y),x=Intersection.intersectEllipseLine(t,e,n,y,r),h=Intersection.intersectEllipseLine(t,e,n,r,a),p=Intersection.intersectEllipseLine(t,e,n,a,s),u=new Intersection("No Intersection");return u.appendPoints(l.points),u.appendPoints(x.points),u.appendPoints(h.points),u.appendPoints(p.points),u.points.length>0&&(u.status="Intersection"),u},Intersection.intersectLineLine=function(t,e,n,i){var o,s=(i.x-n.x)*(t.y-n.y)-(i.y-n.y)*(t.x-n.x),r=(e.x-t.x)*(t.y-n.y)-(e.y-t.y)*(t.x-n.x),y=(i.y-n.y)*(e.x-t.x)-(i.x-n.x)*(e.y-t.y);if(0!=y){var a=s/y,l=r/y;0<=a&&a<=1&&0<=l&&l<=1?(o=new Intersection("Intersection")).points.push(new Point2D(t.x+a*(e.x-t.x),t.y+a*(e.y-t.y))):o=new Intersection("No Intersection")}else o=new Intersection(0==s||0==r?"Coincident":"Parallel");return o},Intersection.intersectLinePolygon=function(t,e,n){for(var i=new Intersection("No Intersection"),o=n.length,s=0;s<o;s++){var r=n[s],y=n[(s+1)%o],a=Intersection.intersectLineLine(t,e,r,y);i.appendPoints(a.points)}return i.points.length>0&&(i.status="Intersection"),i},Intersection.intersectLineRectangle=function(t,e,n,i){var o=n.min(i),s=n.max(i),r=new Point2D(s.x,o.y),y=new Point2D(o.x,s.y),a=Intersection.intersectLineLine(o,r,t,e),l=Intersection.intersectLineLine(r,s,t,e),x=Intersection.intersectLineLine(s,y,t,e),h=Intersection.intersectLineLine(y,o,t,e),p=new Intersection("No Intersection");return p.appendPoints(a.points),p.appendPoints(l.points),p.appendPoints(x.points),p.appendPoints(h.points),p.points.length>0&&(p.status="Intersection"),p},Intersection.intersectPolygonPolygon=function(t,e){for(var n=new Intersection("No Intersection"),i=t.length,o=0;o<i;o++){var s=t[o],r=t[(o+1)%i],y=Intersection.intersectLinePolygon(s,r,e);n.appendPoints(y.points)}return n.points.length>0&&(n.status="Intersection"),n},Intersection.intersectPolygonRectangle=function(t,e,n){var i=e.min(n),o=e.max(n),s=new Point2D(o.x,i.y),r=new Point2D(i.x,o.y),y=Intersection.intersectLinePolygon(i,s,t),a=Intersection.intersectLinePolygon(s,o,t),l=Intersection.intersectLinePolygon(o,r,t),x=Intersection.intersectLinePolygon(r,i,t),h=new Intersection("No Intersection");return h.appendPoints(y.points),h.appendPoints(a.points),h.appendPoints(l.points),h.appendPoints(x.points),h.points.length>0&&(h.status="Intersection"),h},Intersection.intersectRayRay=function(t,e,n,i){var o,s=(i.x-n.x)*(t.y-n.y)-(i.y-n.y)*(t.x-n.x),r=(e.x-t.x)*(t.y-n.y)-(e.y-t.y)*(t.x-n.x),y=(i.y-n.y)*(e.x-t.x)-(i.x-n.x)*(e.y-t.y);if(0!=y){var a=s/y;(o=new Intersection("Intersection")).points.push(new Point2D(t.x+a*(e.x-t.x),t.y+a*(e.y-t.y)))}else o=new Intersection(0==s||0==r?"Coincident":"Parallel");return o},Intersection.intersectRectangleRectangle=function(t,e,n,i){var o=t.min(e),s=t.max(e),r=new Point2D(s.x,o.y),y=new Point2D(o.x,s.y),a=Intersection.intersectLineRectangle(o,r,n,i),l=Intersection.intersectLineRectangle(r,s,n,i),x=Intersection.intersectLineRectangle(s,y,n,i),h=Intersection.intersectLineRectangle(y,o,n,i),p=new Intersection("No Intersection");return p.appendPoints(a.points),p.appendPoints(l.points),p.appendPoints(x.points),p.appendPoints(h.points),p.points.length>0&&(p.status="Intersection"),p},Intersection.bezout=function(t,e){var n=t[0]*e[1]-e[0]*t[1],i=t[0]*e[2]-e[0]*t[2],o=t[0]*e[3]-e[0]*t[3],s=t[0]*e[4]-e[0]*t[4],r=t[0]*e[5]-e[0]*t[5],y=t[1]*e[2]-e[1]*t[2],a=t[1]*e[4]-e[1]*t[4],l=t[1]*e[5]-e[1]*t[5],x=t[2]*e[3]-e[2]*t[3],h=t[3]*e[4]-e[3]*t[4],p=t[3]*e[5]-e[3]*t[5],u=l+h,c=a-x;return new Polynomial(n*y-i*i,n*c+o*y-2*i*s,n*u+o*c-s*s-2*i*r,n*p+o*u-2*s*r,o*p-r*r)},IntersectionParams.prototype.init=function(t,e){this.name=t,this.params=e},Point2D.prototype.clone=function(){return new Point2D(this.x,this.y)},Point2D.prototype.add=function(t){return new Point2D(this.x+t.x,this.y+t.y)},Point2D.prototype.addEquals=function(t){return this.x+=t.x,this.y+=t.y,this},Point2D.prototype.offset=function(t,e){var n,i,o=0;e.x<=this.x||this.x+t.x<=0||(e.x*t.y-t.x*e.y>0?i=this.x<0?(n=this.x*t.y)/t.x-this.y:this.x>0?(n=this.x*e.y)/e.x-this.y:-this.y:e.x<this.x+t.x?(n=(e.x-this.x)*t.y,i=e.y-(this.y+n/t.x)):i=e.x>this.x+t.x?(n=(t.x+this.x)*e.y)/e.x-(this.y+t.y):e.y-(this.y+t.y),i>0&&(o=i));return o},Point2D.prototype.rmoveto=function(t,e){this.x+=t,this.y+=e},Point2D.prototype.scalarAdd=function(t){return new Point2D(this.x+t,this.y+t)},Point2D.prototype.scalarAddEquals=function(t){return this.x+=t,this.y+=t,this},Point2D.prototype.subtract=function(t){return new Point2D(this.x-t.x,this.y-t.y)},Point2D.prototype.subtractEquals=function(t){return this.x-=t.x,this.y-=t.y,this},Point2D.prototype.scalarSubtract=function(t){return new Point2D(this.x-t,this.y-t)},Point2D.prototype.scalarSubtractEquals=function(t){return this.x-=t,this.y-=t,this},Point2D.prototype.multiply=function(t){return new Point2D(this.x*t,this.y*t)},Point2D.prototype.multiplyEquals=function(t){return this.x*=t,this.y*=t,this},Point2D.prototype.divide=function(t){return new Point2D(this.x/t,this.y/t)},Point2D.prototype.divideEquals=function(t){return this.x/=t,this.y/=t,this},Point2D.prototype.compare=function(t){return this.x-t.x||this.y-t.y},Point2D.prototype.eq=function(t){return this.x==t.x&&this.y==t.y},Point2D.prototype.lt=function(t){return this.x<t.x&&this.y<t.y},Point2D.prototype.lte=function(t){return this.x<=t.x&&this.y<=t.y},Point2D.prototype.gt=function(t){return this.x>t.x&&this.y>t.y},Point2D.prototype.gte=function(t){return this.x>=t.x&&this.y>=t.y},Point2D.prototype.lerp=function(t,e){return new Point2D(this.x+(t.x-this.x)*e,this.y+(t.y-this.y)*e)},Point2D.prototype.distanceFrom=function(t){var e=this.x-t.x,n=this.y-t.y;return Math.sqrt(e*e+n*n)},Point2D.prototype.min=function(t){return new Point2D(Math.min(this.x,t.x),Math.min(this.y,t.y))},Point2D.prototype.max=function(t){return new Point2D(Math.max(this.x,t.x),Math.max(this.y,t.y))},Point2D.prototype.toString=function(){return this.x+","+this.y},Point2D.prototype.setXY=function(t,e){this.x=t,this.y=e},Point2D.prototype.setFromPoint=function(t){this.x=t.x,this.y=t.y},Point2D.prototype.swap=function(t){var e=this.x,n=this.y;this.x=t.x,this.y=t.y,t.x=e,t.y=n},Polynomial.TOLERANCE=1e-6,Polynomial.ACCURACY=6,Polynomial.interpolate=function(t,e,n,i,o){if(t.constructor!==Array||e.constructor!==Array)throw new Error("Polynomial.interpolate: xs and ys must be arrays");if(isNaN(n)||isNaN(i)||isNaN(o))throw new Error("Polynomial.interpolate: n, offset, and x must be numbers");for(var s=0,r=0,y=new Array(n),a=new Array(n),l=0,x=Math.abs(o-t[i]),h=0;h<n;h++){var p=Math.abs(o-t[i+h]);p<x&&(l=h,x=p),y[h]=a[h]=e[i+h]}s=e[i+l],l--;for(var u=1;u<n;u++){for(h=0;h<n-u;h++){var c=t[i+h]-o,d=t[i+h+u]-o,g=y[h+1]-a[h],v=c-d;if(0==v){({y:0,dy:0});break}v=g/v,a[h]=d*v,y[h]=c*v}s+=r=2*(l+1)<n-u?y[l+1]:a[l--]}return{y:s,dy:r}},Polynomial.prototype.init=function(t){this.coefs=new Array;for(var e=t.length-1;e>=0;e--)this.coefs.push(t[e]);this._variable="t",this._s=0},Polynomial.prototype.eval=function(t){if(isNaN(t))throw new Error("Polynomial.eval: parameter must be a number");for(var e=0,n=this.coefs.length-1;n>=0;n--)e=e*t+this.coefs[n];return e},Polynomial.prototype.add=function(t){for(var e=new Polynomial,n=this.getDegree(),i=t.getDegree(),o=Math.max(n,i),s=0;s<=o;s++){var r=s<=n?this.coefs[s]:0,y=s<=i?t.coefs[s]:0;e.coefs[s]=r+y}return e},Polynomial.prototype.multiply=function(t){for(var e=new Polynomial,n=0;n<=this.getDegree()+t.getDegree();n++)e.coefs.push(0);for(n=0;n<=this.getDegree();n++)for(var i=0;i<=t.getDegree();i++)e.coefs[n+i]+=this.coefs[n]*t.coefs[i];return e},Polynomial.prototype.divide_scalar=function(t){for(var e=0;e<this.coefs.length;e++)this.coefs[e]/=t},Polynomial.prototype.simplify=function(){for(var t=this.getDegree();t>=0&&Math.abs(this.coefs[t])<=Polynomial.TOLERANCE;t--)this.coefs.pop()},Polynomial.prototype.bisection=function(t,e){var n,i=this.eval(t),o=this.eval(e);if(Math.abs(i)<=Polynomial.TOLERANCE)n=t;else if(Math.abs(o)<=Polynomial.TOLERANCE)n=e;else if(i*o<=0)for(var s=Math.log(e-t),r=Math.LN10*Polynomial.ACCURACY,y=Math.ceil((s+r)/Math.LN2),a=0;a<y;a++){n=.5*(t+e);var l=this.eval(n);if(Math.abs(l)<=Polynomial.TOLERANCE)break;l*i<0?(e=n,o=l):(t=n,i=l)}return n},Polynomial.prototype.toString=function(){for(var t=new Array,e=new Array,n=this.coefs.length-1;n>=0;n--){var i=Math.round(1e3*this.coefs[n])/1e3;if(0!=i){var o=i<0?" - ":" + ";i=Math.abs(i),n>0&&(1==i?i=this._variable:i+=this._variable),n>1&&(i+="^"+n),e.push(o),t.push(i)}}e[0]=" + "==e[0]?"":"-";var s="";for(n=0;n<t.length;n++)s+=e[n]+t[n];return s},Polynomial.prototype.trapezoid=function(t,e,n){if(isNaN(t)||isNaN(e)||isNaN(n))throw new Error("Polynomial.trapezoid: parameters must be numbers");var i=e-t;if(1==n){var o=this.eval(t),s=this.eval(e);this._s=.5*i*(o+s)}else{for(var r=1<<n-2,y=i/r,a=t+.5*y,l=0,x=0;x<r;x++)l+=this.eval(a),a+=y;this._s=.5*(this._s+i*l/r)}if(isNaN(this._s))throw new Error("Polynomial.trapezoid: this._s is NaN");return this._s},Polynomial.prototype.simpson=function(t,e){if(isNaN(t)||isNaN(e))throw new Error("Polynomial.simpson: parameters must be numbers");for(var n=e-t,i=.5*n*(this.eval(t)+this.eval(e)),o=i,s=4*i/3,r=s,y=i,a=1,l=2;l<=20;l++){for(var x=n/a,h=t+.5*x,p=0,u=1;u<=a;u++)p+=this.eval(h),h+=x;if(s=(4*(i=o=.5*(o+n*p/a))-y)/3,Math.abs(s-r)<1e-7*Math.abs(r))break;r=s,y=i,a<<=1}return s},Polynomial.prototype.romberg=function(t,e){if(isNaN(t)||isNaN(e))throw new Error("Polynomial.romberg: parameters must be numbers");var n=new Array(21),i=new Array(21),o={y:0,dy:0};i[0]=1;for(var s=1;s<=20&&(n[s-1]=this.trapezoid(t,e,s),!(s>=3&&(o=Polynomial.interpolate(i,n,3,s-3,0),Math.abs(o.dy)<=1e-6*o.y)));s++)n[s]=n[s-1],i[s]=.25*i[s-1];return o.y},Polynomial.prototype.getDegree=function(){return this.coefs.length-1},Polynomial.prototype.getDerivative=function(){for(var t=new Polynomial,e=1;e<this.coefs.length;e++)t.coefs.push(e*this.coefs[e]);return t},Polynomial.prototype.getRoots=function(){var t;switch(this.simplify(),this.getDegree()){case 0:t=new Array;break;case 1:t=this.getLinearRoot();break;case 2:t=this.getQuadraticRoots();break;case 3:t=this.getCubicRoots();break;case 4:t=this.getQuarticRoots();break;default:t=new Array}return t},Polynomial.prototype.getRootsInInterval=function(t,e){var n,o=new Array;if(1==this.getDegree())null!=(n=this.bisection(t,e))&&o.push(n);else{var s=this.getDerivative().getRootsInInterval(t,e);if(s.length>0){for(null!=(n=this.bisection(t,s[0]))&&o.push(n),i=0;i<=s.length-2;i++)null!=(n=this.bisection(s[i],s[i+1]))&&o.push(n);null!=(n=this.bisection(s[s.length-1],e))&&o.push(n)}else null!=(n=this.bisection(t,e))&&o.push(n)}return o},Polynomial.prototype.getLinearRoot=function(){var t=new Array,e=this.coefs[1];return 0!=e&&t.push(-this.coefs[0]/e),t},Polynomial.prototype.getQuadraticRoots=function(){var t=new Array;if(2==this.getDegree()){var e=this.coefs[2],n=this.coefs[1]/e,i=n*n-4*(this.coefs[0]/e);if(i>0){var o=Math.sqrt(i);t.push(.5*(-n+o)),t.push(.5*(-n-o))}else 0==i&&t.push(.5*-n)}return t},Polynomial.prototype.getCubicRoots=function(){var t=new Array;if(3==this.getDegree()){var e=this.coefs[3],n=this.coefs[2]/e,i=this.coefs[1]/e,o=(3*i-n*n)/3,s=(2*n*n*n-9*i*n+27*(this.coefs[0]/e))/27,r=n/3,y=s*s/4+o*o*o/27,a=s/2;if(Math.abs(y)<=Polynomial.TOLERANCE&&(disrim=0),y>0){var l,x=Math.sqrt(y);l=(g=-a+x)>=0?Math.pow(g,1/3):-Math.pow(-g,1/3),(g=-a-x)>=0?l+=Math.pow(g,1/3):l-=Math.pow(-g,1/3),t.push(l-r)}else if(y<0){var h=Math.sqrt(-o/3),p=Math.atan2(Math.sqrt(-y),-a)/3,u=Math.cos(p),c=Math.sin(p),d=Math.sqrt(3);t.push(2*h*u-r),t.push(-h*(u+d*c)-r),t.push(-h*(u-d*c)-r)}else{var g;g=a>=0?-Math.pow(a,1/3):Math.pow(-a,1/3),t.push(2*g-r),t.push(-g-r)}}return t},Polynomial.prototype.getQuarticRoots=function(){var t=new Array;if(4==this.getDegree()){var e=this.coefs[4],n=this.coefs[3]/e,i=this.coefs[2]/e,o=this.coefs[1]/e,s=this.coefs[0]/e,r=new Polynomial(1,-i,n*o-4*s,-n*n*s+4*i*s-o*o).getCubicRoots()[0],y=n*n/4-i+r;if(Math.abs(y)<=Polynomial.TOLERANCE&&(y=0),y>0){var a=Math.sqrt(y),l=3*n*n/4-a*a-2*i,x=l+(u=(4*n*i-8*o-n*n*n)/(4*a)),h=l-u;if(Math.abs(x)<=Polynomial.TOLERANCE&&(x=0),Math.abs(h)<=Polynomial.TOLERANCE&&(h=0),x>=0){var p=Math.sqrt(x);t.push(-n/4+(a+p)/2),t.push(-n/4+(a-p)/2)}if(h>=0){p=Math.sqrt(h);t.push(-n/4+(p-a)/2),t.push(-n/4-(p+a)/2)}}else if(y<0);else{var u;if((u=r*r-4*s)>=-Polynomial.TOLERANCE){if(u<0&&(u=0),(l=3*n*n/4-2*i)+(u=2*Math.sqrt(u))>=Polynomial.TOLERANCE){var c=Math.sqrt(l+u);t.push(-n/4+c/2),t.push(-n/4-c/2)}if(l-u>=Polynomial.TOLERANCE){c=Math.sqrt(l-u);t.push(-n/4+c/2),t.push(-n/4-c/2)}}}}return t},Vector2D.prototype.length=function(){return Math.sqrt(this.x*this.x+this.y*this.y)},Vector2D.prototype.dot=function(t){return this.x*t.x+this.y*t.y},Vector2D.prototype.cross=function(t){return this.x*t.y-this.y*t.x},Vector2D.prototype.unit=function(){return this.divide(this.length())},Vector2D.prototype.unitEquals=function(){return this.divideEquals(this.length()),this},Vector2D.prototype.add=function(t){return new Vector2D(this.x+t.x,this.y+t.y)},Vector2D.prototype.addEquals=function(t){return this.x+=t.x,this.y+=t.y,this},Vector2D.prototype.subtract=function(t){return new Vector2D(this.x-t.x,this.y-t.y)},Vector2D.prototype.subtractEquals=function(t){return this.x-=t.x,this.y-=t.y,this},Vector2D.prototype.multiply=function(t){return new Vector2D(this.x*t,this.y*t)},Vector2D.prototype.multiplyEquals=function(t){return this.x*=t,this.y*=t,this},Vector2D.prototype.divide=function(t){return new Vector2D(this.x/t,this.y/t)},Vector2D.prototype.divideEquals=function(t){return this.x/=t,this.y/=t,this},Vector2D.prototype.perp=function(){return new Vector2D(-this.y,this.x)},Vector2D.prototype.perpendicular=function(t){return this.subtract(this.project(t))},Vector2D.prototype.project=function(t){var e=this.dot(t)/t.dot(t);return t.multiply(e)},Vector2D.prototype.toString=function(){return this.x+","+this.y},Vector2D.fromPoints=function(t,e){return new Vector2D(e.x-t.x,e.y-t.y)},Shape.prototype=new EventHandler,Shape.prototype.constructor=Shape,Shape.superclass=EventHandler.prototype,Shape.prototype.init=function(t){this.svgNode=t,this.locked=!1,this.visible=!0,this.selected=!1,this.callback=null,this.lastUpdate=null},Shape.prototype.show=function(t){var e=t?"inline":"none";this.visible=t,this.svgNode.setAttributeNS(null,"display",e)},Shape.prototype.refresh=function(){},Shape.prototype.update=function(){this.refresh(),this.owner&&this.owner.update(this),null!=this.callback&&this.callback(this)},Shape.prototype.translate=function(t){},Shape.prototype.select=function(t){this.selected=t},Shape.prototype.registerHandles=function(){},Shape.prototype.unregisterHandles=function(){},Shape.prototype.selectHandles=function(t){},Shape.prototype.showHandles=function(t){},Shape.prototype.mousedown=function(t){this.locked||(t.shiftKey?this.selected?mouser.unregisterShape(this):(mouser.registerShape(this),this.showHandles(!0),this.selectHandles(!0),this.registerHandles()):this.selected?(this.selectHandles(!0),this.registerHandles()):(mouser.unregisterShapes(),mouser.registerShape(this),this.showHandles(!0),this.selectHandles(!1)))},Circle.prototype=new Shape,Circle.prototype.constructor=Circle,Circle.superclass=Shape.prototype,Circle.prototype.init=function(t){if("circle"!=t.localName)throw new Error("Circle.init: Invalid SVG Node: "+t.localName);Circle.superclass.init.call(this,t);var e=parseFloat(t.getAttributeNS(null,"cx")),n=parseFloat(t.getAttributeNS(null,"cy")),i=parseFloat(t.getAttributeNS(null,"r"));this.center=new Handle(e,n,this),this.last=new Point2D(e,n),this.radius=new Handle(e+i,n,this)},Circle.prototype.realize=function(){null!=this.svgNode&&(this.center.realize(),this.radius.realize(),this.center.show(!1),this.radius.show(!1),this.svgNode.addEventListener("mousedown",this,!1))},Circle.prototype.translate=function(t){this.center.translate(t),this.radius.translate(t),this.refresh()},Circle.prototype.refresh=function(){var t=this.radius.point.distanceFrom(this.center.point);this.svgNode.setAttributeNS(null,"cx",this.center.point.x),this.svgNode.setAttributeNS(null,"cy",this.center.point.y),this.svgNode.setAttributeNS(null,"r",t)},Circle.prototype.registerHandles=function(){mouser.register(this.center),mouser.register(this.radius)},Circle.prototype.unregisterHandles=function(){mouser.unregister(this.center),mouser.unregister(this.radius)},Circle.prototype.selectHandles=function(t){this.center.select(t),this.radius.select(t)},Circle.prototype.showHandles=function(t){this.center.show(t),this.radius.show(t)},Circle.prototype.getIntersectionParams=function(){return new IntersectionParams("Circle",[this.center.point,parseFloat(this.svgNode.getAttributeNS(null,"r"))])},Ellipse.prototype=new Shape,Ellipse.prototype.constructor=Ellipse,Ellipse.superclass=Shape.prototype,Ellipse.prototype.init=function(t){if(null==t||"ellipse"!=t.localName)throw new Error("Ellipse.init: Invalid localName: "+t.localName);Ellipse.superclass.init.call(this,t);var e=parseFloat(t.getAttributeNS(null,"cx")),n=parseFloat(t.getAttributeNS(null,"cy")),i=parseFloat(t.getAttributeNS(null,"rx")),o=parseFloat(t.getAttributeNS(null,"ry"));this.center=new Handle(e,n,this),this.radiusX=new Handle(e+i,n,this),this.radiusY=new Handle(e,n+o,this)},Ellipse.prototype.realize=function(){this.center.realize(),this.radiusX.realize(),this.radiusY.realize(),this.center.show(!1),this.radiusX.show(!1),this.radiusY.show(!1),this.svgNode.addEventListener("mousedown",this,!1)},Ellipse.prototype.refresh=function(){var t=Math.abs(this.center.point.x-this.radiusX.point.x),e=Math.abs(this.center.point.y-this.radiusY.point.y);this.svgNode.setAttributeNS(null,"cx",this.center.point.x),this.svgNode.setAttributeNS(null,"cy",this.center.point.y),this.svgNode.setAttributeNS(null,"rx",t),this.svgNode.setAttributeNS(null,"ry",e)},Ellipse.prototype.registerHandles=function(){mouser.register(this.center),mouser.register(this.radiusX),mouser.register(this.radiusY)},Ellipse.prototype.unregisterHandles=function(){mouser.unregister(this.center),mouser.unregister(this.radiusX),mouser.unregister(this.radiusY)},Ellipse.prototype.selectHandles=function(t){this.center.select(t),this.radiusX.select(t),this.radiusY.select(t)},Ellipse.prototype.showHandles=function(t){this.center.show(t),this.radiusX.show(t),this.radiusY.show(t)},Ellipse.prototype.getIntersectionParams=function(){return new IntersectionParams("Ellipse",[this.center.point,parseFloat(this.svgNode.getAttributeNS(null,"rx")),parseFloat(this.svgNode.getAttributeNS(null,"ry"))])},Handle.prototype=new Shape,Handle.prototype.constructor=Handle,Handle.superclass=Shape.prototype,Handle.NO_CONSTRAINTS=0,Handle.CONSTRAIN_X=1,Handle.CONSTRAIN_Y=2,Handle.prototype.init=function(t,e,n){Handle.superclass.init.call(this,null),this.point=new Point2D(t,e),this.owner=n,this.constrain=Handle.NO_CONSTRAINTS},Handle.prototype.realize=function(){if(null==this.svgNode){var t,e=svgDocument.createElementNS("http://www.w3.org/2000/svg","rect");t=null!=this.owner&&null!=this.owner.svgNode?this.owner.svgNode.parentNode:svgDocument.documentElement,e.setAttributeNS(null,"x",this.point.x-2),e.setAttributeNS(null,"y",this.point.y-2),e.setAttributeNS(null,"width",4),e.setAttributeNS(null,"height",4),e.setAttributeNS(null,"stroke","black"),e.setAttributeNS(null,"fill","white"),e.addEventListener("mousedown",this,!1),t.appendChild(e),this.svgNode=e,this.show(this.visible)}},Handle.prototype.unrealize=function(){this.svgNode.removeEventListener("mousedown",this,!1),this.svgNode.parentNode.removeChild(this.svgNode)},Handle.prototype.translate=function(t){this.constrain==Handle.CONSTRAIN_X?this.point.x+=t.x:this.constrain==Handle.CONSTRAIN_Y?this.point.y+=t.y:this.point.addEquals(t),this.refresh()},Handle.prototype.refresh=function(){this.svgNode.setAttributeNS(null,"x",this.point.x-2),this.svgNode.setAttributeNS(null,"y",this.point.y-2)},Handle.prototype.select=function(t){Handle.superclass.select.call(this,t),t?this.svgNode.setAttributeNS(null,"fill","black"):this.svgNode.setAttributeNS(null,"fill","white")},Handle.prototype.mousedown=function(t){if(!this.locked)if(t.shiftKey)this.selected?mouser.unregister(this):(mouser.register(this),mouser.beginDrag(t));else{if(!this.selected){this.owner;mouser.unregisterAll(),mouser.register(this)}mouser.beginDrag(t)}},Lever.prototype=new Shape,Lever.prototype.constructor=Lever,Lever.superclass=Shape.prototype,Lever.prototype.init=function(t,e,n,i,o){Lever.superclass.init.call(this,null),this.point=new Handle(t,e,this),this.lever=new LeverHandle(n,i,this),this.owner=o},Lever.prototype.realize=function(){if(null==this.svgNode){var t,e=svgDocument.createElementNS("http://www.w3.org/2000/svg","line");t=null!=this.owner&&null!=this.owner.svgNode?this.owner.svgNode.parentNode:svgDocument.documentElement,e.setAttributeNS(null,"x1",this.point.point.x),e.setAttributeNS(null,"y1",this.point.point.y),e.setAttributeNS(null,"x2",this.lever.point.x),e.setAttributeNS(null,"y2",this.lever.point.y),e.setAttributeNS(null,"stroke","black"),t.appendChild(e),this.svgNode=e,this.point.realize(),this.lever.realize(),this.show(this.visible)}},Lever.prototype.refresh=function(){this.svgNode.setAttributeNS(null,"x1",this.point.point.x),this.svgNode.setAttributeNS(null,"y1",this.point.point.y),this.svgNode.setAttributeNS(null,"x2",this.lever.point.x),this.svgNode.setAttributeNS(null,"y2",this.lever.point.y)},LeverHandle.prototype=new Handle,LeverHandle.prototype.constructor=LeverHandle,LeverHandle.superclass=Handle.prototype,LeverHandle.prototype.realize=function(){if(null==this.svgNode){var t,e=svgDocument.createElementNS("http://www.w3.org/2000/svg","circle");t=null!=this.owner&&null!=this.owner.svgNode?this.owner.svgNode.parentNode:svgDocument.documentElement,e.setAttributeNS(null,"cx",this.point.x),e.setAttributeNS(null,"cy",this.point.y),e.setAttributeNS(null,"r",2.5),e.setAttributeNS(null,"fill","black"),e.addEventListener("mousedown",this,!1),t.appendChild(e),this.svgNode=e,this.show(this.visible)}},LeverHandle.prototype.refresh=function(){this.svgNode.setAttributeNS(null,"cx",this.point.x),this.svgNode.setAttributeNS(null,"cy",this.point.y)},LeverHandle.prototype.select=function(t){LeverHandle.superclass.select.call(this,t),this.svgNode.setAttributeNS(null,"fill","black")},Line.prototype=new Shape,Line.prototype.constructor=Line,Line.superclass=Shape.prototype,Line.prototype.init=function(t){if(null==t||"line"!=t.localName)throw new Error("Line.init: Invalid localName: "+t.localName);Line.superclass.init.call(this,t);var e=parseFloat(t.getAttributeNS(null,"x1")),n=parseFloat(t.getAttributeNS(null,"y1")),i=parseFloat(t.getAttributeNS(null,"x2")),o=parseFloat(t.getAttributeNS(null,"y2"));this.p1=new Handle(e,n,this),this.p2=new Handle(i,o,this)},Line.prototype.realize=function(){this.p1.realize(),this.p2.realize(),this.p1.show(!1),this.p2.show(!1),this.svgNode.addEventListener("mousedown",this,!1)},Line.prototype.refresh=function(){this.svgNode.setAttributeNS(null,"x1",this.p1.point.x),this.svgNode.setAttributeNS(null,"y1",this.p1.point.y),this.svgNode.setAttributeNS(null,"x2",this.p2.point.x),this.svgNode.setAttributeNS(null,"y2",this.p2.point.y)},Line.prototype.registerHandles=function(){mouser.register(this.p1),mouser.register(this.p2)},Line.prototype.unregisterHandles=function(){mouser.unregister(this.p1),mouser.unregister(this.p2)},Line.prototype.selectHandles=function(t){this.p1.select(t),this.p2.select(t)},Line.prototype.showHandles=function(t){this.p1.show(t),this.p2.show(t)},Line.prototype.cut=function(t){var e=this.p1.point.lerp(this.p2.point,t),n=this.svgNode.cloneNode(!0);this.p2.point.setFromPoint(e),this.p2.update(),null!=this.svgNode.nextSibling?this.svgNode.parentNode.insertBefore(n,this.svgNode.nextSibling):this.svgNode.parentNode.appendChild(n);var i=new Line(n);i.realize(),i.p1.point.setFromPoint(e),i.p1.update()},Line.prototype.getIntersectionParams=function(){return new IntersectionParams("Line",[this.p1.point,this.p2.point])},Token.prototype.init=function(t,e){this.type=t,this.text=e},Token.prototype.typeis=function(t){return this.type==t},Path.prototype=new Shape,Path.prototype.constructor=Path,Path.superclass=Shape.prototype,Path.COMMAND=0,Path.NUMBER=1,Path.EOD=2,Path.PARAMS={A:["rx","ry","x-axis-rotation","large-arc-flag","sweep-flag","x","y"],a:["rx","ry","x-axis-rotation","large-arc-flag","sweep-flag","x","y"],C:["x1","y1","x2","y2","x","y"],c:["x1","y1","x2","y2","x","y"],H:["x"],h:["x"],L:["x","y"],l:["x","y"],M:["x","y"],m:["x","y"],Q:["x1","y1","x","y"],q:["x1","y1","x","y"],S:["x2","y2","x","y"],s:["x2","y2","x","y"],T:["x","y"],t:["x","y"],V:["y"],v:["y"],Z:[],z:[]},Path.prototype.init=function(t){if(null==t||"path"!=t.localName)throw new Error("Path.init: Invalid localName: "+t.localName);Path.superclass.init.call(this,t),this.segments=null,this.parseData(t.getAttributeNS(null,"d"))},Path.prototype.realize=function(){for(var t=0;t<this.segments.length;t++)this.segments[t].realize();this.svgNode.addEventListener("mousedown",this,!1)},Path.prototype.unrealize=function(){for(var t=0;t<this.segments.length;t++)this.segments[t].unrealize();this.svgNode.removeEventListener("mousedown",this,!1)},Path.prototype.refresh=function(){for(var t=new Array,e=0;e<this.segments.length;e++)t.push(this.segments[e].toString());this.svgNode.setAttributeNS(null,"d",t.join(" "))},Path.prototype.registerHandles=function(){for(var t=0;t<this.segments.length;t++)this.segments[t].registerHandles()},Path.prototype.unregisterHandles=function(){for(var t=0;t<this.segments.length;t++)this.segments[t].unregisterHandles()},Path.prototype.selectHandles=function(t){for(var e=0;e<this.segments.length;e++)this.segments[e].selectHandles(t)},Path.prototype.showHandles=function(t){for(var e=0;e<this.segments.length;e++)this.segments[e].showHandles(t)},Path.prototype.appendPathSegment=function(t){t.previous=this.segments[this.segments.length-1],this.segments.push(t)},Path.prototype.parseData=function(t){var e=this.tokenize(t),n=0,i=e[n],o="BOD";for(this.segments=new Array;!i.typeis(Path.EOD);){var s,r=new Array;if("BOD"==o){if("M"!=i.text&&"m"!=i.text)throw new Error("Path data must begin with a moveto command");n++,s=Path.PARAMS[i.text].length,o=i.text}else i.typeis(Path.NUMBER)?s=Path.PARAMS[o].length:(n++,s=Path.PARAMS[i.text].length,o=i.text);if(!(n+s<e.length))throw new Error("Path data ended before all parameters were found");for(var y=n;y<n+s;y++){var a=e[y];if(!a.typeis(Path.NUMBER))throw new Error("Parameter type is not a number: "+o+","+a.text);r[r.length]=a.text}var l,x=this.segments.length,h=0==x?null:this.segments[x-1];switch(o){case"A":l=new AbsoluteArcPath(r,this,h);break;case"C":l=new AbsoluteCurveto3(r,this,h);break;case"c":l=new RelativeCurveto3(r,this,h);break;case"H":l=new AbsoluteHLineto(r,this,h);break;case"L":l=new AbsoluteLineto(r,this,h);break;case"l":l=new RelativeLineto(r,this,h);break;case"M":l=new AbsoluteMoveto(r,this,h);break;case"m":l=new RelativeMoveto(r,this,h);break;case"Q":l=new AbsoluteCurveto2(r,this,h);break;case"q":l=new RelativeCurveto2(r,this,h);break;case"S":l=new AbsoluteSmoothCurveto3(r,this,h);break;case"s":l=new RelativeSmoothCurveto3(r,this,h);break;case"T":l=new AbsoluteSmoothCurveto2(r,this,h);break;case"t":l=new RelativeSmoothCurveto2(r,this,h);break;case"Z":l=new RelativeClosePath(r,this,h);break;case"z":l=new RelativeClosePath(r,this,h);break;default:throw new Error("Unsupported segment type: "+o)}this.segments.push(l),i=e[n+=s],"M"==o&&(o="L"),"m"==o&&(o="l")}},Path.prototype.tokenize=function(t){for(var e=new Array;""!=t;)if(t.match(/^([ \t\r\n,]+)/))t=t.substr(RegExp.$1.length);else if(t.match(/^([aAcChHlLmMqQsStTvVzZ])/))e[e.length]=new Token(Path.COMMAND,RegExp.$1),t=t.substr(RegExp.$1.length);else{if(!t.match(/^(([-+]?[0-9]+(\.[0-9]*)?|[-+]?\.[0-9]+)([eE][-+]?[0-9]+)?)/))throw new Error("Unrecognized segment command: "+t);e[e.length]=new Token(Path.NUMBER,parseFloat(RegExp.$1)),t=t.substr(RegExp.$1.length)}return e[e.length]=new Token(Path.EOD,null),e},Path.prototype.intersectShape=function(t){for(var e=new Intersection("No Intersection"),n=0;n<this.segments.length;n++){var i=Intersection.intersectShapes(this.segments[n],t);e.appendPoints(i.points)}return e.points.length>0&&(e.status="Intersection"),e},Path.prototype.getIntersectionParams=function(){return new IntersectionParams("Path",[])},AbsolutePathSegment.prototype.init=function(t,e,n,i){this.command=t,this.owner=n,this.previous=i,this.handles=new Array;for(var o=0;o<e.length;){var s=new Handle(e[o],e[o+1],n);this.handles.push(s),o+=2}},AbsolutePathSegment.prototype.realize=function(){for(var t=0;t<this.handles.length;t++){var e=this.handles[t];e.realize(),e.show(!1)}},AbsolutePathSegment.prototype.unrealize=function(){for(var t=0;t<this.handles.length;t++)this.handles[t].unrealize()},AbsolutePathSegment.prototype.registerHandles=function(){for(var t=0;t<this.handles.length;t++)mouser.register(this.handles[t])},AbsolutePathSegment.prototype.unregisterHandles=function(){for(var t=0;t<this.handles.length;t++)mouser.unregister(this.handles[t])},AbsolutePathSegment.prototype.selectHandles=function(t){for(var e=0;e<this.handles.length;e++)this.handles[e].select(t)},AbsolutePathSegment.prototype.showHandles=function(t){for(var e=0;e<this.handles.length;e++)this.handles[e].show(t)},AbsolutePathSegment.prototype.toString=function(){var t=new Array,e="";null!=this.previous&&this.previous.constructor==this.constuctor||(e=this.command);for(var n=0;n<this.handles.length;n++)t.push(this.handles[n].point.toString());return e+t.join(" ")},AbsolutePathSegment.prototype.getLastPoint=function(){return this.handles[this.handles.length-1].point},AbsolutePathSegment.prototype.getIntersectionParams=function(){return null},AbsoluteArcPath.prototype=new AbsolutePathSegment,AbsoluteArcPath.prototype.constructor=AbsoluteArcPath,AbsoluteArcPath.superclass=AbsolutePathSegment.prototype,AbsoluteArcPath.prototype.init=function(t,e,n,i){var o=new Array,s=e.pop(),r=e.pop();o.push(r,s),AbsoluteArcPath.superclass.init.call(this,t,o,n,i),this.rx=parseFloat(e.shift()),this.ry=parseFloat(e.shift()),this.angle=parseFloat(e.shift()),this.arcFlag=parseFloat(e.shift()),this.sweepFlag=parseFloat(e.shift())},AbsoluteArcPath.prototype.toString=function(){new Array;var t="";return this.previous.constructor!=this.constuctor&&(t=this.command),t+[this.rx,this.ry,this.angle,this.arcFlag,this.sweepFlag,this.handles[0].point.toString()].join(",")},AbsoluteArcPath.prototype.getIntersectionParams=function(){return new IntersectionParams("Ellipse",[this.getCenter(),this.rx,this.ry])},AbsoluteArcPath.prototype.getCenter=function(){var t=this.previous.getLastPoint(),e=this.handles[0].point,n=this.rx,i=this.ry,o=this.angle*Math.PI/180,s=Math.cos(o),r=Math.sin(o),y=t.subtract(e).divide(2),a=y.x*s+y.y*r,l=y.x*-r+y.y*s,x=a*a,h=l*l,p=x/(n*n)+h/(i*i);p>1&&(n*=v=Math.sqrt(p),i*=v);var u=n*n,c=i*i,d=u*h,g=c*x,v=(u*c-d-g)/(d+g);Math.abs(v)<1e-6&&(v=0);var m=Math.sqrt(v);this.arcFlag==this.sweepFlag&&(m=-m);var f=t.add(e).divide(2),P=m*n*l/i,w=m*-i*a/n;return new Point2D(P*s-w*r+f.x,P*r+w*s+f.y)},AbsoluteCurveto2.prototype=new AbsolutePathSegment,AbsoluteCurveto2.prototype.constructor=AbsoluteCurveto2,AbsoluteCurveto2.superclass=AbsolutePathSegment.prototype,AbsoluteCurveto2.prototype.getControlPoint=function(){return this.handles[0].point},AbsoluteCurveto2.prototype.getIntersectionParams=function(){return new IntersectionParams("Bezier2",[this.previous.getLastPoint(),this.handles[0].point,this.handles[1].point])},AbsoluteCurveto3.prototype=new AbsolutePathSegment,AbsoluteCurveto3.prototype.constructor=AbsoluteCurveto3,AbsoluteCurveto3.superclass=AbsolutePathSegment.prototype,AbsoluteCurveto3.prototype.getLastControlPoint=function(){return this.handles[1].point},AbsoluteCurveto3.prototype.getIntersectionParams=function(){return new IntersectionParams("Bezier3",[this.previous.getLastPoint(),this.handles[0].point,this.handles[1].point,this.handles[2].point])},AbsoluteHLineto.prototype=new AbsolutePathSegment,AbsoluteHLineto.prototype.constructor=AbsoluteHLineto,AbsoluteHLineto.superclass=AbsolutePathSegment.prototype,AbsoluteHLineto.prototype.init=function(t,e,n,i){var o=i.getLastPoint(),s=new Array;s.push(e.pop(),o.y),AbsoluteHLineto.superclass.init.call(this,t,s,n,i)},AbsoluteHLineto.prototype.toString=function(){new Array;var t="";return this.previous.constructor!=this.constuctor&&(t=this.command),t+this.handles[0].point.x},AbsoluteLineto.prototype=new AbsolutePathSegment,AbsoluteLineto.prototype.constructor=AbsoluteLineto,AbsoluteLineto.superclass=AbsolutePathSegment.prototype,AbsoluteLineto.prototype.toString=function(){new Array;var t="";return this.previous.constructor!=this.constuctor&&this.previous.constructor!=AbsoluteMoveto&&(t=this.command),t+this.handles[0].point.toString()},AbsoluteLineto.prototype.getIntersectionParams=function(){return new IntersectionParams("Line",[this.previous.getLastPoint(),this.handles[0].point])},AbsoluteMoveto.prototype=new AbsolutePathSegment,AbsoluteMoveto.prototype.constructor=AbsoluteMoveto,AbsoluteMoveto.superclass=AbsolutePathSegment.prototype,AbsoluteMoveto.prototype.toString=function(){return"M"+this.handles[0].point.toString()},AbsoluteSmoothCurveto2.prototype=new AbsolutePathSegment,AbsoluteSmoothCurveto2.prototype.constructor=AbsoluteSmoothCurveto2,AbsoluteSmoothCurveto2.superclass=AbsolutePathSegment.prototype,AbsoluteSmoothCurveto2.prototype.getControlPoint=function(){var t,e=this.previous.getLastPoint();if(this.previous.command.match(/^[QqTt]$/)){var n=this.previous.getControlPoint().subtract(e);t=e.subtract(n)}else t=e;return t},AbsoluteSmoothCurveto2.prototype.getIntersectionParams=function(){return new IntersectionParams("Bezier2",[this.previous.getLastPoint(),this.getControlPoint(),this.handles[0].point])},AbsoluteSmoothCurveto3.prototype=new AbsolutePathSegment,AbsoluteSmoothCurveto3.prototype.constructor=AbsoluteSmoothCurveto3,AbsoluteSmoothCurveto3.superclass=AbsolutePathSegment.prototype,AbsoluteSmoothCurveto3.prototype.getFirstControlPoint=function(){var t,e=this.previous.getLastPoint();if(this.previous.command.match(/^[SsCc]$/)){var n=this.previous.getLastControlPoint().subtract(e);t=e.subtract(n)}else t=e;return t},AbsoluteSmoothCurveto3.prototype.getLastControlPoint=function(){return this.handles[0].point},AbsoluteSmoothCurveto3.prototype.getIntersectionParams=function(){return new IntersectionParams("Bezier3",[this.previous.getLastPoint(),this.getFirstControlPoint(),this.handles[0].point,this.handles[1].point])},RelativePathSegment.prototype=new AbsolutePathSegment,RelativePathSegment.prototype.constructor=RelativePathSegment,RelativePathSegment.superclass=AbsolutePathSegment.prototype,RelativePathSegment.prototype.init=function(t,e,n,i){var o;this.command=t,this.owner=n,this.previous=i,this.handles=new Array,o=this.previous?this.previous.getLastPoint():new Point2D(0,0);for(var s=0;s<e.length;){var r=new Handle(o.x+e[s],o.y+e[s+1],n);this.handles.push(r),s+=2}},RelativePathSegment.prototype.toString=function(){var t,e=new Array,n="";t=this.previous?this.previous.getLastPoint():new Point2D(0,0),null!=this.previous&&this.previous.constructor==this.constructor||(n=this.command);for(var i=0;i<this.handles.length;i++){var o=this.handles[i].point.subtract(t);e.push(o.toString())}return n+e.join(" ")},RelativeClosePath.prototype=new RelativePathSegment,RelativeClosePath.prototype.constructor=RelativeClosePath,RelativeClosePath.superclass=RelativePathSegment.prototype,RelativeClosePath.prototype.getLastPoint=function(){for(var t,e=this.previous;e;){if(e.command.match(/^[mMzZ]$/)){t=e.getLastPoint();break}e=e.previous}return t},RelativeClosePath.prototype.getIntersectionParams=function(){return new IntersectionParams("Line",[this.previous.getLastPoint(),this.getLastPoint()])},RelativeCurveto2.prototype=new RelativePathSegment,RelativeCurveto2.prototype.constructor=RelativeCurveto2,RelativeCurveto2.superclass=RelativePathSegment.prototype,RelativeCurveto2.prototype.getControlPoint=function(){return this.handles[0].point},RelativeCurveto2.prototype.getIntersectionParams=function(){return new IntersectionParams("Bezier2",[this.previous.getLastPoint(),this.handles[0].point,this.handles[1].point])},RelativeCurveto3.prototype=new RelativePathSegment,RelativeCurveto3.prototype.constructor=RelativeCurveto3,RelativeCurveto3.superclass=RelativePathSegment.prototype,RelativeCurveto3.prototype.getLastControlPoint=function(){return this.handles[1].point},RelativeCurveto3.prototype.getIntersectionParams=function(){return new IntersectionParams("Bezier3",[this.previous.getLastPoint(),this.handles[0].point,this.handles[1].point,this.handles[2].point])},RelativeLineto.prototype=new RelativePathSegment,RelativeLineto.prototype.constructor=RelativeLineto,RelativeLineto.superclass=RelativePathSegment.prototype,RelativeLineto.prototype.toString=function(){var t,e;new Array;return t=this.previous?this.previous.getLastPoint():new Point(0,0),e=this.handles[0].point.subtract(t),this.previous.constructor!=this.constuctor&&this.previous.constructor!=RelativeMoveto&&(cmd=this.command),cmd+e.toString()},RelativeLineto.prototype.getIntersectionParams=function(){return new IntersectionParams("Line",[this.previous.getLastPoint(),this.handles[0].point])},RelativeMoveto.prototype=new RelativePathSegment,RelativeMoveto.prototype.constructor=RelativeMoveto,RelativeMoveto.superclass=RelativePathSegment.prototype,RelativeMoveto.prototype.toString=function(){return"m"+this.handles[0].point.toString()},RelativeSmoothCurveto2.prototype=new RelativePathSegment,RelativeSmoothCurveto2.prototype.constructor=RelativeSmoothCurveto2,RelativeSmoothCurveto2.superclass=RelativePathSegment.prototype,RelativeSmoothCurveto2.prototype.getControlPoint=function(){var t,e=this.previous.getLastPoint();if(this.previous.command.match(/^[QqTt]$/)){var n=this.previous.getControlPoint().subtract(e);t=e.subtract(n)}else t=e;return t},RelativeSmoothCurveto2.prototype.getIntersectionParams=function(){return new IntersectionParams("Bezier2",[this.previous.getLastPoint(),this.getControlPoint(),this.handles[0].point])},RelativeSmoothCurveto3.prototype=new RelativePathSegment,RelativeSmoothCurveto3.prototype.constructor=RelativeSmoothCurveto3,RelativeSmoothCurveto3.superclass=RelativePathSegment.prototype,RelativeSmoothCurveto3.prototype.getFirstControlPoint=function(){var t,e=this.previous.getLastPoint();if(this.previous.command.match(/^[SsCc]$/)){var n=this.previous.getLastControlPoint().subtract(e);t=e.subtract(n)}else t=e;return t},RelativeSmoothCurveto3.prototype.getLastControlPoint=function(){return this.handles[0].point},RelativeSmoothCurveto3.prototype.getIntersectionParams=function(){return new IntersectionParams("Bezier3",[this.previous.getLastPoint(),this.getFirstControlPoint(),this.handles[0].point,this.handles[1].point])},Polygon.prototype=new Shape,Polygon.prototype.constructor=Polygon,Polygon.superclass=Shape.prototype,Polygon.prototype.init=function(t){if("polygon"!=t.localName)throw new Error("Polygon.init: Invalid SVG Node: "+t.localName);Polygon.superclass.init.call(this,t);var e=t.getAttributeNS(null,"points").split(/[\s,]+/);this.handles=new Array;for(var n=0;n<e.length;n+=2){var i=parseFloat(e[n]),o=parseFloat(e[n+1]);this.handles.push(new Handle(i,o,this))}},Polygon.prototype.realize=function(){if(null!=this.svgNode){for(var t=0;t<this.handles.length;t++)this.handles[t].realize(),this.handles[t].show(!1);this.svgNode.addEventListener("mousedown",this,!1)}},Polygon.prototype.refresh=function(){for(var t=new Array,e=0;e<this.handles.length;e++)t.push(this.handles[e].point.toString());this.svgNode.setAttributeNS(null,"points",t.join(" "))},Polygon.prototype.registerHandles=function(){for(var t=0;t<this.handles.length;t++)mouser.register(this.handles[t])},Polygon.prototype.unregisterHandles=function(){for(var t=0;t<this.handles.length;t++)mouser.unregister(this.handles[t])},Polygon.prototype.selectHandles=function(t){for(var e=0;e<this.handles.length;e++)this.handles[e].select(t)},Polygon.prototype.showHandles=function(t){for(var e=0;e<this.handles.length;e++)this.handles[e].show(t)},Polygon.prototype.pointInPolygon=function(t){for(var e,n=this.handles.length,i=0,o=this.handles[0].point,s=1;s<=n;s++){var r=this.handles[s%n].point;t.y>Math.min(o.y,r.y)&&t.y<=Math.max(o.y,r.y)&&t.x<=Math.max(o.x,r.x)&&o.y!=r.y&&(e=(t.y-o.y)*(r.x-o.x)/(r.y-o.y)+o.x,(o.x==r.x||t.x<=e)&&i++),o=r}return i%2==1},Polygon.prototype.getIntersectionParams=function(){for(var t=new Array,e=0;e<this.handles.length;e++)t.push(this.handles[e].point);return new IntersectionParams("Polygon",[t])},Polygon.prototype.getArea=function(){for(var t=0,e=this.handles.length,n=0;n<e;n++){var i=this.handles[n].point,o=this.handles[(n+1)%e].point;t+=i.x*o.y-o.x*i.y}return t/2},Polygon.prototype.getCentroid=function(){for(var t=this.handles.length,e=6*this.getArea(),n=0,i=0,o=0;o<t;o++){var s=this.handles[o].point,r=this.handles[(o+1)%t].point,y=s.x*r.y-r.x*s.y;n+=(s.x+r.x)*y,i+=(s.y+r.y)*y}return new Point2D(n/e,i/e)},Polygon.prototype.isClockwise=function(){return this.getArea()<0},Polygon.prototype.isCounterClockwise=function(){return this.getArea()>0},Polygon.prototype.isConcave=function(){for(var t=0,e=0,n=this.handles.length,i=0;i<n;i++){var o=this.handles[i].point,s=this.handles[(i+1)%n].point,r=this.handles[(i+2)%n].point,y=Vector2D.fromPoints(o,s),a=Vector2D.fromPoints(s,r);y.cross(a)<0?e++:t++}return 0!=e&&0!=t},Polygon.prototype.isConvex=function(){return!this.isConcave()},Rectangle.prototype=new Shape,Rectangle.prototype.constructor=Rectangle,Rectangle.superclass=Shape.prototype,Rectangle.prototype.init=function(t){if("rect"!=t.localName)throw new Error("Rectangle.init: Invalid SVG Node: "+t.localName);Rectangle.superclass.init.call(this,t);var e=parseFloat(t.getAttributeNS(null,"x")),n=parseFloat(t.getAttributeNS(null,"y")),i=parseFloat(t.getAttributeNS(null,"width")),o=parseFloat(t.getAttributeNS(null,"height"));this.p1=new Handle(e,n,this),this.p2=new Handle(e+i,n+o,this)},Rectangle.prototype.realize=function(){null!=this.svgNode&&(this.p1.realize(),this.p2.realize(),this.p1.show(!1),this.p2.show(!1),this.svgNode.addEventListener("mousedown",this,!1))},Rectangle.prototype.refresh=function(){var t=this.p1.point.min(this.p2.point),e=this.p1.point.max(this.p2.point);this.svgNode.setAttributeNS(null,"x",t.x),this.svgNode.setAttributeNS(null,"y",t.y),this.svgNode.setAttributeNS(null,"width",e.x-t.x),this.svgNode.setAttributeNS(null,"height",e.y-t.y)},Rectangle.prototype.registerHandles=function(){mouser.register(this.p1),mouser.register(this.p2)},Rectangle.prototype.unregisterHandles=function(){mouser.unregister(this.p1),mouser.unregister(this.p2)},Rectangle.prototype.selectHandles=function(t){this.p1.select(t),this.p2.select(t)},Rectangle.prototype.showHandles=function(t){this.p1.show(t),this.p2.show(t)},Rectangle.prototype.getIntersectionParams=function(){return new IntersectionParams("Rectangle",[this.p1.point,this.p2.point])};