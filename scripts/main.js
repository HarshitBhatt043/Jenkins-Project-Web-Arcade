"use strict";window.DOMHandler=class{constructor(e,t){this._iRuntime=e,this._componentId=t,this._hasTickCallback=!1,this._tickCallback=()=>this.Tick()}Attach(){}PostToRuntime(e,t,i,n){this._iRuntime.PostToRuntimeComponent(this._componentId,e,t,i,n)}PostToRuntimeAsync(e,t,i,n){return this._iRuntime.PostToRuntimeComponentAsync(this._componentId,e,t,i,n)}_PostToRuntimeMaybeSync(e,t,i){this._iRuntime.UsesWorker()?this.PostToRuntime(e,t,i):this._iRuntime._GetLocalRuntime()._OnMessageFromDOM({type:"event",component:this._componentId,handler:e,dispatchOpts:i||null,data:t,responseId:null})}AddRuntimeMessageHandler(e,t){this._iRuntime.AddRuntimeComponentMessageHandler(this._componentId,e,t)}AddRuntimeMessageHandlers(e){for(const[t,i]of e)this.AddRuntimeMessageHandler(t,i)}GetRuntimeInterface(){return this._iRuntime}GetComponentID(){return this._componentId}_StartTicking(){this._hasTickCallback||(this._iRuntime._AddRAFCallback(this._tickCallback),this._hasTickCallback=!0)}_StopTicking(){this._hasTickCallback&&(this._iRuntime._RemoveRAFCallback(this._tickCallback),this._hasTickCallback=!1)}Tick(){}},window.RateLimiter=class{constructor(e,t){this._callback=e,this._interval=t,this._timerId=-1,this._lastCallTime=-1/0,this._timerCallFunc=()=>this._OnTimer(),this._canRunImmediate=this._ignoreReset=!1}SetCanRunImmediate(e){this._canRunImmediate=!!e}Call(){if(-1===this._timerId){var e=Date.now(),t=e-this._lastCallTime,i=this._interval;t>=i&&this._canRunImmediate?(this._lastCallTime=e,this._RunCallback()):this._timerId=self.setTimeout(this._timerCallFunc,Math.max(i-t,4))}}_RunCallback(){this._ignoreReset=!0,this._callback(),this._ignoreReset=!1}Reset(){this._ignoreReset||(this._CancelTimer(),this._lastCallTime=Date.now())}_OnTimer(){this._timerId=-1,this._lastCallTime=Date.now(),this._RunCallback()}_CancelTimer(){-1!==this._timerId&&(self.clearTimeout(this._timerId),this._timerId=-1)}Release(){this._CancelTimer(),this._timerCallFunc=this._callback=null}},window.DOMElementHandler=class extends self.DOMHandler{constructor(e,t){super(e,t),this._elementMap=new Map,this._autoAttach=!0,this.AddRuntimeMessageHandlers([["create",e=>this._OnCreate(e)],["destroy",e=>this._OnDestroy(e)],["set-visible",e=>this._OnSetVisible(e)],["update-position",e=>this._OnUpdatePosition(e)],["update-state",e=>this._OnUpdateState(e)],["focus",e=>this._OnSetFocus(e)],["set-css-style",e=>this._OnSetCssStyle(e)],["set-attribute",e=>this._OnSetAttribute(e)],["remove-attribute",e=>this._OnRemoveAttribute(e)]]),this.AddDOMElementMessageHandler("get-element",(e=>e))}SetAutoAttach(e){this._autoAttach=!!e}AddDOMElementMessageHandler(e,t){this.AddRuntimeMessageHandler(e,(e=>{const i=this._elementMap.get(e.elementId);return t(i,e)}))}_OnCreate(e){const t=e.elementId,i=this.CreateElement(t,e);this._elementMap.set(t,i),i.style.boxSizing="border-box",e.isVisible||(i.style.display="none"),(e=this._GetFocusElement(i)).addEventListener("focus",(e=>this._OnFocus(t))),e.addEventListener("blur",(e=>this._OnBlur(t))),this._autoAttach&&document.body.appendChild(i)}CreateElement(e,t){throw Error("required override")}DestroyElement(e){}_OnDestroy(e){e=e.elementId;const t=this._elementMap.get(e);this.DestroyElement(t),this._autoAttach&&t.parentElement.removeChild(t),this._elementMap.delete(e)}PostToRuntimeElement(e,t,i){i||(i={}),i.elementId=t,this.PostToRuntime(e,i)}_PostToRuntimeElementMaybeSync(e,t,i){i||(i={}),i.elementId=t,this._PostToRuntimeMaybeSync(e,i)}_OnSetVisible(e){this._autoAttach&&(this._elementMap.get(e.elementId).style.display=e.isVisible?"":"none")}_OnUpdatePosition(e){if(this._autoAttach){var t=this._elementMap.get(e.elementId);t.style.left=e.left+"px",t.style.top=e.top+"px",t.style.width=e.width+"px",t.style.height=e.height+"px",null!==(e=e.fontSize)&&(t.style.fontSize=e+"em")}}_OnUpdateState(e){const t=this._elementMap.get(e.elementId);this.UpdateState(t,e)}UpdateState(e,t){throw Error("required override")}_GetFocusElement(e){return e}_OnFocus(e){this.PostToRuntimeElement("elem-focused",e)}_OnBlur(e){this.PostToRuntimeElement("elem-blurred",e)}_OnSetFocus(e){const t=this._GetFocusElement(this._elementMap.get(e.elementId));e.focus?t.focus():t.blur()}_OnSetCssStyle(e){this._elementMap.get(e.elementId).style[e.prop]=e.val}_OnSetAttribute(e){this._elementMap.get(e.elementId).setAttribute(e.name,e.val)}_OnRemoveAttribute(e){this._elementMap.get(e.elementId).removeAttribute(e.name)}GetElementById(e){return this._elementMap.get(e)}};{const e=/(iphone|ipod|ipad|macos|macintosh|mac os x)/i.test(navigator.userAgent);let t=0;function i(e){const i=document.createElement("script");return i.async=!1,i.type="module",e.isStringSrc?new Promise((n=>{const s="c3_resolve_"+t;++t,self[s]=n,i.textContent=e.str+`\n\nself["${s}"]();`,document.head.appendChild(i)})):new Promise(((t,n)=>{i.onload=t,i.onerror=n,i.src=e,document.head.appendChild(i)}))}let n=!1,s=!1;function a(){if(!n){try{new Worker("blob://",{get type(){s=!0}})}catch(e){}n=!0}return s}let r=new Audio;const o={"audio/webm; codecs=opus":!!r.canPlayType("audio/webm; codecs=opus"),"audio/ogg; codecs=opus":!!r.canPlayType("audio/ogg; codecs=opus"),"audio/webm; codecs=vorbis":!!r.canPlayType("audio/webm; codecs=vorbis"),"audio/ogg; codecs=vorbis":!!r.canPlayType("audio/ogg; codecs=vorbis"),"audio/mp4":!!r.canPlayType("audio/mp4"),"audio/mpeg":!!r.canPlayType("audio/mpeg")};async function d(e){return e=await l(e),new TextDecoder("utf-8").decode(e)}function l(e){return new Promise(((t,i)=>{const n=new FileReader;n.onload=e=>t(e.target.result),n.onerror=e=>i(e),n.readAsArrayBuffer(e)}))}r=null;const c=[];let h=0;window.RealFile=window.File;const u=[],m=new Map,_=new Map;let w=0;const p=[];self.runOnStartup=function(e){if("function"!=typeof e)throw Error("runOnStartup called without a function");p.push(e)};const v=new Set(["cordova","playable-ad","instant-games"]);function g(e){return v.has(e)}let f=!1;window.RuntimeInterface=class t{constructor(e){if(this._useWorker=e.useWorker,this._messageChannelPort=null,this._baseUrl="",this._scriptFolder=e.scriptFolder,this._workerScriptURLs={},this._localRuntime=this._worker=null,this._domHandlers=[],this._jobScheduler=this._canvas=this._runtimeDomHandler=null,this._rafId=-1,this._rafFunc=()=>this._OnRAFCallback(),this._rafCallbacks=[],this._exportType=e.exportType,this._isFileProtocol="file"===location.protocol.substr(0,4),!this._useWorker||"undefined"!=typeof OffscreenCanvas&&navigator.userActivation&&a()||(this._useWorker=!1),"playable-ad"!==this._exportType&&"instant-games"!==this._exportType||(this._useWorker=!1),"cordova"===this._exportType&&this._useWorker)if(/android/i.test(navigator.userAgent)){const e=/Chrome\/(\d+)/i.exec(navigator.userAgent);e&&90<=parseInt(e[1],10)||(this._useWorker=!1)}else this._useWorker=!1;this._localFileStrings=this._localFileBlobs=null,"html5"!==this._exportType&&"playable-ad"!==this._exportType||!this._isFileProtocol||alert("Exported games won't work until you upload them. (When running on the file: protocol, browsers block many features from working for security reasons.)"),"html5"!==this._exportType||window.isSecureContext,this.AddRuntimeComponentMessageHandler("runtime","cordova-fetch-local-file",(e=>this._OnCordovaFetchLocalFile(e))),this.AddRuntimeComponentMessageHandler("runtime","create-job-worker",(e=>this._OnCreateJobWorker(e))),"cordova"===this._exportType?document.addEventListener("deviceready",(()=>this._Init(e))):this._Init(e)}Release(){this._CancelAnimationFrame(),this._messageChannelPort&&(this._messageChannelPort=this._messageChannelPort.onmessage=null),this._worker&&(this._worker.terminate(),this._worker=null),this._localRuntime&&(this._localRuntime.Release(),this._localRuntime=null),this._canvas&&(this._canvas.parentElement.removeChild(this._canvas),this._canvas=null)}GetCanvas(){return this._canvas}GetBaseURL(){return this._baseUrl}UsesWorker(){return this._useWorker}GetExportType(){return this._exportType}IsFileProtocol(){return this._isFileProtocol}GetScriptFolder(){return this._scriptFolder}IsiOSCordova(){return e&&"cordova"===this._exportType}IsiOSWebView(){const t=navigator.userAgent;return e&&g(this._exportType)||navigator.standalone||/crios\/|fxios\/|edgios\//i.test(t)}async _Init(e){if("macos-wkwebview"===this._exportType&&this._SendWrapperMessage({type:"ready"}),"playable-ad"===this._exportType){this._localFileBlobs=self.c3_base64files,this._localFileStrings={},await this._ConvertDataUrisToBlobs();for(let i=0,n=e.engineScripts.length;i<n;++i){var t=e.engineScripts[i].toLowerCase();this._localFileStrings.hasOwnProperty(t)?e.engineScripts[i]={isStringSrc:!0,str:this._localFileStrings[t]}:this._localFileBlobs.hasOwnProperty(t)&&(e.engineScripts[i]=URL.createObjectURL(this._localFileBlobs[t]))}}e.baseUrl?this._baseUrl=e.baseUrl:(t=location.origin,this._baseUrl=("null"===t?"file:///":t)+location.pathname,-1!==(t=this._baseUrl.lastIndexOf("/"))&&(this._baseUrl=this._baseUrl.substr(0,t+1))),e.workerScripts&&(this._workerScriptURLs=e.workerScripts),t=new MessageChannel,this._messageChannelPort=t.port1,this._messageChannelPort.onmessage=e=>this._OnMessageFromRuntime(e.data),window.c3_addPortMessageHandler&&window.c3_addPortMessageHandler((e=>this._OnMessageFromDebugger(e))),this._jobScheduler=new self.JobSchedulerDOM(this),await this._jobScheduler.Init(),"object"==typeof window.StatusBar&&window.StatusBar.hide(),"object"==typeof window.AndroidFullScreen&&window.AndroidFullScreen.immersiveMode(),this._useWorker?await this._InitWorker(e,t.port2):await this._InitDOM(e,t.port2)}_GetWorkerURL(e){return(e=this._workerScriptURLs.hasOwnProperty(e)?this._workerScriptURLs[e]:e.endsWith("/workermain.js")&&this._workerScriptURLs.hasOwnProperty("workermain.js")?this._workerScriptURLs["workermain.js"]:"playable-ad"===this._exportType&&this._localFileBlobs.hasOwnProperty(e.toLowerCase())?this._localFileBlobs[e.toLowerCase()]:e)instanceof Blob&&(e=URL.createObjectURL(e)),e}async CreateWorker(e,t,i){if(e.startsWith("blob:"))return new Worker(e,i);if("cordova"===this._exportType&&this._isFileProtocol)return e=await this.CordovaFetchLocalFileAsArrayBuffer(i.isC3MainWorker?e:this._scriptFolder+e),e=new Blob([e],{type:"application/javascript"}),new Worker(URL.createObjectURL(e),i);if(e=new URL(e,t),location.origin!==e.origin){if(!(e=await fetch(e)).ok)throw Error("failed to fetch worker script");return e=await e.blob(),new Worker(URL.createObjectURL(e),i)}return new Worker(e,i)}_GetWindowInnerWidth(){return Math.max(window.innerWidth,1)}_GetWindowInnerHeight(){return Math.max(window.innerHeight,1)}_GetCommonRuntimeOptions(e){return{baseUrl:this._baseUrl,windowInnerWidth:this._GetWindowInnerWidth(),windowInnerHeight:this._GetWindowInnerHeight(),devicePixelRatio:window.devicePixelRatio,isFullscreen:t.IsDocumentFullscreen(),projectData:e.projectData,previewImageBlobs:window.cr_previewImageBlobs||this._localFileBlobs,previewProjectFileBlobs:window.cr_previewProjectFileBlobs,previewProjectFileSWUrls:window.cr_previewProjectFiles,swClientId:window.cr_swClientId||"",exportType:e.exportType,isDebug:-1<self.location.search.indexOf("debug"),ife:!!self.ife,jobScheduler:this._jobScheduler.GetPortData(),supportedAudioFormats:o,opusWasmScriptUrl:window.cr_opusWasmScriptUrl||this._scriptFolder+"opus.wasm.js",opusWasmBinaryUrl:window.cr_opusWasmBinaryUrl||this._scriptFolder+"opus.wasm.wasm",isFileProtocol:this._isFileProtocol,isiOSCordova:this.IsiOSCordova(),isiOSWebView:this.IsiOSWebView(),isFBInstantAvailable:void 0!==self.FBInstant}}async _InitWorker(e,t){var i=this._GetWorkerURL(e.workerMainUrl);this._worker=await this.CreateWorker(i,this._baseUrl,{type:"module",name:"Runtime",isC3MainWorker:!0}),this._canvas=document.createElement("canvas"),this._canvas.style.display="none",i=this._canvas.transferControlToOffscreen(),document.body.appendChild(this._canvas),window.c3canvas=this._canvas;let n=e.workerDependencyScripts||[],s=e.engineScripts;if(n=await Promise.all(n.map((e=>this._MaybeGetCordovaScriptURL(e)))),s=await Promise.all(s.map((e=>this._MaybeGetCordovaScriptURL(e)))),"cordova"===this._exportType)for(let t=0,i=e.projectScripts.length;t<i;++t){const i=e.projectScripts[t],n=i[0];(n===e.mainProjectScript||"scriptsInEvents.js"===n||n.endsWith("/scriptsInEvents.js"))&&(i[1]=await this._MaybeGetCordovaScriptURL(n))}this._worker.postMessage(Object.assign(this._GetCommonRuntimeOptions(e),{type:"init-runtime",isInWorker:!0,messagePort:t,canvas:i,workerDependencyScripts:n,engineScripts:s,projectScripts:e.projectScripts,mainProjectScript:e.mainProjectScript,projectScriptsStatus:self.C3_ProjectScriptsStatus}),[t,i,...this._jobScheduler.GetPortTransferables()]),this._domHandlers=u.map((e=>new e(this))),this._FindRuntimeDOMHandler(),self.c3_callFunction=(e,t)=>this._runtimeDomHandler._InvokeFunctionFromJS(e,t),"preview"===this._exportType&&(self.goToLastErrorScript=()=>this.PostToRuntimeComponent("runtime","go-to-last-error-script"))}async _InitDOM(e,t){this._canvas=document.createElement("canvas"),this._canvas.style.display="none",document.body.appendChild(this._canvas),window.c3canvas=this._canvas,this._domHandlers=u.map((e=>new e(this))),this._FindRuntimeDOMHandler();var n=e.engineScripts.map((e=>"string"==typeof e?new URL(e,this._baseUrl).toString():e));Array.isArray(e.workerDependencyScripts)&&n.unshift(...e.workerDependencyScripts),n=await Promise.all(n.map((e=>this._MaybeGetCordovaScriptURL(e)))),await Promise.all(n.map((e=>i(e)))),n=self.C3_ProjectScriptsStatus;const s=e.mainProjectScript,a=e.projectScripts;for(let[e,t]of a)if(t||(t=e),e===s)try{t=await this._MaybeGetCordovaScriptURL(t),await i(t),"preview"!==this._exportType||n[e]||this._ReportProjectMainScriptError(e,"main script did not run to completion")}catch(t){this._ReportProjectMainScriptError(e,t)}else("scriptsInEvents.js"===e||e.endsWith("/scriptsInEvents.js"))&&(t=await this._MaybeGetCordovaScriptURL(t),await i(t));"preview"===this._exportType&&"object"!=typeof self.C3.ScriptsInEvents?(this._RemoveLoadingMessage(),alert("Failed to load JavaScript code used in events. Check all your JavaScript code has valid syntax.")):(e=Object.assign(this._GetCommonRuntimeOptions(e),{isInWorker:!1,messagePort:t,canvas:this._canvas,runOnStartupFunctions:p}),this._OnBeforeCreateRuntime(),this._localRuntime=self.C3_CreateRuntime(e),await self.C3_InitRuntime(this._localRuntime,e))}_ReportProjectMainScriptError(e,t){this._RemoveLoadingMessage(),alert(`Failed to load project main script (${e}). Check all your JavaScript code has valid syntax. Press F12 and check the console for error details.`)}_OnBeforeCreateRuntime(){this._RemoveLoadingMessage()}_RemoveLoadingMessage(){const e=window.cr_previewLoadingElem;e&&(e.parentElement.removeChild(e),window.cr_previewLoadingElem=null)}async _OnCreateJobWorker(e){return{outputPort:e=await this._jobScheduler._CreateJobWorker(),transferables:[e]}}_GetLocalRuntime(){if(this._useWorker)throw Error("not available in worker mode");return this._localRuntime}PostToRuntimeComponent(e,t,i,n,s){this._messageChannelPort.postMessage({type:"event",component:e,handler:t,dispatchOpts:n||null,data:i,responseId:null},s)}PostToRuntimeComponentAsync(e,t,i,n,s){const a=w++,r=new Promise(((e,t)=>{_.set(a,{resolve:e,reject:t})}));return this._messageChannelPort.postMessage({type:"event",component:e,handler:t,dispatchOpts:n||null,data:i,responseId:a},s),r}_OnMessageFromRuntime(e){const t=e.type;if("event"===t)return this._OnEventFromRuntime(e);if("result"===t)this._OnResultFromRuntime(e);else if("runtime-ready"===t)this._OnRuntimeReady();else if("alert-error"===t)this._RemoveLoadingMessage(),alert(e.message);else{if("creating-runtime"!==t)throw Error(`unknown message '${t}'`);this._OnBeforeCreateRuntime()}}_OnEventFromRuntime(e){const t=e.component,i=e.handler,n=e.data,s=e.responseId;if((e=m.get(t))&&(e=e.get(i))){var a=null;try{a=e(n)}catch(e){return void(null!==s&&this._PostResultToRuntime(s,!1,""+e))}if(null===s)return a;a&&a.then?a.then((e=>this._PostResultToRuntime(s,!0,e))).catch((e=>{this._PostResultToRuntime(s,!1,""+e)})):this._PostResultToRuntime(s,!0,a)}}_PostResultToRuntime(e,t,i){let n;i&&i.transferables&&(n=i.transferables),this._messageChannelPort.postMessage({type:"result",responseId:e,isOk:t,result:i},n)}_OnResultFromRuntime(e){const t=e.responseId,i=e.isOk;e=e.result;const n=_.get(t);i?n.resolve(e):n.reject(e),_.delete(t)}AddRuntimeComponentMessageHandler(e,t,i){let n=m.get(e);if(n||(n=new Map,m.set(e,n)),n.has(t))throw Error(`[DOM] Component '${e}' already has handler '${t}'`);n.set(t,i)}static AddDOMHandlerClass(e){if(u.includes(e))throw Error("DOM handler already added");u.push(e)}_FindRuntimeDOMHandler(){for(const e of this._domHandlers)if("runtime"===e.GetComponentID())return void(this._runtimeDomHandler=e);throw Error("cannot find runtime DOM handler")}_OnMessageFromDebugger(e){this.PostToRuntimeComponent("debugger","message",e)}_OnRuntimeReady(){for(const e of this._domHandlers)e.Attach()}static IsDocumentFullscreen(){return!!(document.fullscreenElement||document.webkitFullscreenElement||document.mozFullScreenElement||f)}static _SetWrapperIsFullscreenFlag(e){f=!!e}async GetRemotePreviewStatusInfo(){return await this.PostToRuntimeComponentAsync("runtime","get-remote-preview-status-info")}_AddRAFCallback(e){this._rafCallbacks.push(e),this._RequestAnimationFrame()}_RemoveRAFCallback(e){if(-1===(e=this._rafCallbacks.indexOf(e)))throw Error("invalid callback");this._rafCallbacks.splice(e,1),this._rafCallbacks.length||this._CancelAnimationFrame()}_RequestAnimationFrame(){-1===this._rafId&&this._rafCallbacks.length&&(this._rafId=requestAnimationFrame(this._rafFunc))}_CancelAnimationFrame(){-1!==this._rafId&&(cancelAnimationFrame(this._rafId),this._rafId=-1)}_OnRAFCallback(){this._rafId=-1;for(const e of this._rafCallbacks)e();this._RequestAnimationFrame()}TryPlayMedia(e){this._runtimeDomHandler.TryPlayMedia(e)}RemovePendingPlay(e){this._runtimeDomHandler.RemovePendingPlay(e)}_PlayPendingMedia(){this._runtimeDomHandler._PlayPendingMedia()}SetSilent(e){this._runtimeDomHandler.SetSilent(e)}IsAudioFormatSupported(e){return!!o[e]}async _WasmDecodeWebMOpus(e){return e=await this.PostToRuntimeComponentAsync("runtime","opus-decode",{arrayBuffer:e},null,[e]),new Float32Array(e)}IsAbsoluteURL(e){return/^(?:[a-z\-]+:)?\/\//.test(e)||"data:"===e.substr(0,5)||"blob:"===e.substr(0,5)}IsRelativeURL(e){return!this.IsAbsoluteURL(e)}async _MaybeGetCordovaScriptURL(e){return"cordova"===this._exportType&&(e.startsWith("file:")||this._isFileProtocol&&this.IsRelativeURL(e))?(e.startsWith(this._baseUrl)&&(e=e.substr(this._baseUrl.length)),e=await this.CordovaFetchLocalFileAsArrayBuffer(e),e=new Blob([e],{type:"application/javascript"}),URL.createObjectURL(e)):e}async _OnCordovaFetchLocalFile(e){const t=e.filename;switch(e.as){case"text":return await this.CordovaFetchLocalFileAsText(t);case"buffer":return await this.CordovaFetchLocalFileAsArrayBuffer(t);default:throw Error("unsupported type")}}_GetPermissionAPI(){const e=window.cordova&&window.cordova.plugins&&window.cordova.plugins.permissions;if("object"!=typeof e)throw Error("Permission API is not loaded");return e}_MapPermissionID(e,t){if("string"!=typeof(e=e[t]))throw Error("Invalid permission name");return e}_HasPermission(e){const t=this._GetPermissionAPI();return new Promise(((i,n)=>t.checkPermission(this._MapPermissionID(t,e),(e=>i(!!e.hasPermission)),n)))}_RequestPermission(e){const t=this._GetPermissionAPI();return new Promise(((i,n)=>t.requestPermission(this._MapPermissionID(t,e),(e=>i(!!e.hasPermission)),n)))}async RequestPermissions(e){if("cordova"!==this.GetExportType()||this.IsiOSCordova())return!0;for(const t of e)if(!await this._HasPermission(t)&&!1===await this._RequestPermission(t))return!1;return!0}async RequirePermissions(...e){if(!1===await this.RequestPermissions(e))throw Error("Permission not granted")}CordovaFetchLocalFile(e){const t=window.cordova.file.applicationDirectory+"www/"+e.toLowerCase();return new Promise(((e,i)=>{window.resolveLocalFileSystemURL(t,(t=>{t.file(e,i)}),i)}))}async CordovaFetchLocalFileAsText(e){return e=await this.CordovaFetchLocalFile(e),await d(e)}_CordovaMaybeStartNextArrayBufferRead(){if(c.length&&!(8<=h)){h++;var e=c.shift();this._CordovaDoFetchLocalFileAsAsArrayBuffer(e.filename,e.successCallback,e.errorCallback)}}CordovaFetchLocalFileAsArrayBuffer(e){return new Promise(((t,i)=>{c.push({filename:e,successCallback:e=>{h--,this._CordovaMaybeStartNextArrayBufferRead(),t(e)},errorCallback:e=>{h--,this._CordovaMaybeStartNextArrayBufferRead(),i(e)}}),this._CordovaMaybeStartNextArrayBufferRead()}))}async _CordovaDoFetchLocalFileAsAsArrayBuffer(e,t,i){try{const i=await this.CordovaFetchLocalFile(e);t(await l(i))}catch(e){i(e)}}_SendWrapperMessage(e){if("windows-webview2"===this._exportType)window.chrome.webview.postMessage(JSON.stringify(e));else{if("macos-wkwebview"!==this._exportType)throw Error("cannot send wrapper message");window.webkit.messageHandlers.C3Wrapper.postMessage(JSON.stringify(e))}}async _ConvertDataUrisToBlobs(){const e=[];for(const[t,i]of Object.entries(this._localFileBlobs))e.push(this._ConvertDataUriToBlobs(t,i));await Promise.all(e)}async _ConvertDataUriToBlobs(e,t){if("object"==typeof t)this._localFileBlobs[e]=new Blob([t.str],{type:t.type}),this._localFileStrings[e]=t.str;else{let i=await this._FetchDataUri(t);i||(i=this._DataURIToBinaryBlobSync(t)),this._localFileBlobs[e]=i}}async _FetchDataUri(e){try{return await(await fetch(e)).blob()}catch(e){return null}}_DataURIToBinaryBlobSync(e){return e=this._ParseDataURI(e),this._BinaryStringToBlob(e.data,e.mime_type)}_ParseDataURI(e){var t=e.indexOf(",");if(0>t)throw new URIError("expected comma in data: uri");var i=e.substring(5,t);e=e.substring(t+1),t=i.split(";"),i=t[0]||"";const n=t[2];return{mime_type:i,data:e="base64"===t[1]||"base64"===n?atob(e):decodeURIComponent(e)}}_BinaryStringToBlob(e,t){var i=e.length;let n,s,a=i>>2,r=new Uint8Array(i),o=new Uint32Array(r.buffer,0,a);for(s=n=0;n<a;++n)o[n]=e.charCodeAt(s++)|e.charCodeAt(s++)<<8|e.charCodeAt(s++)<<16|e.charCodeAt(s++)<<24;for(i&=3;i--;)r[s]=e.charCodeAt(s),++s;return new Blob([r],{type:t})}}}{const e=self.RuntimeInterface;function t(e){return e.sourceCapabilities&&e.sourceCapabilities.firesTouchEvents||e.originalEvent&&e.originalEvent.sourceCapabilities&&e.originalEvent.sourceCapabilities.firesTouchEvents}const i=new Map([["OSLeft","MetaLeft"],["OSRight","MetaRight"]]),n={dispatchRuntimeEvent:!0,dispatchUserScriptEvent:!0},s={dispatchUserScriptEvent:!0},a={dispatchRuntimeEvent:!0};function r(e){return new Promise(((t,i)=>{const n=document.createElement("link");n.onload=()=>t(n),n.onerror=e=>i(e),n.rel="stylesheet",n.href=e,document.head.appendChild(n)}))}function o(e){return new Promise(((t,i)=>{const n=new Image;n.onload=()=>t(n),n.onerror=e=>i(e),n.src=e}))}async function d(e){e=URL.createObjectURL(e);try{return await o(e)}finally{URL.revokeObjectURL(e)}}function l(e){return new Promise(((t,i)=>{let n=new FileReader;n.onload=e=>t(e.target.result),n.onerror=e=>i(e),n.readAsText(e)}))}async function c(e,t,i){if(!/firefox/i.test(navigator.userAgent))return await d(e);var n=await l(e);const s=(n=(new DOMParser).parseFromString(n,"image/svg+xml")).documentElement;if(s.hasAttribute("width")&&s.hasAttribute("height")){const t=s.getAttribute("width"),i=s.getAttribute("height");if(!t.includes("%")&&!i.includes("%"))return await d(e)}return s.setAttribute("width",t+"px"),s.setAttribute("height",i+"px"),n=(new XMLSerializer).serializeToString(n),e=new Blob([n],{type:"image/svg+xml"}),await d(e)}function h(e){do{if(e.parentNode&&e.hasAttribute("contenteditable"))return!0;e=e.parentNode}while(e);return!1}const u=new Set(["input","textarea","datalist","select"]);function m(e){return u.has(e.tagName.toLowerCase())||h(e)}const _=new Set(["canvas","body","html"]);function w(e){const t=e.target.tagName.toLowerCase();_.has(t)&&e.preventDefault()}function p(e){(e.metaKey||e.ctrlKey)&&e.preventDefault()}self.C3_GetSvgImageSize=async function(e){if(0<(e=await d(e)).width&&0<e.height)return[e.width,e.height];{e.style.position="absolute",e.style.left="0px",e.style.top="0px",e.style.visibility="hidden",document.body.appendChild(e);const t=e.getBoundingClientRect();return document.body.removeChild(e),[t.width,t.height]}},self.C3_RasterSvgImageBlob=async function(e,t,i,n,s){e=await c(e,t,i);const a=document.createElement("canvas");return a.width=n,a.height=s,a.getContext("2d").drawImage(e,0,0,t,i),a};let v=!1;function g(){try{return window.parent&&window.parent.document.hasFocus()}catch(e){return!1}}function f(){const e=document.activeElement;if(!e)return!1;const t=e.tagName.toLowerCase(),i=new Set("email number password search tel text url".split(" "));return"textarea"===t||("input"===t?i.has(e.type.toLowerCase()||"text"):h(e))}document.addEventListener("pause",(()=>v=!0)),document.addEventListener("resume",(()=>v=!1)),e.AddDOMHandlerClass(class extends self.DOMHandler{constructor(e){super(e,"runtime"),this._isFirstSizeUpdate=!0,this._simulatedResizeTimerId=-1,this._targetOrientation="any",this._attachedDeviceMotionEvent=this._attachedDeviceOrientationEvent=!1,this._lastPointerRawUpdateEvent=this._pointerRawUpdateRateLimiter=this._debugHighlightElem=null,this._pointerRawMovementY=this._pointerRawMovementX=0,e.AddRuntimeComponentMessageHandler("canvas","update-size",(e=>this._OnUpdateCanvasSize(e))),e.AddRuntimeComponentMessageHandler("runtime","invoke-download",(e=>this._OnInvokeDownload(e))),e.AddRuntimeComponentMessageHandler("runtime","raster-svg-image",(e=>this._OnRasterSvgImage(e))),e.AddRuntimeComponentMessageHandler("runtime","get-svg-image-size",(e=>this._OnGetSvgImageSize(e))),e.AddRuntimeComponentMessageHandler("runtime","set-target-orientation",(e=>this._OnSetTargetOrientation(e))),e.AddRuntimeComponentMessageHandler("runtime","register-sw",(()=>this._OnRegisterSW())),e.AddRuntimeComponentMessageHandler("runtime","post-to-debugger",(e=>this._OnPostToDebugger(e))),e.AddRuntimeComponentMessageHandler("runtime","go-to-script",(e=>this._OnPostToDebugger(e))),e.AddRuntimeComponentMessageHandler("runtime","before-start-ticking",(()=>this._OnBeforeStartTicking())),e.AddRuntimeComponentMessageHandler("runtime","debug-highlight",(e=>this._OnDebugHighlight(e))),e.AddRuntimeComponentMessageHandler("runtime","enable-device-orientation",(()=>this._AttachDeviceOrientationEvent())),e.AddRuntimeComponentMessageHandler("runtime","enable-device-motion",(()=>this._AttachDeviceMotionEvent())),e.AddRuntimeComponentMessageHandler("runtime","add-stylesheet",(e=>this._OnAddStylesheet(e))),e.AddRuntimeComponentMessageHandler("runtime","alert",(e=>this._OnAlert(e))),e.AddRuntimeComponentMessageHandler("runtime","hide-cordova-splash",(()=>this._OnHideCordovaSplash()));const t=new Set(["input","textarea","datalist"]);window.addEventListener("contextmenu",(e=>{const i=e.target,n=i.tagName.toLowerCase();t.has(n)||h(i)||e.preventDefault()}));const i=e.GetCanvas();window.addEventListener("selectstart",w),window.addEventListener("gesturehold",w),i.addEventListener("selectstart",w),i.addEventListener("gesturehold",w),window.addEventListener("touchstart",w,{passive:!1}),"undefined"!=typeof PointerEvent?(window.addEventListener("pointerdown",w,{passive:!1}),i.addEventListener("pointerdown",w)):i.addEventListener("touchstart",w),this._mousePointerLastButtons=0,window.addEventListener("mousedown",(e=>{1===e.button&&e.preventDefault()})),window.addEventListener("mousewheel",p,{passive:!1}),window.addEventListener("wheel",p,{passive:!1}),window.addEventListener("resize",(()=>this._OnWindowResize())),window.addEventListener("fullscreenchange",(()=>this._OnFullscreenChange())),window.addEventListener("webkitfullscreenchange",(()=>this._OnFullscreenChange())),window.addEventListener("mozfullscreenchange",(()=>this._OnFullscreenChange())),window.addEventListener("fullscreenerror",(e=>this._OnFullscreenError(e))),window.addEventListener("webkitfullscreenerror",(e=>this._OnFullscreenError(e))),window.addEventListener("mozfullscreenerror",(e=>this._OnFullscreenError(e))),e.IsiOSWebView()&&window.addEventListener("focusout",(()=>{f()||(document.scrollingElement.scrollTop=0)})),self.C3WrapperOnMessage=e=>this._OnWrapperMessage(e),this._mediaPendingPlay=new Set,this._mediaRemovedPendingPlay=new WeakSet,this._isSilent=!1}_OnBeforeStartTicking(){return"cordova"===this._iRuntime.GetExportType()?(document.addEventListener("pause",(()=>this._OnVisibilityChange(!0))),document.addEventListener("resume",(()=>this._OnVisibilityChange(!1)))):document.addEventListener("visibilitychange",(()=>this._OnVisibilityChange(document.hidden))),{isSuspended:!(!document.hidden&&!v)}}Attach(){window.addEventListener("focus",(()=>this._PostRuntimeEvent("window-focus"))),window.addEventListener("blur",(()=>{this._PostRuntimeEvent("window-blur",{parentHasFocus:g()}),this._mousePointerLastButtons=0})),window.addEventListener("focusin",(e=>{m(e.target)&&this._PostRuntimeEvent("keyboard-blur")})),window.addEventListener("keydown",(e=>this._OnKeyEvent("keydown",e))),window.addEventListener("keyup",(e=>this._OnKeyEvent("keyup",e))),window.addEventListener("dblclick",(e=>this._OnMouseEvent("dblclick",e,n))),window.addEventListener("wheel",(e=>this._OnMouseWheelEvent("wheel",e))),"undefined"!=typeof PointerEvent?(window.addEventListener("pointerdown",(e=>{this._HandlePointerDownFocus(e),this._OnPointerEvent("pointerdown",e)})),this._iRuntime.UsesWorker()&&void 0!==window.onpointerrawupdate&&self===self.top?(this._pointerRawUpdateRateLimiter=new self.RateLimiter((()=>this._DoSendPointerRawUpdate()),5),this._pointerRawUpdateRateLimiter.SetCanRunImmediate(!0),window.addEventListener("pointerrawupdate",(e=>this._OnPointerRawUpdate(e)))):window.addEventListener("pointermove",(e=>this._OnPointerEvent("pointermove",e))),window.addEventListener("pointerup",(e=>this._OnPointerEvent("pointerup",e))),window.addEventListener("pointercancel",(e=>this._OnPointerEvent("pointercancel",e)))):(window.addEventListener("mousedown",(e=>{this._HandlePointerDownFocus(e),this._OnMouseEventAsPointer("pointerdown",e)})),window.addEventListener("mousemove",(e=>this._OnMouseEventAsPointer("pointermove",e))),window.addEventListener("mouseup",(e=>this._OnMouseEventAsPointer("pointerup",e))),window.addEventListener("touchstart",(e=>{this._HandlePointerDownFocus(e),this._OnTouchEvent("pointerdown",e)})),window.addEventListener("touchmove",(e=>this._OnTouchEvent("pointermove",e))),window.addEventListener("touchend",(e=>this._OnTouchEvent("pointerup",e))),window.addEventListener("touchcancel",(e=>this._OnTouchEvent("pointercancel",e))));const e=()=>this._PlayPendingMedia();window.addEventListener("pointerup",e,!0),window.addEventListener("touchend",e,!0),window.addEventListener("click",e,!0),window.addEventListener("keydown",e,!0),window.addEventListener("gamepadconnected",e,!0)}_PostRuntimeEvent(e,t){this.PostToRuntime(e,t||null,a)}_GetWindowInnerWidth(){return this._iRuntime._GetWindowInnerWidth()}_GetWindowInnerHeight(){return this._iRuntime._GetWindowInnerHeight()}_OnWindowResize(){const t=this._GetWindowInnerWidth(),i=this._GetWindowInnerHeight();this._PostRuntimeEvent("window-resize",{innerWidth:t,innerHeight:i,devicePixelRatio:window.devicePixelRatio,isFullscreen:e.IsDocumentFullscreen()}),this._iRuntime.IsiOSWebView()&&(-1!==this._simulatedResizeTimerId&&clearTimeout(this._simulatedResizeTimerId),this._OnSimulatedResize(t,i,0))}_ScheduleSimulatedResize(e,t,i){-1!==this._simulatedResizeTimerId&&clearTimeout(this._simulatedResizeTimerId),this._simulatedResizeTimerId=setTimeout((()=>this._OnSimulatedResize(e,t,i)),48)}_OnSimulatedResize(t,i,n){const s=this._GetWindowInnerWidth(),a=this._GetWindowInnerHeight();this._simulatedResizeTimerId=-1,s!=t||a!=i?this._PostRuntimeEvent("window-resize",{innerWidth:s,innerHeight:a,devicePixelRatio:window.devicePixelRatio,isFullscreen:e.IsDocumentFullscreen()}):10>n&&this._ScheduleSimulatedResize(s,a,n+1)}_OnSetTargetOrientation(e){this._targetOrientation=e.targetOrientation}_TrySetTargetOrientation(){const e=this._targetOrientation;if(screen.orientation&&screen.orientation.lock)screen.orientation.lock(e).catch((e=>{}));else try{let t=!1;screen.lockOrientation?t=screen.lockOrientation(e):screen.webkitLockOrientation?t=screen.webkitLockOrientation(e):screen.mozLockOrientation?t=screen.mozLockOrientation(e):screen.msLockOrientation&&(t=screen.msLockOrientation(e))}catch(e){}}_OnFullscreenChange(){const t=e.IsDocumentFullscreen();t&&"any"!==this._targetOrientation&&this._TrySetTargetOrientation(),this.PostToRuntime("fullscreenchange",{isFullscreen:t,innerWidth:this._GetWindowInnerWidth(),innerHeight:this._GetWindowInnerHeight()})}_OnFullscreenError(t){this.PostToRuntime("fullscreenerror",{isFullscreen:e.IsDocumentFullscreen(),innerWidth:this._GetWindowInnerWidth(),innerHeight:this._GetWindowInnerHeight()})}_OnVisibilityChange(e){e?this._iRuntime._CancelAnimationFrame():this._iRuntime._RequestAnimationFrame(),this.PostToRuntime("visibilitychange",{hidden:e})}_OnKeyEvent(e,t){"Backspace"===t.key&&w(t);const s=i.get(t.code)||t.code;this._PostToRuntimeMaybeSync(e,{code:s,key:t.key,which:t.which,repeat:t.repeat,altKey:t.altKey,ctrlKey:t.ctrlKey,metaKey:t.metaKey,shiftKey:t.shiftKey,timeStamp:t.timeStamp},n)}_OnMouseWheelEvent(e,t){this.PostToRuntime(e,{clientX:t.clientX,clientY:t.clientY,pageX:t.pageX,pageY:t.pageY,deltaX:t.deltaX,deltaY:t.deltaY,deltaZ:t.deltaZ,deltaMode:t.deltaMode,timeStamp:t.timeStamp},n)}_OnMouseEvent(e,i,n){t(i)||this._PostToRuntimeMaybeSync(e,{button:i.button,buttons:i.buttons,clientX:i.clientX,clientY:i.clientY,pageX:i.pageX,pageY:i.pageY,movementX:i.movementX||0,movementY:i.movementY||0,timeStamp:i.timeStamp},n)}_OnMouseEventAsPointer(e,i){if(!t(i)){var a=this._mousePointerLastButtons;("pointerdown"===e&&0!==a||"pointerup"===e&&0!==i.buttons)&&(e="pointermove"),this._PostToRuntimeMaybeSync(e,{pointerId:1,pointerType:"mouse",button:i.button,buttons:i.buttons,lastButtons:a,clientX:i.clientX,clientY:i.clientY,pageX:i.pageX,pageY:i.pageY,movementX:i.movementX||0,movementY:i.movementY||0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,timeStamp:i.timeStamp},n),this._mousePointerLastButtons=i.buttons,this._OnMouseEvent(i.type,i,s)}}_OnPointerEvent(e,t){this._pointerRawUpdateRateLimiter&&"pointermove"!==e&&this._pointerRawUpdateRateLimiter.Reset();var i=0;"mouse"===t.pointerType&&(i=this._mousePointerLastButtons),this._PostToRuntimeMaybeSync(e,{pointerId:t.pointerId,pointerType:t.pointerType,button:t.button,buttons:t.buttons,lastButtons:i,clientX:t.clientX,clientY:t.clientY,pageX:t.pageX,pageY:t.pageY,movementX:(t.movementX||0)+this._pointerRawMovementX,movementY:(t.movementY||0)+this._pointerRawMovementY,width:t.width||0,height:t.height||0,pressure:t.pressure||0,tangentialPressure:t.tangentialPressure||0,tiltX:t.tiltX||0,tiltY:t.tiltY||0,twist:t.twist||0,timeStamp:t.timeStamp},n),this._pointerRawMovementY=this._pointerRawMovementX=0,"mouse"===t.pointerType&&(i="mousemove","pointerdown"===e?i="mousedown":"pointerup"===e&&(i="mouseup"),this._OnMouseEvent(i,t,s),this._mousePointerLastButtons=t.buttons)}_OnPointerRawUpdate(e){this._lastPointerRawUpdateEvent&&(this._pointerRawMovementX+=this._lastPointerRawUpdateEvent.movementX||0,this._pointerRawMovementY+=this._lastPointerRawUpdateEvent.movementY||0),this._lastPointerRawUpdateEvent=e,this._pointerRawUpdateRateLimiter.Call()}_DoSendPointerRawUpdate(){this._OnPointerEvent("pointermove",this._lastPointerRawUpdateEvent),this._lastPointerRawUpdateEvent=null}_OnTouchEvent(e,t){for(let i=0,s=t.changedTouches.length;i<s;++i){const s=t.changedTouches[i];this._PostToRuntimeMaybeSync(e,{pointerId:s.identifier,pointerType:"touch",button:0,buttons:0,lastButtons:0,clientX:s.clientX,clientY:s.clientY,pageX:s.pageX,pageY:s.pageY,movementX:t.movementX||0,movementY:t.movementY||0,width:2*(s.radiusX||s.webkitRadiusX||0),height:2*(s.radiusY||s.webkitRadiusY||0),pressure:s.force||s.webkitForce||0,tangentialPressure:0,tiltX:0,tiltY:0,twist:s.rotationAngle||0,timeStamp:t.timeStamp},n)}}_HandlePointerDownFocus(e){window!==window.top&&window.focus(),this._IsElementCanvasOrDocument(e.target)&&document.activeElement&&!this._IsElementCanvasOrDocument(document.activeElement)&&document.activeElement.blur()}_IsElementCanvasOrDocument(e){return!e||e===document||e===window||e===document.body||"canvas"===e.tagName.toLowerCase()}_AttachDeviceOrientationEvent(){this._attachedDeviceOrientationEvent||(this._attachedDeviceOrientationEvent=!0,window.addEventListener("deviceorientation",(e=>this._OnDeviceOrientation(e))),window.addEventListener("deviceorientationabsolute",(e=>this._OnDeviceOrientationAbsolute(e))))}_AttachDeviceMotionEvent(){this._attachedDeviceMotionEvent||(this._attachedDeviceMotionEvent=!0,window.addEventListener("devicemotion",(e=>this._OnDeviceMotion(e))))}_OnDeviceOrientation(e){this.PostToRuntime("deviceorientation",{absolute:!!e.absolute,alpha:e.alpha||0,beta:e.beta||0,gamma:e.gamma||0,timeStamp:e.timeStamp,webkitCompassHeading:e.webkitCompassHeading,webkitCompassAccuracy:e.webkitCompassAccuracy},n)}_OnDeviceOrientationAbsolute(e){this.PostToRuntime("deviceorientationabsolute",{absolute:!!e.absolute,alpha:e.alpha||0,beta:e.beta||0,gamma:e.gamma||0,timeStamp:e.timeStamp},n)}_OnDeviceMotion(e){let t=null;var i=e.acceleration;i&&(t={x:i.x||0,y:i.y||0,z:i.z||0}),i=null;var s=e.accelerationIncludingGravity;s&&(i={x:s.x||0,y:s.y||0,z:s.z||0}),s=null;const a=e.rotationRate;a&&(s={alpha:a.alpha||0,beta:a.beta||0,gamma:a.gamma||0}),this.PostToRuntime("devicemotion",{acceleration:t,accelerationIncludingGravity:i,rotationRate:s,interval:e.interval,timeStamp:e.timeStamp},n)}_OnUpdateCanvasSize(e){const t=this.GetRuntimeInterface().GetCanvas();t.style.width=e.styleWidth+"px",t.style.height=e.styleHeight+"px",t.style.marginLeft=e.marginLeft+"px",t.style.marginTop=e.marginTop+"px",this._isFirstSizeUpdate&&(t.style.display="",this._isFirstSizeUpdate=!1)}_OnInvokeDownload(e){const t=e.url;e=e.filename;const i=document.createElement("a"),n=document.body;i.textContent=e,i.href=t,i.download=e,n.appendChild(i),i.click(),n.removeChild(i)}async _OnRasterSvgImage(e){var t=e.imageBitmapOpts;return e=await self.C3_RasterSvgImageBlob(e.blob,e.imageWidth,e.imageHeight,e.surfaceWidth,e.surfaceHeight),{imageBitmap:t=t?await createImageBitmap(e,t):await createImageBitmap(e),transferables:[t]}}async _OnGetSvgImageSize(e){return await self.C3_GetSvgImageSize(e.blob)}async _OnAddStylesheet(e){await r(e.url)}_PlayPendingMedia(){var e=[...this._mediaPendingPlay];if(this._mediaPendingPlay.clear(),!this._isSilent)for(const t of e)(e=t.play())&&e.catch((e=>{this._mediaRemovedPendingPlay.has(t)||this._mediaPendingPlay.add(t)}))}TryPlayMedia(e){if("function"!=typeof e.play)throw Error("missing play function");let t;this._mediaRemovedPendingPlay.delete(e);try{t=e.play()}catch(t){return void this._mediaPendingPlay.add(e)}t&&t.catch((t=>{this._mediaRemovedPendingPlay.has(e)||this._mediaPendingPlay.add(e)}))}RemovePendingPlay(e){this._mediaPendingPlay.delete(e),this._mediaRemovedPendingPlay.add(e)}SetSilent(e){this._isSilent=!!e}_OnHideCordovaSplash(){navigator.splashscreen&&navigator.splashscreen.hide&&navigator.splashscreen.hide()}_OnDebugHighlight(e){if(e.show){this._debugHighlightElem||(this._debugHighlightElem=document.createElement("div"),this._debugHighlightElem.id="inspectOutline",document.body.appendChild(this._debugHighlightElem));var t=this._debugHighlightElem;t.style.display="",t.style.left=e.left-1+"px",t.style.top=e.top-1+"px",t.style.width=e.width+2+"px",t.style.height=e.height+2+"px",t.textContent=e.name}else this._debugHighlightElem&&(this._debugHighlightElem.style.display="none")}_OnRegisterSW(){window.C3_RegisterSW&&window.C3_RegisterSW()}_OnPostToDebugger(e){window.c3_postToMessagePort&&(e.from="runtime",window.c3_postToMessagePort(e))}_InvokeFunctionFromJS(e,t){return this.PostToRuntimeAsync("js-invoke-function",{name:e,params:t})}_OnAlert(e){alert(e.message)}_OnWrapperMessage(t){"entered-fullscreen"===t?(e._SetWrapperIsFullscreenFlag(!0),this._OnFullscreenChange()):"exited-fullscreen"===t&&(e._SetWrapperIsFullscreenFlag(!1),this._OnFullscreenChange())}})}self.JobSchedulerDOM=class{constructor(e){this._runtimeInterface=e,this._baseUrl=e.GetBaseURL(),"preview"===e.GetExportType()?this._baseUrl+="workers/":this._baseUrl+=e.GetScriptFolder(),this._maxNumWorkers=Math.min(navigator.hardwareConcurrency||2,16),this._dispatchWorker=null,this._jobWorkers=[],this._outputPort=this._inputPort=null}async Init(){if(this._hasInitialised)throw Error("already initialised");this._hasInitialised=!0;var e=this._runtimeInterface._GetWorkerURL("dispatchworker.js");this._dispatchWorker=await this._runtimeInterface.CreateWorker(e,this._baseUrl,{name:"DispatchWorker"}),e=new MessageChannel,this._inputPort=e.port1,this._dispatchWorker.postMessage({type:"_init","in-port":e.port2},[e.port2]),this._outputPort=await this._CreateJobWorker()}async _CreateJobWorker(){const e=this._jobWorkers.length;var t=this._runtimeInterface._GetWorkerURL("jobworker.js");t=await this._runtimeInterface.CreateWorker(t,this._baseUrl,{name:"JobWorker"+e});const i=new MessageChannel,n=new MessageChannel;return this._dispatchWorker.postMessage({type:"_addJobWorker",port:i.port1},[i.port1]),t.postMessage({type:"init",number:e,"dispatch-port":i.port2,"output-port":n.port2},[i.port2,n.port2]),this._jobWorkers.push(t),n.port1}GetPortData(){return{inputPort:this._inputPort,outputPort:this._outputPort,maxNumWorkers:this._maxNumWorkers}}GetPortTransferables(){return[this._inputPort,this._outputPort]}},window.C3_IsSupported&&(window.c3_runtimeInterface=new self.RuntimeInterface({useWorker:!0,workerMainUrl:"workermain.js",engineScripts:["scripts/c3runtime.js"],projectScripts:[],mainProjectScript:"",scriptFolder:"scripts/",workerDependencyScripts:["box2d.wasm.js"],exportType:"html5"})),self.RuntimeInterface.AddDOMHandlerClass(class extends self.DOMHandler{constructor(e){super(e,"touch"),this.AddRuntimeMessageHandler("request-permission",(e=>this._OnRequestPermission(e)))}async _OnRequestPermission(e){let t=!0;0===(e=e.type)?t=await this._RequestOrientationPermission():1===e&&(t=await this._RequestMotionPermission()),this.PostToRuntime("permission-result",{type:e,result:t})}async _RequestOrientationPermission(){if(!self.DeviceOrientationEvent||!self.DeviceOrientationEvent.requestPermission)return!0;try{return"granted"===await self.DeviceOrientationEvent.requestPermission()}catch(e){return!1}}async _RequestMotionPermission(){if(!self.DeviceMotionEvent||!self.DeviceMotionEvent.requestPermission)return!0;try{return"granted"===await self.DeviceMotionEvent.requestPermission()}catch(e){return!1}}}),self.RuntimeInterface.AddDOMHandlerClass(class extends self.DOMHandler{constructor(e){super(e,"browser"),this._exportType="",this.AddRuntimeMessageHandlers([["get-initial-state",e=>this._OnGetInitialState(e)],["ready-for-sw-messages",()=>this._OnReadyForSWMessages()],["alert",e=>this._OnAlert(e)],["close",()=>this._OnClose()],["set-focus",e=>this._OnSetFocus(e)],["vibrate",e=>this._OnVibrate(e)],["lock-orientation",e=>this._OnLockOrientation(e)],["unlock-orientation",()=>this._OnUnlockOrientation()],["navigate",e=>this._OnNavigate(e)],["request-fullscreen",e=>this._OnRequestFullscreen(e)],["exit-fullscreen",()=>this._OnExitFullscreen()],["set-hash",e=>this._OnSetHash(e)]]),window.addEventListener("online",(()=>this._OnOnlineStateChanged(!0))),window.addEventListener("offline",(()=>this._OnOnlineStateChanged(!1))),window.addEventListener("hashchange",(()=>this._OnHashChange())),document.addEventListener("backbutton",(()=>this._OnCordovaBackButton()))}_OnGetInitialState(e){return this._exportType=e.exportType,{location:location.toString(),isOnline:!!navigator.onLine,referrer:document.referrer,title:document.title,isCookieEnabled:!!navigator.cookieEnabled,screenWidth:screen.width,screenHeight:screen.height,windowOuterWidth:window.outerWidth,windowOuterHeight:window.outerHeight,isScirraArcade:void 0!==window.is_scirra_arcade}}_OnReadyForSWMessages(){window.C3_RegisterSW&&window.OfflineClientInfo&&window.OfflineClientInfo.SetMessageCallback((e=>this.PostToRuntime("sw-message",e.data)))}_OnOnlineStateChanged(e){this.PostToRuntime("online-state",{isOnline:e})}_OnCordovaBackButton(){this.PostToRuntime("backbutton")}GetNWjsWindow(){return"nwjs"===this._exportType?nw.Window.get():null}_OnAlert(e){alert(e.message)}_OnClose(){navigator.app&&navigator.app.exitApp?navigator.app.exitApp():navigator.device&&navigator.device.exitApp?navigator.device.exitApp():window.close()}_OnSetFocus(e){if(e=e.isFocus,"nwjs"===this._exportType){const t=this.GetNWjsWindow();e?t.focus():t.blur()}else e?window.focus():window.blur()}_OnVibrate(e){navigator.vibrate&&navigator.vibrate(e.pattern)}_OnLockOrientation(e){if(e=e.orientation,screen.orientation&&screen.orientation.lock)screen.orientation.lock(e).catch((e=>{}));else try{let t=!1;screen.lockOrientation?t=screen.lockOrientation(e):screen.webkitLockOrientation?t=screen.webkitLockOrientation(e):screen.mozLockOrientation?t=screen.mozLockOrientation(e):screen.msLockOrientation&&(t=screen.msLockOrientation(e))}catch(e){}}_OnUnlockOrientation(){try{screen.orientation&&screen.orientation.unlock?screen.orientation.unlock():screen.unlockOrientation?screen.unlockOrientation():screen.webkitUnlockOrientation?screen.webkitUnlockOrientation():screen.mozUnlockOrientation?screen.mozUnlockOrientation():screen.msUnlockOrientation&&screen.msUnlockOrientation()}catch(e){}}_OnNavigate(e){var t=e.type;if("back"===t)navigator.app&&navigator.app.backHistory?navigator.app.backHistory():window.history.back();else if("forward"===t)window.history.forward();else if("reload"===t)location.reload();else if("url"===t){t=e.url;const i=e.target;e=e.exportType,self.cordova&&self.cordova.InAppBrowser?self.cordova.InAppBrowser.open(t,"_system"):"preview"===e||"windows-webview2"===e?window.open(t,"_blank"):this._isScirraArcade||(2===i?window.top.location=t:1===i?window.parent.location=t:window.location=t)}else"new-window"===t&&(t=e.url,e=e.tag,self.cordova&&self.cordova.InAppBrowser?self.cordova.InAppBrowser.open(t,"_system"):window.open(t,e))}_OnRequestFullscreen(e){if("windows-webview2"===this._exportType||"macos-wkwebview"===this._exportType)self.RuntimeInterface._SetWrapperIsFullscreenFlag(!0),this._iRuntime._SendWrapperMessage({type:"set-fullscreen",fullscreen:!0});else{const t={navigationUI:"auto"};1===(e=e.navUI)?t.navigationUI="hide":2===e&&(t.navigationUI="show"),(e=document.documentElement).requestFullscreen?e.requestFullscreen(t):e.mozRequestFullScreen?e.mozRequestFullScreen(t):e.msRequestFullscreen?e.msRequestFullscreen(t):e.webkitRequestFullScreen&&(void 0!==Element.ALLOW_KEYBOARD_INPUT?e.webkitRequestFullScreen(Element.ALLOW_KEYBOARD_INPUT):e.webkitRequestFullScreen())}}_OnExitFullscreen(){"windows-webview2"===this._exportType||"macos-wkwebview"===this._exportType?(self.RuntimeInterface._SetWrapperIsFullscreenFlag(!1),this._iRuntime._SendWrapperMessage({type:"set-fullscreen",fullscreen:!1})):document.exitFullscreen?document.exitFullscreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.msExitFullscreen?document.msExitFullscreen():document.webkitCancelFullScreen&&document.webkitCancelFullScreen()}_OnSetHash(e){location.hash=e.hash}_OnHashChange(){this.PostToRuntime("hashchange",{location:location.toString()})}});{const e={};let t=null,i=null;const n={banner:"ca-app-pub-3940256099942544/2934735716",interstitial:"ca-app-pub-3940256099942544/4411468910",rewarded:"ca-app-pub-3940256099942544/1712485313",rewardedInterstitial:"ca-app-pub-3940256099942544/6978759866"};let s=!1;function a(e,t){e(t,null)}function r(t,i){e[t]=i,self.admob.configRequest(e)}async function o(){if("android"===self.cordova.platformId)return self.C3AdUtilsMD5(self.device.uuid).toUpperCase();if("ios"===self.cordova.platformId){const e=await self.cordova.plugins.idfa.getInfo();if(!e.trackingLimited)return s=!0,self.C3AdUtilsMD5(e.idfa).toUpperCase()}}self.C3AdUtils={Success:function(e,t){e(null,t)},Failure:a,StartAdmobPlus:async function(e,n){return n=void 0!==n?n:t.debug,i||(i=new Promise(((t,i)=>{document.addEventListener("deviceready",(async()=>{try{if(await self.admob.start(),n){r("testDeviceIds",[await o()])}t(!0)}catch(i){t(!1),a(e,"Initialization failure")}}))})))},UpdateAdmobPlusRequest:r,SetInitConfigureOptions:function(e,i,n,s,a,r,o){t||(t={id:e,pubID:i,privacyPolicy:n,showFree:s,showConsent:a,debug:r,debugLocation:o},Object.freeze(t))},HasInitConfigurationOptions:function(){return!!t},GetAdUnit:function(e,i){if("android"===self.cordova.platformId)return e;if("ios"===self.cordova.platformId){const a=!!n[i];return t.debug&&!s&&a?n[i]:e}},get ConfigurationOptions(){return t},get TestId(){return o()}}}{const e=self.C3AdUtils,t=e.Success,i=e.Failure,n={get LOAD(){return self.admob.Events.bannerLoad},get LOAD_FAIL(){return self.admob.Events.bannerLoadFail}};class s{constructor(e,t,n,s){if(!e)return i(s,"Unit ID not specified");if(!t)return i(s,"Ad size not specified");if(!n)return i(s,"Ad position not specified");switch(this._adUnitId=e,this._position=n,this._size="",t){case"portrait":this._size=5;break;case"landscape":this._size=5;break;case"standard":this._size=0;break;case"large":this._size=1;break;case"medium":this._size=2;break;case"full":this._size=3;break;case"leaderboard":this._size=4;break;default:this._size=5}this._ad=null,this._adShowing=this._adLoading=!1}Load(i,n){if(this._ad)return t(n,"banner ad loaded");a.call(this,n),i={adUnitId:e.GetAdUnit(this._adUnitId,"banner"),size:this._size,position:this._position,offset:0,npa:"NON_PERSONALIZED"===i?"1":"0"},this._ad=new self.admob.BannerAd(i),this._ad.load()}async Show(e){return this._ad?this._adLoading?i(e,"banner ad still loading"):this._adShowing?t(e,"banner ad already shown"):(await this._ad.show(),this._adShowing=!0,void t(e,"banner shown")):i(e,"banner ad not created")}async Hide(e){return this._ad?this._adLoading?i(e,"banner ad still loading"):this._adShowing?(await this._ad.hide(),this._adShowing=!1,void t(e,"banner ad hidden")):t(e,"banner ad not being shown"):i(e,"banner ad not created")}IsLoading(){return this._adLoading}IsShowing(){return this._adShowing}}function a(e){const s=i=>{this._adLoading=!1,t(e,"banner ad loaded"),document.removeEventListener(n.LOAD,s),document.removeEventListener(n.LOAD_FAIL,a)},a=t=>{this._ad=null,this._adLoading=!1,i(e,"banner ad failed to load"),document.removeEventListener(n.LOAD,s),document.removeEventListener(n.LOAD_FAIL,a)};document.addEventListener(n.LOAD,s),document.addEventListener(n.LOAD_FAIL,a)}self.C3BannerAd=s}{const e=self.C3AdUtils,t=e.Success,i=e.Failure,n={get LOAD(){return self.admob.Events.interstitialLoad},get LOAD_FAIL(){return self.admob.Events.interstitialLoadFail},get SHOW(){return self.admob.Events.interstitialShow},get SHOW_FAIL(){return self.admob.Events.interstitialShowFail},get DISMISS(){return self.admob.Events.interstitialDismiss}};class s{constructor(e,t){if(!e)return i(t,"Unit ID not specified");this._adUnitId=e,this._ad=null,this._loadSuccess=this._adShowing=this._adLoading=!1,this._loadPromiseResolver=null,this._loadPromise=this.GetLoadPromise(),document.addEventListener(n.DISMISS,(async e=>{this._adShowing=!1,this._adLoading=!0,this._loadSuccess=!1,this._loadPromise=null,this._loadPromise=this.GetLoadPromise(),a.call(this),await this._ad.load()}))}GetLoadPromise(){return this._loadPromise?this._loadPromise:this._loadPromise=new Promise((e=>{this._loadPromiseResolver=e}))}ResolveLoadPromise(e){this._loadSuccess=e,this._loadPromiseResolver&&this._loadPromiseResolver(e),this._loadPromiseResolver=this._loadPromise=null,this._loadPromise=this.GetLoadPromise()}Load(t,i){t={adUnitId:e.GetAdUnit(this._adUnitId,"interstitial"),npa:"NON_PERSONALIZED"===t?"1":"0"},this._adLoading=!0,this._loadSuccess=this._adShowing=!1,this._loadPromise=null,this._loadPromise=this.GetLoadPromise(),this._ad=new self.admob.InterstitialAd(t),a.call(this,i),this._ad.load()}async Show(e){return this._ad?this._adShowing?t(e,"interstitial ad already shown"):(this._adLoading&&await this.GetLoadPromise(),void await(async()=>{this._loadSuccess?(r.call(this,e),await this._ad.show()):(a.call(this),this._loadSuccess=!1,this._loadPromise=null,this._ad.load(),await this.GetLoadPromise(),this._loadSuccess?(r.call(this,e),await this._ad.show()):i(e,"interstitial ad failed to load"))})()):i(e,"interstitial ad not created")}IsLoading(){return this._adLoading}IsShowing(){return this._adShowing}}function a(e){const s=i=>{this._adLoading=!1,this.ResolveLoadPromise(!0),e&&t(e,"interstitial ad load"),document.removeEventListener(n.LOAD,s),document.removeEventListener(n.LOAD_FAIL,a)},a=t=>{this._adLoading=!1,this.ResolveLoadPromise(!1),e&&i(e,"interstitial ad failed to load"),document.removeEventListener(n.LOAD,s),document.removeEventListener(n.LOAD_FAIL,a)};document.addEventListener(n.LOAD,s),document.addEventListener(n.LOAD_FAIL,a)}function r(e){const s=i=>{this._adShowing=!0,e&&t(e,"interstitial ad show"),document.removeEventListener(n.SHOW,s),document.removeEventListener(n.SHOW_FAIL,a)},a=t=>{this._adShowing=!1,e&&i(e,"interstitial ad failed to show"),document.removeEventListener(n.SHOW,s),document.removeEventListener(n.SHOW_FAIL,a)};document.addEventListener(n.SHOW,s),document.addEventListener(n.SHOW_FAIL,a)}self.C3InterstitialAd=s}{const e=self.C3AdUtils,t=e.Success,i=e.Failure,n={get LOAD(){return self.admob.Events.rewardedLoad},get LOAD_FAIL(){return self.admob.Events.rewardedLoadFail},get SHOW(){return self.admob.Events.rewardedShow},get SHOW_FAIL(){return self.admob.Events.rewardedShowFail},get DISMISS(){return self.admob.Events.rewardedDismiss},get REWARD(){return self.admob.Events.rewardedReward}};class s{constructor(e,t){if(!e)return i(t,"Unit ID not specified");this._adUnitId=e,this._ad=null,this._loadSuccess=this._adShowing=this._adLoading=!1,this._loadPromiseResolver=null,this._loadPromise=this.GetLoadPromise(),this._reward=null}GetLoadPromise(){return this._loadPromise?this._loadPromise:this._loadPromise=new Promise((e=>{this._loadPromiseResolver=e}))}ResolveLoadPromise(e){this._loadSuccess=e,this._loadPromiseResolver&&this._loadPromiseResolver(e),this._loadPromiseResolver=this._loadPromise=null,this._loadPromise=this.GetLoadPromise()}Load(t,i){t={adUnitId:e.GetAdUnit(this._adUnitId,"rewarded"),npa:"NON_PERSONALIZED"===t?"1":"0"},this._adLoading=!0,this._loadSuccess=this._adShowing=!1,this._loadPromise=null,this._loadPromise=this.GetLoadPromise(),this._ad=new self.admob.RewardedAd(t),a.call(this,i),this._ad.load()}async Show(e){return this._ad?this._adShowing?t(e,"rewarded ad already shown"):(this._adLoading&&await this.GetLoadPromise(),void await(async()=>{this._loadSuccess?(r.call(this,e),await this._ad.show()):(a.call(this),this._loadSuccess=!1,this._loadPromise=null,this._ad.load(),await this.GetLoadPromise(),this._loadSuccess?(r.call(this,e),await this._ad.show()):i(e,"rewarded ad failed to load"))})()):i(e,"rewarded ad not created")}IsLoading(){return this._adLoading}IsShowing(){return this._adShowing}}function a(e){const s=i=>{this._adLoading=!1,this.ResolveLoadPromise(!0),e&&t(e,"rewarded ad load"),document.removeEventListener(n.LOAD,s),document.removeEventListener(n.LOAD_FAIL,a)},a=t=>{this._adLoading=!1,this.ResolveLoadPromise(!1),e&&i(e,"rewarded ad failed to load"),document.removeEventListener(n.LOAD,s),document.removeEventListener(n.LOAD_FAIL,a)};document.addEventListener(n.LOAD,s),document.addEventListener(n.LOAD_FAIL,a)}function r(e){const s=e=>{this._adShowing=!0},r=e=>{this._reward=e.reward},o=t=>{this._adShowing=!1,e&&i(e,"rewarded ad failed to show"),document.removeEventListener(n.SHOW,s),document.removeEventListener(n.SHOW_FAIL,o),document.removeEventListener(n.REWARD,r),document.removeEventListener(n.DISMISS,d)},d=l=>{if(null!==this._reward){l=String(this._reward.type);const i=String(this._reward.amount);e&&t(e,JSON.stringify([l,i]))}else e&&i(e,"closed with no reward");this._reward=null,this._adShowing=!1,this._adLoading=!0,this._loadSuccess=!1,this._loadPromise=null,this._loadPromise=this.GetLoadPromise(),a.call(this),this._ad.load(),document.removeEventListener(n.SHOW,s),document.removeEventListener(n.SHOW_FAIL,o),document.removeEventListener(n.REWARD,r),document.removeEventListener(n.DISMISS,d)};document.addEventListener(n.SHOW,s),document.addEventListener(n.SHOW_FAIL,o),document.addEventListener(n.REWARD,r),document.addEventListener(n.DISMISS,d)}self.C3RewardedAd=s}{const e=self.C3AdUtils,t=e.Success,i=e.Failure,n={get LOAD(){return self.admob.Events.rewardedInterstitialLoad},get LOAD_FAIL(){return self.admob.Events.rewardedInterstitialLoadFail},get SHOW(){return self.admob.Events.rewardedInterstitialShow},get SHOW_FAIL(){return self.admob.Events.rewardedInterstitialShowFail},get DISMISS(){return self.admob.Events.rewardedInterstitialDismiss},get REWARD(){return self.admob.Events.rewardedInterstitialReward}};class s{constructor(e,t){if(!e)return i(t,"Unit ID not specified");this._adUnitId=e,this._ad=null,this._loadSuccess=this._adShowing=this._adLoading=!1,this._loadPromiseResolver=null,this._loadPromise=this.GetLoadPromise(),this._reward=null}GetLoadPromise(){return this._loadPromise?this._loadPromise:this._loadPromise=new Promise((e=>{this._loadPromiseResolver=e}))}ResolveLoadPromise(e){this._loadSuccess=e,this._loadPromiseResolver&&this._loadPromiseResolver(e),this._loadPromiseResolver=this._loadPromise=null,this._loadPromise=this.GetLoadPromise()}Load(t,i){t={adUnitId:e.GetAdUnit(this._adUnitId,"rewardedInterstitial"),npa:"NON_PERSONALIZED"===t?"1":"0"},this._adLoading=!0,this._loadSuccess=this._adShowing=!1,this._loadPromise=null,this._loadPromise=this.GetLoadPromise(),this._ad=new self.admob.RewardedInterstitialAd(t),a.call(this,i),this._ad.load()}async Show(e){return this._ad?this._adShowing?t(e,"rewarded interstitial ad already shown"):(this._adLoading&&await this.GetLoadPromise(),void await(async()=>{this._loadSuccess?(r.call(this,e),await this._ad.show()):(a.call(this),this._loadSuccess=!1,this._loadPromise=null,this._ad.load(),await this.GetLoadPromise(),this._loadSuccess?(r.call(this,e),await this._ad.show()):i(e,"rewarded interstitial ad failed to load"))})()):i(e,"rewarded interstitial ad not created")}IsLoading(){return this._adLoading}IsShowing(){return this._adShowing}}function a(e){const s=i=>{this._adLoading=!1,this.ResolveLoadPromise(!0),e&&t(e,"rewarded interstitial ad load"),document.removeEventListener(n.LOAD,s),document.removeEventListener(n.LOAD_FAIL,a)},a=t=>{this._adLoading=!1,this.ResolveLoadPromise(!1),e&&i(e,"rewarded interstitial ad failed to load"),document.removeEventListener(n.LOAD,s),document.removeEventListener(n.LOAD_FAIL,a)};document.addEventListener(n.LOAD,s),document.addEventListener(n.LOAD_FAIL,a)}function r(e){const s=e=>{this._adShowing=!0},r=e=>{this._reward=e.reward},o=t=>{this._adShowing=!1,e&&i(e,"rewarded interstitial ad failed to show"),document.removeEventListener(n.SHOW,s),document.removeEventListener(n.SHOW_FAIL,o),document.removeEventListener(n.REWARD,r),document.removeEventListener(n.DISMISS,d)},d=l=>{if(null!==this._reward){l=String(this._reward.type);const i=String(this._reward.amount);e&&t(e,JSON.stringify([l,i]))}else e&&i(e,"closed with no reward");this._reward=null,this._adShowing=!1,this._adLoading=!0,this._loadSuccess=!1,this._loadPromise=null,this._loadPromise=this.GetLoadPromise(),a.call(this),this._ad.load(),document.removeEventListener(n.SHOW,s),document.removeEventListener(n.SHOW_FAIL,o),document.removeEventListener(n.REWARD,r),document.removeEventListener(n.DISMISS,d)};document.addEventListener(n.SHOW,s),document.addEventListener(n.SHOW_FAIL,o),document.addEventListener(n.REWARD,r),document.addEventListener(n.DISMISS,d)}self.C3RewardedInterstitialAd=s}{const e=self.C3AdUtils,t=e.Success,i=e.Failure,n=!!self.cordova&&"ios"===self.cordova.platformId,s=!!self.cordova&&"android"===self.cordova.platformId,a=s?1:2,r=s?2:1;class o{constructor(){this._adPersonalization="UNKNOWN",this._inEEAorUnknown="",this._consentStatusIndex=0,this._consentStatusString="UNKNOWN",this._trackingStatusString="not-determined",this._hasConsentForm=!1}async Reset(){e.ConfigurationOptions.debug&&await self.consent.reset()}GetAdPersonalization(){return this._adPersonalization}async RequestTrackingAuthorization(){n&&await self.admob.requestTrackingAuthorization()}async GetTrackingAuthorizationStatus(){if(s)return this._trackingStatusString="not-determined";const e=self.cordova.plugins.idfa,t=await e.getInfo();if(!t.trackingLimited)return this._trackingStatusString="authorized";switch(t.trackingPermission){case e.TRACKING_PERMISSION_NOT_DETERMINED:return this._trackingStatusString="not-determined";case e.TRACKING_PERMISSION_RESTRICTED:return this._trackingStatusString="denied";case e.TRACKING_PERMISSION_DENIED:return this._trackingStatusString="denied";case e.TRACKING_PERMISSION_AUTHORIZED:return this._trackingStatusString="authorized"}}async RequestIDFA(e){return s?t(e,"not-determined"):n?(await u.call(this),"true"===this._inEEAorUnknown?await this.RequestTrackingAuthorization():(await this.GetTrackingAuthorizationStatus(),"not-determined"===this._trackingStatusString&&(await d.call(this),this._hasConsentForm?await this.ShowIDFAMessage():await this.RequestTrackingAuthorization())),await this.GetTrackingAuthorizationStatus(),t(e,this._trackingStatusString)):void 0}async RequestInfoUpdateForTesting(e,t,n){return await _.call(this,e,t,(e=>{i(n,e?e.message:"requestInfoUpdate error")}))}async RequestInfoUpdateForTestingSkipErrors(e,t,i){await _.call(this,e,t)}async ShowConsentForm(e,t=!1){switch(await l.call(this),e){case"eu":t=await d.call(this),c.call(this)&&t&&await(await self.consent.loadForm()).show();break;case"always":{e=await d.call(this);const i=await u.call(this);(e&&"true"===i||e&&t)&&await(await self.consent.loadForm()).show()}}await l.call(this),await u.call(this),await h.call(this)}async ShowIDFAMessage(e){await this.ShowConsentForm("always",!0)}async UpdateConsentStatus(){await l.call(this),await u.call(this),await h.call(this)}async SuccessResponse(e){await this.GetTrackingAuthorizationStatus(),t(e,`${this._consentStatusString}&&${this._trackingStatusString}&&${this._inEEAorUnknown}`)}async StatusUpdateSuccessResponse(e){await this.UpdateConsentStatus(),await this.GetTrackingAuthorizationStatus(),t(e,`${this._consentStatusString}&&${this._trackingStatusString}&&${this._inEEAorUnknown}`)}}async function d(){return this._hasConsentForm=await self.consent.getFormStatus()===self.consent.FormStatus.Available}async function l(){switch(this._consentStatusIndex=await self.consent.getConsentStatus(),this._consentStatusIndex){case r:return this._consentStatusString="REQUIRED";case a:return this._consentStatusString="NOT_REQUIRED";case 3:return this._consentStatusString="OBTAINED";case 0:return this._consentStatusString="UNKNOWN"}}function c(){switch(this._consentStatusIndex){case r:return!0;case a:return!1;case 3:return!1;case 0:return!0}}function h(){switch(this._consentStatusIndex){case r:return this._adPersonalization="NON_PERSONALIZED";case a:return this._adPersonalization="PERSONALIZED";case 3:return this._adPersonalization="PERSONALIZED";case 0:return this._adPersonalization="NON_PERSONALIZED"}}async function u(){if(s)switch(this._consentStatusIndex){case r:return this._inEEAorUnknown="true";case a:return this._inEEAorUnknown="false";case 3:return this._inEEAorUnknown="true";case 0:return this._inEEAorUnknown="true"}if(n)return await m.call(this,"IABTCF_gdprApplies","getInt")?this._inEEAorUnknown="true":this._inEEAorUnknown="false"}async function m(e,t){return new Promise(((i,n)=>{self.NativeStorage[t](e,(e=>i(e)),(e=>i(1)))}))}async function _(t,i,n){let s="",a=null;if(t){switch(i){case"EEA":s=self.consent.DebugGeography.EEA;break;case"NOT_EEA":s=self.consent.DebugGeography.NotEEA;break;default:s=self.consent.DebugGeography.Disabled}a=[await e.TestId]}try{return t?await self.consent.requestInfoUpdate({debugGeography:s,testDeviceIds:a}):await self.consent.requestInfoUpdate(),!0}catch(e){return n&&n(e),!1}}self.C3Consent=new o}{const e=(e,t)=>{let r=e[0],o=e[1],d=e[2],l=e[3];r=i(r,o,d,l,t[0],7,-680876936),l=i(l,r,o,d,t[1],12,-389564586),d=i(d,l,r,o,t[2],17,606105819),o=i(o,d,l,r,t[3],22,-1044525330),r=i(r,o,d,l,t[4],7,-176418897),l=i(l,r,o,d,t[5],12,1200080426),d=i(d,l,r,o,t[6],17,-1473231341),o=i(o,d,l,r,t[7],22,-45705983),r=i(r,o,d,l,t[8],7,1770035416),l=i(l,r,o,d,t[9],12,-1958414417),d=i(d,l,r,o,t[10],17,-42063),o=i(o,d,l,r,t[11],22,-1990404162),r=i(r,o,d,l,t[12],7,1804603682),l=i(l,r,o,d,t[13],12,-40341101),d=i(d,l,r,o,t[14],17,-1502002290),o=i(o,d,l,r,t[15],22,1236535329),r=n(r,o,d,l,t[1],5,-165796510),l=n(l,r,o,d,t[6],9,-1069501632),d=n(d,l,r,o,t[11],14,643717713),o=n(o,d,l,r,t[0],20,-373897302),r=n(r,o,d,l,t[5],5,-701558691),l=n(l,r,o,d,t[10],9,38016083),d=n(d,l,r,o,t[15],14,-660478335),o=n(o,d,l,r,t[4],20,-405537848),r=n(r,o,d,l,t[9],5,568446438),l=n(l,r,o,d,t[14],9,-1019803690),d=n(d,l,r,o,t[3],14,-187363961),o=n(o,d,l,r,t[8],20,1163531501),r=n(r,o,d,l,t[13],5,-1444681467),l=n(l,r,o,d,t[2],9,-51403784),d=n(d,l,r,o,t[7],14,1735328473),o=n(o,d,l,r,t[12],20,-1926607734),r=s(r,o,d,l,t[5],4,-378558),l=s(l,r,o,d,t[8],11,-2022574463),d=s(d,l,r,o,t[11],16,1839030562),o=s(o,d,l,r,t[14],23,-35309556),r=s(r,o,d,l,t[1],4,-1530992060),l=s(l,r,o,d,t[4],11,1272893353),d=s(d,l,r,o,t[7],16,-155497632),o=s(o,d,l,r,t[10],23,-1094730640),r=s(r,o,d,l,t[13],4,681279174),l=s(l,r,o,d,t[0],11,-358537222),d=s(d,l,r,o,t[3],16,-722521979),o=s(o,d,l,r,t[6],23,76029189),r=s(r,o,d,l,t[9],4,-640364487),l=s(l,r,o,d,t[12],11,-421815835),d=s(d,l,r,o,t[15],16,530742520),o=s(o,d,l,r,t[2],23,-995338651),r=a(r,o,d,l,t[0],6,-198630844),l=a(l,r,o,d,t[7],10,1126891415),d=a(d,l,r,o,t[14],15,-1416354905),o=a(o,d,l,r,t[5],21,-57434055),r=a(r,o,d,l,t[12],6,1700485571),l=a(l,r,o,d,t[3],10,-1894986606),d=a(d,l,r,o,t[10],15,-1051523),o=a(o,d,l,r,t[1],21,-2054922799),r=a(r,o,d,l,t[8],6,1873313359),l=a(l,r,o,d,t[15],10,-30611744),d=a(d,l,r,o,t[6],15,-1560198380),o=a(o,d,l,r,t[13],21,1309151649),r=a(r,o,d,l,t[4],6,-145523070),l=a(l,r,o,d,t[11],10,-1120210379),d=a(d,l,r,o,t[2],15,718787259),o=a(o,d,l,r,t[9],21,-343485551),e[0]=u(r,e[0]),e[1]=u(o,e[1]),e[2]=u(d,e[2]),e[3]=u(l,e[3])},t=(e,t,i,n,s,a)=>(t=u(u(t,e),u(n,a)),u(t<<s|t>>>32-s,i)),i=(e,i,n,s,a,r,o)=>t(i&n|~i&s,e,i,a,r,o),n=(e,i,n,s,a,r,o)=>t(i&s|n&~s,e,i,a,r,o),s=(e,i,n,s,a,r,o)=>t(i^n^s,e,i,a,r,o),a=(e,i,n,s,a,r,o)=>t(n^(i|~s),e,i,a,r,o),r=t=>{const i=t.length,n=[1732584193,-271733879,-1732584194,271733878];let s;for(s=64;s<=t.length;s+=64)e(n,o(t.substring(s-64,s)));t=t.substring(s-64);const a=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(s=0;s<t.length;s++)a[s>>2]|=t.charCodeAt(s)<<(s%4<<3);if(a[s>>2]|=128<<(s%4<<3),55<s)for(e(n,a),s=0;16>s;s++)a[s]=0;return a[14]=8*i,e(n,a),n},o=e=>{const t=[];for(let i=0;64>i;i+=4)t[i>>2]=e.charCodeAt(i)+(e.charCodeAt(i+1)<<8)+(e.charCodeAt(i+2)<<16)+(e.charCodeAt(i+3)<<24);return t},d="0123456789abcdef".split(""),l=e=>{let t="";for(let i=0;4>i;i++)t+=d[e>>8*i+4&15]+d[e>>8*i&15];return t},c=e=>{for(let t=0;t<e.length;t++)e[t]=l(e[t]);return e.join("")},h=e=>c(r(e));let u=(e,t)=>e+t&4294967295;h("hello"),self.C3AdUtilsMD5=h}{const e=self.C3AdUtils,t=self.C3Consent,i=self.C3BannerAd,n=self.C3InterstitialAd,s=self.C3RewardedAd,a=self.C3RewardedInterstitialAd;let r=null,o=null,d=null,l=null,c=null;const h={},u=(e,t)=>{h[e]=t};u("CreateBannerAdvert",(async(n,s,a,o,d)=>{await e.StartAdmobPlus(d,a)&&(a=await t.GetAdPersonalization(),r||(r=new i(n,s,o,d)),r.Load(a,d))})),u("ShowBannerAdvert",(async t=>{if(!r)return e.Failure(t,"banner ad not created");r.Show(t)})),u("HideBannerAdvert",(async t=>{if(!r)return e.Failure(t,"banner ad not created");r.Hide(t)})),u("CreateInterstitialAdvert",(async(i,s,a)=>{if(o)return e.Success(a,"interstitial ad already created");await e.StartAdmobPlus(a,s)&&(s=await t.GetAdPersonalization(),o=new n(i,a),o.Load(s,a))})),u("ShowInterstitialAdvert",(async t=>{if(!o)return e.Failure(t,"interstitial ad not created");o.Show(t)})),u("CreateVideoAdvert",(async(i,n,a)=>{if(d||l)return e.Success(a,"video ad already created");await e.StartAdmobPlus(a,n)&&(n=await t.GetAdPersonalization(),d=new s(i,a),d.Load(n,a))})),u("ShowVideoAdvert",(async t=>{if(!d)return e.Failure(t,"video ad not created");d.Show(t)})),u("CreateRewardedAdvert",(async(i,n,a)=>{if(l||d)return e.Success(a,"rewarded ad already created");await e.StartAdmobPlus(a,n)&&(n=await t.GetAdPersonalization(),l=new s(i,a),l.Load(n,a))})),u("ShowRewardedAdvert",(async t=>{if(!l)return e.Failure(t,"rewarded ad not created");l.Show(t)})),u("CreateRewardedInterstitialAdvert",(async(i,n,s)=>{if(c)return e.Success(s,"rewarded interstitial ad already created");await e.StartAdmobPlus(s,n)&&(n=await t.GetAdPersonalization(),c=new a(i,s),c.Load(n,s))})),u("ShowRewardedInterstitialAdvert",(async t=>{if(!c)return e.Failure(t,"rewarded interstitial ad not created");c.Show(t)})),u("Configure",(async(i,n,s,a,r,o,d,l,c)=>{const h=!e.HasInitConfigurationOptions();e.SetInitConfigureOptions(i,n,s,a,r,o,d),await e.StartAdmobPlus(c,o)&&(h&&await t.Reset(),await t.RequestInfoUpdateForTesting(o,d,c)&&(h?l?await t.ShowConsentForm("eu"):await t.UpdateConsentStatus():await t.ShowConsentForm("always"),await t.SuccessResponse(c)))})),u("RequestConsent",(async t=>{h.Configure(e.ConfigurationOptions.id,e.ConfigurationOptions.pubID,e.ConfigurationOptions.privacyPolicy,e.ConfigurationOptions.showFree,"always",e.ConfigurationOptions.debug,e.ConfigurationOptions.debugLocation,!1,t)})),u("SetMaxAdContentRating",(async(t,i)=>{if(await e.StartAdmobPlus(i)){if(!t)return e.Failure(i,"Label not specified");try{e.UpdateAdmobPlusRequest("maxAdContentRating",t),e.Success(i,"")}catch(t){e.Failure(i,"invalid label")}}})),u("TagForChildDirectedTreatment",(async(t,i)=>{if(await e.StartAdmobPlus(i))try{e.UpdateAdmobPlusRequest("tagForChildDirectedTreatment",1===t),e.Success(i,"")}catch(t){e.Failure(i,"invalid label")}})),u("TagForUnderAgeOfConsent",(async(t,i)=>{if(await e.StartAdmobPlus(i))try{e.UpdateAdmobPlusRequest("tagForUnderAgeOfConsent",1===t),e.Success(i,"")}catch(t){e.Failure(i,"invalid label")}})),u("RequestIDFA",(async i=>{await e.StartAdmobPlus(i)&&t.RequestIDFA(i)})),u("StatusUpdate",(async(i,n,s)=>{await e.StartAdmobPlus(s,i)&&(await t.RequestInfoUpdateForTestingSkipErrors(i,n,s),await t.StatusUpdateSuccessResponse(s))})),self.C3MobileAdvertsAPI||(self.C3MobileAdvertsAPI={}),self.C3MobileAdvertsAPI.real=h}{const e={},t=(t,i)=>e[t]=i,i=e=>new Promise((t=>setTimeout(t,e)));let n=null,s=null,a=null,r=null,o=null;function d(e,t){return[t.slice(0,-1),t=t[t.length-1]]}t("CreateBannerAdvert",(async(...e)=>{[,e]=d(0,e),await i(50),n?e("Banner already exists"):(n="ready",e(null,"Created banner"))})),t("ShowBannerAdvert",(async(...e)=>{[,e]=d(0,e),await i(50),"ready"!=n?e("Banner cannot be shown"):(n="shown",e(null,"Showed banner"))})),t("HideBannerAdvert",(async(...e)=>{[,e]=d(0,e),await i(50),"shown"!=n?e("Banner cannot be hidden"):(n=null,e(null,"Hid banner"))})),t("CreateInterstitialAdvert",(async(...e)=>{[,e]=d(0,e),await i(50),s?e("Intersitial already exists"):(s="ready",e(null,"Created interstitial"))})),t("ShowInterstitialAdvert",(async(...e)=>{[,e]=d(0,e),await i(50),"ready"!=s?e("Cannot show interstitial"):(s=null,e(null,"Interstitial shown"))})),t("CreateVideoAdvert",(async(...e)=>{[,e]=d(0,e),await i(50),a?e("Video already exists"):(a="ready",e(null,"Created video"))})),t("ShowVideoAdvert",(async(...e)=>{[,e]=d(0,e),await i(50),"ready"!=a?e("Cannot show video"):(a=null,e(null,'["example type", 20]'))})),t("CreateRewardedAdvert",(async(...e)=>{[,e]=d(0,e),await i(50),r?e("Rewarded already exists"):(r="ready",e(null,"Created rewarded"))})),t("ShowRewardedAdvert",(async(...e)=>{[,e]=d(0,e),await i(50),"ready"!=r?e("Cannot show rewarded"):(r=null,e(null,'["example type", 20]'))})),t("CreateRewardedInterstitialAdvert",(async(...e)=>{[,e]=d(0,e),await i(50),o?e("Rewarded intersitial already exists"):(o="ready",e(null,"Created rewarded interstitial"))})),t("ShowRewardedInterstitialAdvert",(async(...e)=>{[,e]=d(0,e),await i(50),"ready"!=o?e("Cannot show rewarded interstitial"):(o=null,e(null,"Rewarded interstitial shown"))})),t("Configure",(async(...e)=>{[,e]=d(0,e),await i(50),e(null,"PERSONALIZED&&true")})),t("RequestConsent",(async(...e)=>{[,e]=d(0,e),await i(50),e(null,"PERSONALIZED&&true")})),t("RequestIDFA",(async(...e)=>{[,e]=d(0,e),await i(50),e(null,"authorized")})),self.C3MobileAdvertsAPI||(self.C3MobileAdvertsAPI={}),self.C3MobileAdvertsAPI.fake=e}{let e=!1;self.RuntimeInterface.AddDOMHandlerClass(class extends self.DOMHandler{constructor(e){super(e,"advert"),e=e=>[e,t=>this._CallMethod(e,t)],this.AddRuntimeMessageHandlers([e("CreateBannerAdvert"),e("ShowBannerAdvert"),e("HideBannerAdvert"),e("CreateInterstitialAdvert"),e("ShowInterstitialAdvert"),e("CreateVideoAdvert"),e("ShowVideoAdvert"),e("CreateRewardedAdvert"),e("ShowRewardedAdvert"),e("CreateRewardedInterstitialAdvert"),e("ShowRewardedInterstitialAdvert"),e("Configure"),e("RequestConsent"),e("SetUserPersonalisation"),e("SetMaxAdContentRating"),e("TagForChildDirectedTreatment"),e("TagForUnderAgeOfConsent"),e("RequestIDFA"),e("StatusUpdate")])}_GetPlugin(){}async _CallMethod(t,i){let n;if(self.cordova&&(n=self.C3MobileAdvertsAPI.real),!n)throw e||(e=!0),Error("advert plugin not loaded");return new Promise(((e,s)=>{(0,n[t])(...i,((t,i)=>{t?s(t):e(i)}))}))}})}