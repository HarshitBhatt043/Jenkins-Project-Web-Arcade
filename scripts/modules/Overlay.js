var Overlay=function(){var e,r,t=!1,a=function(){t&&(e.addClass("active"),mediator.publish("story_advance"))};return{pressButton:a,render:function(a){r.fadeOut(options.fade,(function(){mediator.publish("board_set_inactive"),r.fadeIn(options.fade),t=!0;var o=a.title,n=a.text,s=a.button;$("#overlay > h1").html(o),$("#overlay > #content").html(n),s?"%fb%"==s||(e.show(),e.html(s)):e.hide()}))},setInactive:function(){r.fadeOut(options.fade),t=!1},domReady:function(){e=$("#overlay > #holder > button"),r=$("#overlay"),e.on("click",a)}}}();mediator.installTo(Overlay),Overlay.subscribe("controls_key_space",Overlay.pressButton),Overlay.subscribe("controls_key_enter",Overlay.pressButton),Overlay.subscribe("overlay_render",Overlay.render),Overlay.subscribe("overlay_set_inactive",Overlay.setInactive),Overlay.subscribe("loader_dom_ready",Overlay.domReady);