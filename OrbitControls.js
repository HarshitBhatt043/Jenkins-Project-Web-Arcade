THREE.OrbitControls=function(t,e){this.object=t,this.domElement=void 0!==e?e:document,this.enabled=!0,this.target=new THREE.Vector3,this.center=this.target,this.noZoom=!1,this.zoomSpeed=1,this.minDistance=0,this.maxDistance=1/0,this.minZoom=0,this.maxZoom=1/0,this.noRotate=!1,this.rotateSpeed=1,this.noPan=!1,this.keyPanSpeed=7,this.autoRotate=!1,this.autoRotateSpeed=2,this.minPolarAngle=0,this.maxPolarAngle=Math.PI,this.minAzimuthAngle=-1/0,this.maxAzimuthAngle=1/0,this.noKeys=!1,this.keys={LEFT:37,UP:38,RIGHT:39,BOTTOM:40},this.mouseButtons={ORBIT:THREE.MOUSE.LEFT,ZOOM:THREE.MOUSE.MIDDLE,PAN:THREE.MOUSE.RIGHT};var o,n,i=this,a=1e-6,s=new THREE.Vector2,c=new THREE.Vector2,r=new THREE.Vector2,h=new THREE.Vector2,u=new THREE.Vector2,d=new THREE.Vector2,p=new THREE.Vector3,m=new THREE.Vector3,l=new THREE.Vector2,E=new THREE.Vector2,f=new THREE.Vector2,b=0,v=0,y=1,g=new THREE.Vector3,M=new THREE.Vector3,R=new THREE.Quaternion,T=-1,H=0,j=1,P=2,x=3,w=4,O=5,k=T;this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.zoom0=this.object.zoom;var L=(new THREE.Quaternion).setFromUnitVectors(t.up,new THREE.Vector3(0,1,0)),V=L.clone().inverse(),S={type:"change"},z={type:"start"},A={type:"end"};function I(){return 2*Math.PI/60/60*i.autoRotateSpeed}function D(){return Math.pow(.95,i.zoomSpeed)}function X(t){if(!1!==i.enabled){t.preventDefault();var e=i.domElement===document?i.domElement.body:i.domElement;if(k===H){if(!0===i.noRotate)return;c.set(t.clientX,t.clientY),r.subVectors(c,s),i.rotateLeft(2*Math.PI*r.x/e.clientWidth*i.rotateSpeed),i.rotateUp(2*Math.PI*r.y/e.clientHeight*i.rotateSpeed),s.copy(c)}else if(k===j){if(!0===i.noZoom)return;E.set(t.clientX,t.clientY),f.subVectors(E,l),f.y>0?i.dollyIn():f.y<0&&i.dollyOut(),l.copy(E)}else if(k===P){if(!0===i.noPan)return;u.set(t.clientX,t.clientY),d.subVectors(u,h),i.pan(d.x,d.y),h.copy(u)}k!==T&&i.update()}}function Y(){!1!==i.enabled&&(document.removeEventListener("mousemove",X,!1),document.removeEventListener("mouseup",Y,!1),i.dispatchEvent(A),k=T)}function Z(t){if(!1!==i.enabled&&!0!==i.noZoom&&k===T){t.preventDefault(),t.stopPropagation();var e=0;void 0!==t.wheelDelta?e=t.wheelDelta:void 0!==t.detail&&(e=-t.detail),e>0?i.dollyOut():e<0&&i.dollyIn(),i.update(),i.dispatchEvent(z),i.dispatchEvent(A)}}this.rotateLeft=function(t){void 0===t&&(t=I()),v-=t},this.rotateUp=function(t){void 0===t&&(t=I()),b-=t},this.panLeft=function(t){var e=this.object.matrix.elements;p.set(e[0],e[1],e[2]),p.multiplyScalar(-t),g.add(p)},this.panUp=function(t){var e=this.object.matrix.elements;p.set(e[4],e[5],e[6]),p.multiplyScalar(t),g.add(p)},this.pan=function(t,e){var o=i.domElement===document?i.domElement.body:i.domElement;if(i.object instanceof THREE.PerspectiveCamera){var n=i.object.position.clone().sub(i.target).length();n*=Math.tan(i.object.fov/2*Math.PI/180),i.panLeft(2*t*n/o.clientHeight),i.panUp(2*e*n/o.clientHeight)}else i.object instanceof THREE.OrthographicCamera&&(i.panLeft(t*(i.object.right-i.object.left)/o.clientWidth),i.panUp(e*(i.object.top-i.object.bottom)/o.clientHeight))},this.dollyIn=function(t){void 0===t&&(t=D()),i.object instanceof THREE.PerspectiveCamera?y/=t:i.object instanceof THREE.OrthographicCamera&&(i.object.zoom=Math.max(this.minZoom,Math.min(this.maxZoom,this.object.zoom*t)),i.object.updateProjectionMatrix(),i.dispatchEvent(S))},this.dollyOut=function(t){void 0===t&&(t=D()),i.object instanceof THREE.PerspectiveCamera?y*=t:i.object instanceof THREE.OrthographicCamera&&(i.object.zoom=Math.max(this.minZoom,Math.min(this.maxZoom,this.object.zoom/t)),i.object.updateProjectionMatrix(),i.dispatchEvent(S))},this.update=function(){var t=this.object.position;m.copy(t).sub(this.target),m.applyQuaternion(L),o=Math.atan2(m.x,m.z),n=Math.atan2(Math.sqrt(m.x*m.x+m.z*m.z),m.y),this.autoRotate&&k===T&&this.rotateLeft(I()),o+=v,n+=b,o=Math.max(this.minAzimuthAngle,Math.min(this.maxAzimuthAngle,o)),n=Math.max(this.minPolarAngle,Math.min(this.maxPolarAngle,n)),n=Math.max(a,Math.min(Math.PI-a,n));var e=m.length()*y;e=Math.max(this.minDistance,Math.min(this.maxDistance,e)),this.target.add(g),m.x=e*Math.sin(n)*Math.sin(o),m.y=e*Math.cos(n),m.z=e*Math.sin(n)*Math.cos(o),m.applyQuaternion(V),t.copy(this.target).add(m),this.object.lookAt(this.target),v=0,b=0,y=1,g.set(0,0,0),(M.distanceToSquared(this.object.position)>a||8*(1-R.dot(this.object.quaternion))>a)&&(this.dispatchEvent(S),M.copy(this.object.position),R.copy(this.object.quaternion))},this.reset=function(){k=T,this.target.copy(this.target0),this.object.position.copy(this.position0),this.object.zoom=this.zoom0,this.object.updateProjectionMatrix(),this.dispatchEvent(S),this.update()},this.getPolarAngle=function(){return n},this.getAzimuthalAngle=function(){return o},this.domElement.addEventListener("contextmenu",(function(t){t.preventDefault()}),!1),this.domElement.addEventListener("mousedown",(function(t){if(!1!==i.enabled){if(t.preventDefault(),t.button===i.mouseButtons.ORBIT){if(!0===i.noRotate)return;k=H,s.set(t.clientX,t.clientY)}else if(t.button===i.mouseButtons.ZOOM){if(!0===i.noZoom)return;k=j,l.set(t.clientX,t.clientY)}else if(t.button===i.mouseButtons.PAN){if(!0===i.noPan)return;k=P,h.set(t.clientX,t.clientY)}k!==T&&(document.addEventListener("mousemove",X,!1),document.addEventListener("mouseup",Y,!1),i.dispatchEvent(z))}}),!1),this.domElement.addEventListener("mousewheel",Z,!1),this.domElement.addEventListener("DOMMouseScroll",Z,!1),this.domElement.addEventListener("touchstart",(function(t){if(!1!==i.enabled){switch(t.touches.length){case 1:if(!0===i.noRotate)return;k=x,s.set(t.touches[0].pageX,t.touches[0].pageY);break;case 2:if(!0===i.noZoom)return;k=w;var e=t.touches[0].pageX-t.touches[1].pageX,o=t.touches[0].pageY-t.touches[1].pageY,n=Math.sqrt(e*e+o*o);l.set(0,n);break;case 3:if(!0===i.noPan)return;k=O,h.set(t.touches[0].pageX,t.touches[0].pageY);break;default:k=T}k!==T&&i.dispatchEvent(z)}}),!1),this.domElement.addEventListener("touchend",(function(){!1!==i.enabled&&(i.dispatchEvent(A),k=T)}),!1),this.domElement.addEventListener("touchmove",(function(t){if(!1!==i.enabled){t.preventDefault(),t.stopPropagation();var e=i.domElement===document?i.domElement.body:i.domElement;switch(t.touches.length){case 1:if(!0===i.noRotate)return;if(k!==x)return;c.set(t.touches[0].pageX,t.touches[0].pageY),r.subVectors(c,s),i.rotateLeft(2*Math.PI*r.x/e.clientWidth*i.rotateSpeed),i.rotateUp(2*Math.PI*r.y/e.clientHeight*i.rotateSpeed),s.copy(c),i.update();break;case 2:if(!0===i.noZoom)return;if(k!==w)return;var o=t.touches[0].pageX-t.touches[1].pageX,n=t.touches[0].pageY-t.touches[1].pageY,a=Math.sqrt(o*o+n*n);E.set(0,a),f.subVectors(E,l),f.y>0?i.dollyOut():f.y<0&&i.dollyIn(),l.copy(E),i.update();break;case 3:if(!0===i.noPan)return;if(k!==O)return;u.set(t.touches[0].pageX,t.touches[0].pageY),d.subVectors(u,h),i.pan(d.x,d.y),h.copy(u),i.update();break;default:k=T}}}),!1),window.addEventListener("keydown",(function(t){if(!1!==i.enabled&&!0!==i.noKeys&&!0!==i.noPan)switch(t.keyCode){case i.keys.UP:i.pan(0,i.keyPanSpeed),i.update();break;case i.keys.BOTTOM:i.pan(0,-i.keyPanSpeed),i.update();break;case i.keys.LEFT:i.pan(i.keyPanSpeed,0),i.update();break;case i.keys.RIGHT:i.pan(-i.keyPanSpeed,0),i.update();break}}),!1),this.update()},THREE.OrbitControls.prototype=Object.create(THREE.EventDispatcher.prototype),THREE.OrbitControls.prototype.constructor=THREE.OrbitControls;