function Spawner(t,h,i,e){this.width=t,this.height=h,this.player=i,this.fishes=e,this.currentZone=[this.player.x,this.player.y],this.zones=this.getAdjacentZones().map(this.spawn.bind(this)).concat([this.currentZone])}Spawner.prototype.resize=function(t,h){this.width=t,this.height=h,this.currentZone=[this.player.x,this.player.y],this.zones=this.getAdjacentZones().concat([this.currentZone])},Spawner.prototype.update=function(){for(var t=this.zones.length;t--;)if(this.zones[t]!==this.currentZone){if(Math.abs(this.player.x-this.zones[t][0])<this.width/2&&Math.abs(this.player.y-this.zones[t][1])<this.height/2){this.currentZone=this.zones[t];var h=this,i=this.getAdjacentZones().filter((function(t){return h.zones.every((function(h){return!(h[0]===t[0]&&h[1]===t[1])}))}));i.forEach(this.spawn.bind(this)),this.zones=this.zones.concat(i)}distance({x:this.zones[t][0],y:this.zones[t][1]},this.player)>2*Math.max(this.width,this.height)&&this.zones.splice(t,1)}},Spawner.prototype.spawn=function(t){for(var h=this.width*this.height/25e4,i=0,e=(Math.floor(3*Math.random())+1)*h;i<e;i++){var s=t[0]+Math.floor(this.width*Math.random())-this.width/2,n=t[1]+Math.floor(this.height*Math.random())-this.height/2,r=Math.random()>.5?this.player.size+Math.floor(10*Math.random()):this.player.size-Math.floor(10*Math.random()),o=new Fish(!0,s,n,r,Math.random()*Math.PI*2-Math.PI,Math.random()*Math.PI);this.fishes.push(o)}return t},Spawner.prototype.debug=function(){for(var t=0;t<this.zones.length;t++){var h=this.zones[t];ctx.strokeRect(h[0]-this.width/2,h[1]-this.height/2,this.width,this.height)}},Spawner.prototype.getAdjacentZones=function(){var t=this;return[[-1,0],[-1,-1],[0,-1],[1,-1],[1,0],[1,1],[0,1],[-1,1]].map((function(h){return[h[0]*t.width+t.currentZone[0],h[1]*t.height+t.currentZone[1]]}))};