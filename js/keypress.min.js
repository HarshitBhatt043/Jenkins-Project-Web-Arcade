(function(){var e,n,t,r,u,i,s,o,l,f,c,a,p,y,h,k,d,_,g,m,v,b,w,q,x,O,K,E,P,S,T,A,C,D,L,j,z,M,V,X,$,B,F,G,H,I,J,N=[].indexOf||function(e){for(var n=0,t=this.length;n<t;n++)if(n in this&&this[n]===e)return n;return-1},Q={}.hasOwnProperty;for(n in X=[],F=[],G=null,S=[],t=[],j=!1,C="ctrl",L="meta alt option ctrl shift cmd".split(" "),I=[],l={keys:[],count:0},y=function(e,n){var t,r,u,i;if(e.filter)return e.filter(n);for(i=[],r=0,u=e.length;r<u;r++)n(t=e[r])&&i.push(t);return i},function(){},f=function(e,n){var t,r,u;if(e.length!==n.length)return!1;for(r=0,u=e.length;r<u;r++)if(t=e[r],!(0<=N.call(n,t)))return!1;return!0},c=function(e,n){var t,r,u;if(e.length!==n.length)return!1;for(t=r=0,u=e.length;0<=u?r<u:r>u;t=0<=u?++r:--r)if(e[t]!==n[t])return!1;return!0},w=function(e,n){var t,r,u;for(r=0,u=e.length;r<u;r++)if(t=e[r],0>N.call(n,t))return!1;return!0},q=function(e,n){var t,r,u,i;for(u=r=0,i=e.length;u<i;u++){if(t=e[u],!((t=n.indexOf(t))>=r))return!1;r=t}return!0},z=function(e,n){if((n||keypress.suppress_event_defaults)&&!keypress.force_event_defaults&&(e.preventDefault?e.preventDefault():e.returnValue=!1,e.stopPropagation))return e.stopPropagation()},i=function(e){return!e.prevent_repeat&&("function"==typeof e.on_keydown||void 0)},T=function(e){var n,t,r,u;for(t=0,r=(u=e.keys).length;t<r;t++)if(e=u[t],0<=N.call(S,e)){n=!0;break}return n},h=function(e,n,t){if("function"==typeof n["on_"+e]&&z(t,!1===n["on_"+e].call(n.this,t,n.count)),"release"===e&&(n.count=0),"keyup"===e)return n.keyup_fired=!0},A=function(e,n){var t,r,u;for(r=0,u=X.length;r<u;r++)((t=X[r]).is_ordered&&c(e,t.keys)||!t.is_ordered&&f(e,t.keys))&&n(t)},k=function(e,n){var t,r,u;for(r=0,u=X.length;r<u;r++)((t=X[r]).is_ordered&&q(t.keys,e)||!t.is_ordered&&w(t.keys,e))&&n(t)},o=function(e){return!(0<=N.call(S,"cmd")&&0>N.call(e,"cmd"))},d=function(e){var n,t;return n=[],(t=y(S,(function(n){return n!==e}))).push(e),A(t,(function(e){if(o(e.keys))return n.push(e)})),k(t,(function(e){if(!(0<=N.call(n,e))&&!e.is_solitary&&o(e.keys))return n.push(e)})),n},g=function(e){var n,t,r,u;for(t=[],r=0,u=X.length;r<u;r++)(n=X[r]).is_sequence||0<=N.call(n.keys,e)&&o(n.keys)&&t.push(n);return t},u=function(e){var n,r,u,i,s,o,l,f,c,a,p;if(o=!1,s=!0,u=!1,0<=N.call(t,e))return!0;if(t.length)for(i=l=0,a=t.length;0<=a?l<a:l>a;i=0<=a?++l:--l)if((n=t[i])&&n.is_exclusive&&e.is_exclusive){if(n=n.keys,!o)for(f=0,c=n.length;f<c;f++)if(r=n[f],o=!0,0>N.call(e.keys,r)){o=!1;break}if(s&&!o)for(f=0,c=(p=e.keys).length;f<c;f++)if(r=p[f],s=!1,0>N.call(n,r)){s=!0;break}o&&(u?B(t.splice(i,1)):(B(t.splice(i,1,e)),u=!0),s=!1)}return s&&t.unshift(e),o||s},$=function(e){var n,r,u;for(n=r=0,u=t.length;0<=u?r<u:r>u;n=0<=u?++r:--r)if(t[n]===e){B(t.splice(n,1));break}},B=function(e){if(e)return e.count=null,e.keyup_fired=null},r=function(e,n){var t,r,u,i;if(F.push(e),(r=_()).length){for(u=0,i=r.length;u<i;u++)t=r[u],z(n,t.prevent_default);G&&clearTimeout(G),-1<keypress.sequence_delay&&(G=setTimeout((function(){return F=[]}),keypress.sequence_delay))}else F=[]},_=function(){var e,n,t,r,u,i,s,o,l,f,c;for(r=[],i=0,l=X.length;i<l;i++)for(e=X[i],n=s=1,f=F.length;1<=f?s<=f:s>=f;n=1<=f?++s:--s)if(u=F.slice(-n),e.is_sequence){if(0>N.call(e.keys,"shift")&&(u=y(u,(function(e){return"shift"!==e})),!u.length))continue;for(n=o=0,c=u.length;0<=c?o<c:o>c;n=0<=c?++o:--o){if(e.keys[n]!==u[n]){t=!1;break}t=!0}t&&r.push(e)}return r},m=function(e){var n,t,r,u,i,s,o,l,f,c,a;for(s=0,f=X.length;s<f;s++)if((n=X[s]).is_sequence){for(t=o=1,c=F.length;1<=c?o<=c:o>=c;t=1<=c?++o:--o)if(i=y(F,(function(e){return 0<=N.call(n.keys,"shift")||"shift"!==e})).slice(-t),n.keys.length===i.length)for(t=l=0,a=i.length;0<=a?l<a:l>a;t=0<=a?++l:--l)if(u=i[t],!(0>N.call(n.keys,"shift")&&"shift"===u||"shift"===e&&0>N.call(n.keys,"shift"))){if(n.keys[t]!==u){r=!1;break}r=!0}if(r)return n}return!1},p=function(e,n){var t;return!!n.shiftKey&&(null!=(t=P[e])&&t)},v=function(e,n,t){return!(0>N.call(e.keys,n))&&(z(t,e&&e.prevent_default),!(0<=N.call(S,n)&&!i(e))&&(n=u(e),e.keyup_fired=!1,e.is_counting&&"function"==typeof e.on_keydown&&(e.count+=1),n?h("keydown",e,t):void 0))},x=function(e,n){var t,u,i,s;for(t in(u=p(e,n))&&(e=u),r(e,n),(u=m(e))&&h("keydown",u,n),D)n[u=D[t]]&&(t===e||0<=N.call(S,t)||S.push(t));for(t in D)if(u=D[t],t!==e&&0<=N.call(S,t)&&!n[u])for(u=i=0,s=S.length;0<=s?i<s:i>s;u=0<=s?++i:--i)S[u]===t&&S.splice(u,1);for(i=0,s=(u=d(e)).length;i<s;i++)t=u[i],v(t,e,n);if((u=g(e)).length)for(i=0,s=u.length;i<s;i++)t=u[i],z(n,t.prevent_default);0>N.call(S,e)&&S.push(e)},b=function(e,n,t){var r,u;u=T(e),e.keyup_fired||((r=S.slice()).push(t),e.is_solitary&&!f(r,e.keys))||(h("keyup",e,n),e.is_counting&&"function"==typeof e.on_keyup&&"function"!=typeof e.on_keydown&&(e.count+=1)),u||(h("release",e,n),$(e))},O=function(e,n){var r,u,i,s,o,l;if(u=e,(i=p(e,n))&&(e=i),i=P[u],n.shiftKey?i&&0<=N.call(S,i)||(e=u):u&&0<=N.call(S,u)||(e=i),(s=m(e))&&h("keyup",s,n),0>N.call(S,e))return!1;for(s=o=0,l=S.length;0<=l?o<l:o>l;s=0<=l?++o:--o)if((r=S[s])===e||r===i||r===u){S.splice(s,1);break}for(u=t.length,i=[],s=0,o=t.length;s<o;s++)r=t[s],0<=N.call(r.keys,e)&&i.push(r);for(s=0,o=i.length;s<o;s++)r=i[s],b(r,n,e);if(1<u)for(u=0,s=t.length;u<s;u++)void 0===(r=t[u])||0<=N.call(i,r)||T(r)||$(r)},V=function(e,n){var t;if(j)S.length&&(S=[]);else if((n||S.length)&&(t=a(e.keyCode)))return n?x(t,e):O(t,e)},H=function(e){var n,t,r,u;for(u=[],n=t=0,r=X.length;0<=r?t<r:t>r;n=0<=r?++t:--t){if(e===X[n]){X.splice(n,1);break}u.push(void 0)}return u},J=function(e){var n,t,r,u,i;for(e.keys.length,t=u=0,i=e.keys.length;0<=i?u<i:u>i;t=0<=i?++u:--u)r=e.keys[t],(n=K[r])&&(r=e.keys[t]=n),"meta"===r&&e.keys.splice(t,1,C);for(n=0,u=(i=e.keys).length;n<u;n++)if(r=i[n],0>N.call(I,r))return!1;if(0<=N.call(e.keys,"meta")||0<=N.call(e.keys,"cmd")){for(n=e.keys.slice(),u=0,i=L.length;u<i;u++)r=L[u],-1<(t=n.indexOf(r))&&n.splice(t,1);n.length}return!0},s=function(e){var n;if(0<=N.call(S,"cmd")&&"cmd"!==(n=a(e.keyCode))&&"shift"!==n&&"alt"!==n&&"caps"!==n&&"tab"!==n)return V(e,!1)},window.keypress={},keypress.force_event_defaults=!1,keypress.suppress_event_defaults=!1,keypress.sequence_delay=800,keypress.get_registered_combos=function(){return X},keypress.reset=function(){X=[]},keypress.combo=function(e,n,t){return null==t&&(t=!1),keypress.register_combo({keys:e,on_keydown:n,prevent_default:t})},keypress.counting_combo=function(e,n,t){return null==t&&(t=!1),keypress.register_combo({keys:e,is_counting:!0,is_ordered:!0,on_keydown:n,prevent_default:t})},keypress.sequence_combo=function(e,n,t){return null==t&&(t=!1),keypress.register_combo({keys:e,on_keydown:n,is_sequence:!0,prevent_default:t})},keypress.register_combo=function(e){var n,t;for(n in"string"==typeof e.keys&&(e.keys=e.keys.split(" ")),l)Q.call(l,n)&&(t=l[n],null==e[n]&&(e[n]=t));if(J(e))return X.push(e),!0},keypress.register_many=function(e){var n,t,r,u;for(u=[],t=0,r=e.length;t<r;t++)n=e[t],u.push(keypress.register_combo(n));return u},keypress.unregister_combo=function(e){var n,t,r;if(!e)return!1;if(e.keys)return H(e);for(r=[],n=0,t=X.length;n<t;n++)(e=X[n])&&(f(keys,e.keys)?r.push(H(e)):r.push(void 0));return r},keypress.unregister_many=function(e){var n,t,r,u;for(u=[],t=0,r=e.length;t<r;t++)n=e[t],u.push(keypress.unregister_combo(n));return u},keypress.listen=function(){return j=!1},keypress.stop_listening=function(){return j=!0},a=function(e){return E[e]},D={cmd:"metaKey",ctrl:"ctrlKey",shift:"shiftKey",alt:"altKey"},K={escape:"esc",control:"ctrl",command:"cmd",break:"pause",windows:"cmd",option:"alt",caps_lock:"caps",apostrophe:"'",semicolon:";",tilde:"~",accent:"`",scroll_lock:"scroll",num_lock:"num"},P={"/":"?",".":">",",":"<","'":'"',";":":","[":"{","]":"}","\\":"|","`":"~","=":"+","-":"_",1:"!",2:"@",3:"#",4:"$",5:"%",6:"^",7:"&",8:"*",9:"(",0:")"},E={0:"\\",8:"backspace",9:"tab",12:"num",13:"enter",16:"shift",17:"ctrl",18:"alt",19:"pause",20:"caps",27:"escape",32:"space",33:"pageup",34:"pagedown",35:"end",36:"home",37:"left",38:"up",39:"right",40:"down",44:"print",45:"insert",46:"delete",48:"0",49:"1",50:"2",51:"3",52:"4",53:"5",54:"6",55:"7",56:"8",57:"9",65:"a",66:"b",67:"c",68:"d",69:"e",70:"f",71:"g",72:"h",73:"i",74:"j",75:"k",76:"l",77:"m",78:"n",79:"o",80:"p",81:"q",82:"r",83:"s",84:"t",85:"u",86:"v",87:"w",88:"x",89:"y",90:"z",91:"cmd",92:"cmd",93:"cmd",96:"num_0",97:"num_1",98:"num_2",99:"num_3",100:"num_4",101:"num_5",102:"num_6",103:"num_7",104:"num_8",105:"num_9",106:"num_multiply",107:"num_add",108:"num_enter",109:"num_subtract",110:"num_decimal",111:"num_divide",124:"print",144:"num",145:"scroll",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'",223:"`",224:"cmd",57392:"ctrl",63289:"num"})e=E[n],I.push(e);for(n in P)e=P[n],I.push(e);-1!==navigator.userAgent.indexOf("Mac OS X")&&(C="cmd"),-1!==navigator.userAgent.indexOf("Opera")&&(E[17]="cmd"),(M=function(e){return(document.attachEvent?"complete"===document.readyState:"loading"!==document.readyState)?e():setTimeout((function(){return M(e)}),9)})((function(){var e;return(e=function(e,n,t){return e.addEventListener?e.addEventListener(n,t):e.attachEvent?e.attachEvent("on"+n,t):void 0})(document.body,"keydown",(function(e){return e=e||window.event,V(e,!0),s(e)})),e(document.body,"keyup",(function(e){return e=e||window.event,V(e,!1)})),e(window,"blur",(function(){var e,n,t;for(n=0,t=S.length;n<t;n++)e=S[n],O(e,{});return S=[],[]}))}))}).call(this);