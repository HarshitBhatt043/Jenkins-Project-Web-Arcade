function Tile(e,t,r){var n=this,i=this.x=r%t.width,u=this.y=Math.floor(r/t.width),a=this.id=i+","+u,o=new RegExp("0","g"),s=[],l=null,c=null,f={Left:"Left",Right:"Right",Up:"Up",Down:"Down"};function v(e,r){var n=i+e,a=u+r;return t.tile(n,a)}function h(e){switch(e){case f.Right:return v(1,0);case f.Left:return v(-1,0);case f.Up:return v(0,-1);case f.Down:return v(0,1)}}function p(a){(e=a,t.setValue(i,u,r,a),t.rendered)?$("#tile-"+i+"-"+u).removeClass().addClass("tile tile-"+e):t.render();return n}this.id1=a+"=1",this.id2=a+"=2",this.right=function(){return h(f.Right)},this.left=function(){return h(f.Left)},this.up=function(){return h(f.Up)},this.down=function(){return h(f.Down)},this.move=h,this.clear=function(){p(0)},this.collect=function(r){if(e>0)return n;s=[1,2],c=null,l=null;for(var a=1;a<=2;a++){var v=1==a?2:1;for(var p in f)if(h(p).value==a&&h(p).move(p).value==a)return s=[v],r&&r.active&&r.mark(n,2==a?HintType.MaxTwoBlue:HintType.MaxTwoRed),n;if(h(f.Left).value==a&&h(f.Right).value==a||h(f.Up).value==a&&h(f.Down).value==a)return s=[v],r&&r.active&&r.mark(n,2==a?HintType.MaxTwoBlue:HintType.MaxTwoRed),n}var d=t.getRowInfo(u);if(d.nr1s>=t.maxPerRow)return s=[2],r&&r.active&&r.mark(n,HintType.RowMustBeBalanced),n;if(d.nr2s>=t.maxPerRow)return s=[1],r&&r.active&&r.mark(n,HintType.RowMustBeBalanced),n;2==d.nr0s&&d.str.replace(o,(function(e,r){r!=n.x&&(c=t.tile(r,n.y))}));var _=t.getColInfo(i);return _.nr1s>=t.maxPerCol?(s=[2],r&&r.active&&r.mark(n,HintType.ColMustBeBalanced),n):_.nr2s>=t.maxPerCol?(s=[1],r&&r.active&&r.mark(n,HintType.ColMustBeBalanced),n):(2==_.nr0s&&_.str.replace(o,(function(e,r){r!=n.y&&(l=t.tile(n.x,r))})),n)},this.mark=function(){return $("#tile-"+i+"-"+u).addClass("marked"),n},this.unmark=function(){return $("#tile-"+i+"-"+u).removeClass("marked"),n},this.isPartOfTripleX=function(){var t=e;if(!t)return!1;var r=f.Left,n=f.Right;return h(r).value==t&&h(r).move(r).value==t||h(n).value==t&&h(n).move(n).value==t||h(r).value==t&&h(n).value==t},this.isPartOfTripleY=function(){var t=e;if(!t)return!1;var r=f.Up,n=f.Down;return h(r).value==t&&h(r).move(r).value==t||h(n).value==t&&h(n).move(n).value==t||h(r).value==t&&h(n).value==t},this.isPartOfTriple=function(){return partOfTripleX()||partOfTripleY()},this.__defineGetter__("value",(function(){return e})),this.__defineSetter__("value",(function(e){return p(e)})),this.__defineGetter__("isEmpty",(function(){return 0==e})),this.__defineGetter__("possibleValues",(function(){return s})),this.__defineSetter__("possibleValues",(function(e){s=e})),this.__defineGetter__("emptyRowPairWith",(function(){return c})),this.__defineGetter__("emptyColPairWith",(function(){return l}))}function opposite(e){switch(e){case Directions.Right:return Directions.Left;case Directions.Left:return Directions.Right;case Directions.Up:return Directions.Down;case Directions.Down:return Directions.Up}return null}