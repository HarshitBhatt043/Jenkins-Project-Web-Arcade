"serviceWorker"in navigator&&navigator.serviceWorker.register("./sw.js").then((function(){}));var camera,scene,renderer,mouse,controls,drawCount,gradientLength,gradientOffset,gradientOffset2,line,linesGroup,lastPointZ,windowHeight=window.innerHeight,wrapper=document.getElementById("wrapper"),a=setInterval((function(){document.scrollTop=-1,resize()}),500),resize=function(){onWindowResize(),window.innerHeight!==windowHeight&&(windowHeight=window.innerHeight,wrapper.style.height=windowHeight)},parent=document.getElementById("wrapper"),parentInfo=parent.getBoundingClientRect(),startDrawing=document.getElementById("start-drawing"),d=0,speed=.05,deleteQueue=[],MAX_POINTS=500,dragging=!1,fibonacci=[5,8,13,21,34,55,89],colorChangeSpeed=3,offset=-40,views={inside:{z:offset},outside:{z:-offset/4},isometric:{y:-offset/2,x:offset/2},axial:{x:0,y:0}};const inside=document.getElementById("inside"),outside=document.getElementById("outside"),isometric=document.getElementById("isometric"),axial=document.getElementById("axial"),viewButtons=[inside,outside,isometric,axial];viewButtons.forEach((e=>{e.onclick=function(e){e.preventDefault();let t=e.target||e.srcElement;t.classList.contains("active")||(toggleActiveView(t),setView(t.id))}}));const RGB="rgb",BNW="bnw";let colorMode=RGB;const rgb=document.getElementById("rgb"),bnw=document.getElementById("bnw"),colorButtons=[rgb,bnw];colorButtons.forEach((e=>{e.onclick=function(e){e.preventDefault();let t=e.target||e.srcElement;t.classList.contains("active")||(toggleActiveView(t),colorMode=t.id)}}));const fePointLight=document.querySelector("fePointLight"),feSpecularLighting=document.querySelector("feSpecularLighting");function toggleActiveView(e){var t=e.parentElement.children;[].forEach.call(t,(function(t){e!=t?t.classList.remove("active"):t.classList.add("active")}))}function toggleStartDrawing(){linesGroup.children.length?startDrawing.style.visibility="hidden":startDrawing.style.visibility="visible"}function init(){(camera=new THREE.PerspectiveCamera(110,window.innerWidth/window.innerHeight,.001,1e3)).position.z=offset,camera.position.x=0,camera.position.y=0,(scene=new THREE.Scene).fog=new THREE.FogExp2(1184274,.024,150,220);let e=new THREE.AmbientLight(16777215);scene.add(e),linesGroup=new THREE.Group,scene.add(linesGroup),(controls=new THREE.OrbitControls(camera,parent)).mouseButtons={ORBIT:THREE.MOUSE.RIGHT},controls.enableZoom=!1,controls.update(),controls.enabled=!1,parent.addEventListener("mousemove",handleDraw,!1),parent.addEventListener("touchmove",handleDraw,!1),parent.addEventListener("mousedown",(function(e){e.preventDefault(),1===e.which&&(newGroup(),dragging=!0,toggleStartDrawing())})),parent.addEventListener("touchstart",(function(e){newGroup(),dragging=!0,toggleStartDrawing()})),parent.addEventListener("mouseup",(function(e){e.preventDefault(),deleteQueue.push(lastPointZ),dragging=!1,feSpecularLighting.setAttribute("lighting-color","rgba(0,0,0)")})),parent.addEventListener("touchend",(function(e){deleteQueue.push(lastPointZ),dragging=!1,feSpecularLighting.setAttribute("lighting-color","rgb(0,0,0)")})),window.addEventListener("resize",onWindowResize,!1),(renderer=new THREE.WebGLRenderer({antialias:!0})).setClearColor(scene.fog.color),renderer.setPixelRatio(window.devicePixelRatio),renderer.setSize(window.innerWidth,window.innerHeight),document.body.prepend(renderer.domElement),mouse=new THREE.Vector2,setView("outside"),animate()}function animate(){requestAnimationFrame(animate),updateBoundingClient(),deletePassedLines(),controls.update(),render(),d+=speed,scene.position.z=-d}function render(){renderer.render(scene,camera)}function deletePassedLines(){deleteQueue&&scene.position.z-offset+deleteQueue[0]<=-110&&(linesGroup.remove(linesGroup.children[0]),deleteQueue.shift(),toggleStartDrawing())}function newGroup(){let e=new THREE.BufferGeometry,t=new Float32Array(3*MAX_POINTS);e.addAttribute("position",new THREE.BufferAttribute(t,3));let n=new Uint8Array(3*MAX_POINTS);e.addAttribute("color",new THREE.BufferAttribute(n,3,!0)),drawCount=0,e.setDrawRange(0,drawCount);var i=new THREE.LineBasicMaterial({color:16777215,vertexColors:THREE.VertexColors});(line=new THREE.Line(e,i)).frustumCulled=!1,setProperties();var o=new THREE.Group;let r=getAngle(),a=2*Math.PI/r,s=Math.random()<.5?-1:1;for(var d=0;d<a;d++){let e=line.clone();if(a<=21){let t={ease:Elastic.easeOut,delay:0,repeat:0};t.z=d*r*s,TweenMax.to(e.rotation,.2*d,t)}else e.rotation.z=d*r;o.add(e)}linesGroup.add(o)}function getAngle(){return 2*Math.PI/fibonacci[Math.floor(Math.random()*fibonacci.length)]}function map(e,t,n){let i=Math.pow(-1,Math.floor(e/n)),o=t*((e-Math.floor(e/n)*n)/n);return-1==i?255-o:o}function setPosition(e,t,n,i){var o=line.geometry.attributes.position.array;o[i]=e,o[i+1]=t,o[i+2]=n}function setProperties(){gradientLength=MAX_POINTS/colorChangeSpeed,gradientOffset=Math.floor(Math.random()*MAX_POINTS),gradientOffset2=Math.floor(Math.random()*MAX_POINTS)}function setColor(e){const t=colorMode==BNW;var n=line.geometry.attributes.color.array;n[e]=t?255:map(e+gradientOffset,255,gradientLength),n[e+1]=t?255:255-n[e],n[e+2]=t?255:map(e+gradientOffset2,255,4*gradientLength);const i=`rgb(${[n[e],n[e+1],n[e+2]]})`;feSpecularLighting.setAttribute("lighting-color",i),document.body.style.setProperty("--color",i)}function setView(e){let t={ease:Power1.easeOut,delay:0,repeat:0};for(var n in views[e])"z"==n&&(offset=views[e][n]),t[n]=views[e][n],TweenMax.to(camera.position,.6,t)}function handleDraw(e){e.preventDefault();let t=e.clientX?e.clientX:e.touches[0].pageX,n=e.clientY?e.clientY:e.touches[0].pageY;if(fePointLight.setAttribute("x",t),fePointLight.setAttribute("y",n),dragging&1==e.which||e.touches){mouse.x=t/window.innerWidth*2-1,mouse.y=-n/window.innerHeight*2+1;var i=new THREE.Vector3(mouse.x,mouse.y,.5);i.unproject(camera);var o=i.sub(camera.position).normalize(),r=-camera.position.z/o.z,a=camera.position.clone().add(o.multiplyScalar(r));lastPointZ=camera.position.z-offset+d,setPosition(a.x,a.y,lastPointZ,3*drawCount),setColor(3*drawCount),line.geometry.setDrawRange(0,drawCount),line.geometry.attributes.position.needsUpdate=!0,line.geometry.attributes.color.needsUpdate=!0,drawCount++}else feSpecularLighting.setAttribute("lighting-color","rgb(0,0,0)")}function onWindowResize(){camera.aspect=window.innerWidth/window.innerHeight,camera.updateProjectionMatrix(),renderer.setSize(window.innerWidth,window.innerHeight),render()}function updateBoundingClient(){parentInfo=parent.getBoundingClientRect()}init(),Boolean(window.chrome)&&document.body.classList.add("chrome"),document.querySelector("#about-button").addEventListener("click",(()=>{document.body.classList.toggle("about-open")})),document.querySelector("#about-close").addEventListener("click",(()=>{document.body.classList.toggle("about-open")}));